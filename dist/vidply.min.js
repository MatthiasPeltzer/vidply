/*!
 * VidPly v1.0.0
 * Universal, Accessible Video Player
 * (c) 2025 Matthias Peltzer
 * Released under GPL-2.0-or-later License
 */
var VidPly=(()=>{var M=Object.defineProperty;var z=Object.getOwnPropertyDescriptor;var A=Object.getOwnPropertyNames;var I=Object.prototype.hasOwnProperty;var F=(l,e)=>()=>(l&&(e=l(l=0)),e);var V=(l,e)=>{for(var t in e)M(l,t,{get:e[t],enumerable:!0})},R=(l,e,t,s)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of A(e))!I.call(l,i)&&i!==t&&M(l,i,{get:()=>e[i],enumerable:!(s=z(e,i))||s.enumerable});return l};var W=l=>R(M({},"__esModule",{value:!0}),l);var N={};V(N,{HTML5Renderer:()=>v});var v,$=F(()=>{v=class{constructor(e){this.player=e,this.media=e.element}async init(){this.attachEvents(),this.media.preload=this.player.options.preload,this.media.load()}attachEvents(){this.media.addEventListener("loadedmetadata",()=>{this.player.state.duration=this.media.duration,this.player.emit("loadedmetadata")}),this.media.addEventListener("play",()=>{this.player.state.playing=!0,this.player.state.paused=!1,this.player.state.ended=!1,this.player.emit("play"),this.player.options.onPlay&&this.player.options.onPlay.call(this.player),this.player.options.pauseOthersOnPlay&&this.pauseOtherPlayers()}),this.media.addEventListener("pause",()=>{this.player.state.playing=!1,this.player.state.paused=!0,this.player.emit("pause"),this.player.options.onPause&&this.player.options.onPause.call(this.player)}),this.media.addEventListener("ended",()=>{this.player.state.playing=!1,this.player.state.paused=!0,this.player.state.ended=!0,this.player.emit("ended"),this.player.options.onEnded&&this.player.options.onEnded.call(this.player),this.player.options.loop&&(this.player.seek(0),this.player.play())}),this.media.addEventListener("timeupdate",()=>{this.player.state.currentTime=this.media.currentTime,this.player.emit("timeupdate",this.media.currentTime),this.player.options.onTimeUpdate&&this.player.options.onTimeUpdate.call(this.player,this.media.currentTime)}),this.media.addEventListener("volumechange",()=>{this.player.state.volume=this.media.volume,this.player.state.muted=this.media.muted,this.player.emit("volumechange",this.media.volume),this.player.options.onVolumeChange&&this.player.options.onVolumeChange.call(this.player,this.media.volume)}),this.media.addEventListener("seeking",()=>{this.player.state.seeking=!0,this.player.emit("seeking")}),this.media.addEventListener("seeked",()=>{this.player.state.seeking=!1,this.player.emit("seeked")}),this.media.addEventListener("waiting",()=>{this.player.state.buffering=!0,this.player.emit("waiting")}),this.media.addEventListener("canplay",()=>{this.player.state.buffering=!1,this.player.emit("canplay")}),this.media.addEventListener("progress",()=>{if(this.media.buffered.length>0){let e=this.media.buffered.end(this.media.buffered.length-1);this.player.emit("progress",e)}}),this.media.addEventListener("error",e=>{this.player.handleError(this.media.error)}),this.media.addEventListener("ratechange",()=>{this.player.state.playbackSpeed=this.media.playbackRate,this.player.emit("ratechange",this.media.playbackRate)})}pauseOtherPlayers(){document.querySelectorAll(".vidply-player").forEach(t=>{if(t!==this.player.container){let s=t.querySelector("video, audio");s&&!s.paused&&s.pause()}})}play(){let e=this.media.play();e!==void 0&&e.catch(t=>{this.player.log("Play failed:",t,"warn"),this.player.options.autoplay&&!this.player.state.muted&&(this.player.log("Retrying play with muted audio","info"),this.media.muted=!0,this.media.play().catch(s=>{this.player.handleError(s)}))})}pause(){this.media.pause()}seek(e){this.media.currentTime=e}setVolume(e){this.media.volume=e}setMuted(e){this.media.muted=e}setPlaybackSpeed(e){this.media.playbackRate=e}destroy(){this.media.removeEventListener("loadedmetadata",()=>{}),this.media.removeEventListener("play",()=>{}),this.media.removeEventListener("pause",()=>{})}}});var q={};V(q,{Player:()=>y,PlaylistManager:()=>T,default:()=>U});var b=class{constructor(){this.events={}}on(e,t){return this.events[e]||(this.events[e]=[]),this.events[e].push(t),this}once(e,t){let s=(...i)=>{t(...i),this.off(e,s)};return this.on(e,s)}off(e,t){return this.events[e]?(t?this.events[e]=this.events[e].filter(s=>s!==t):delete this.events[e],this):this}emit(e,...t){return this.events[e]?(this.events[e].forEach(s=>{s(...t)}),this):this}removeAllListeners(){return this.events={},this}};var a={createElement(l,e={}){let t=document.createElement(l);return e.className&&(t.className=e.className),e.attributes&&Object.entries(e.attributes).forEach(([s,i])=>{t.setAttribute(s,i)}),e.innerHTML&&(t.innerHTML=e.innerHTML),e.textContent&&(t.textContent=e.textContent),e.style&&Object.assign(t.style,e.style),e.children&&e.children.forEach(s=>{s&&t.appendChild(s)}),t},addClass(l,e){l&&e&&l.classList.add(e)},removeClass(l,e){l&&e&&l.classList.remove(e)},toggleClass(l,e){l&&e&&l.classList.toggle(e)},hasClass(l,e){return l&&l.classList.contains(e)},show(l){l&&(l.style.display="")},hide(l){l&&(l.style.display="none")},fadeIn(l,e=300){if(!l)return;l.style.opacity="0",l.style.display="";let t=null,s=i=>{t||(t=i);let n=i-t,r=Math.min(n/e,1);l.style.opacity=r,n<e&&requestAnimationFrame(s)};requestAnimationFrame(s)},fadeOut(l,e=300){if(!l)return;let t=parseFloat(getComputedStyle(l).opacity)||1,s=null,i=n=>{s||(s=n);let r=n-s,o=Math.max(t-r/e,0);l.style.opacity=o,r<e?requestAnimationFrame(i):l.style.display="none"};requestAnimationFrame(i)},offset(l){if(!l)return{top:0,left:0};let e=l.getBoundingClientRect();return{top:e.top+window.pageYOffset,left:e.left+window.pageXOffset,width:e.width,height:e.height}},escapeHTML(l){let e=document.createElement("div");return e.textContent=l,e.innerHTML},sanitizeHTML(l){let e=document.createElement("div"),t=l.replace(/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,"").replace(/<iframe\b[^<]*(?:(?!<\/iframe>)<[^<]*)*<\/iframe>/gi,"").replace(/on\w+\s*=/gi,"").replace(/javascript:/gi,"");return e.innerHTML=t,e.innerHTML}};var m={formatTime(l,e=!1){if(!isFinite(l)||l<0)return e?"00:00:00":"00:00";let t=Math.floor(l/3600),s=Math.floor(l%3600/60),i=Math.floor(l%60),n=r=>String(r).padStart(2,"0");return t>0||e?`${n(t)}:${n(s)}:${n(i)}`:`${n(s)}:${n(i)}`},parseTime(l){let e=l.split(":").map(t=>parseInt(t,10));return e.length===3?e[0]*3600+e[1]*60+e[2]:e.length===2?e[0]*60+e[1]:e.length===1?e[0]:0},formatDuration(l){if(!isFinite(l)||l<0)return"0 seconds";let e=Math.floor(l/3600),t=Math.floor(l%3600/60),s=Math.floor(l%60),i=[];return e>0&&i.push(`${e} hour${e!==1?"s":""}`),t>0&&i.push(`${t} minute${t!==1?"s":""}`),(s>0||i.length===0)&&i.push(`${s} second${s!==1?"s":""}`),i.join(", ")},formatPercentage(l,e){return e===0?0:Math.round(l/e*100)}};var H={play:`<svg viewBox="0 0 24 24" fill="currentColor">
    <path d="M8 5v14l11-7z"/>
  </svg>`,pause:`<svg viewBox="0 0 24 24" fill="currentColor">
    <path d="M6 4h4v16H6V4zm8 0h4v16h-4V4z"/>
  </svg>`,stop:`<svg viewBox="0 0 24 24" fill="currentColor">
    <rect x="6" y="6" width="12" height="12"/>
  </svg>`,rewind:`<svg viewBox="0 0 24 24" fill="currentColor">
    <path d="M11 18V6l-8.5 6 8.5 6zm.5-6l8.5 6V6l-8.5 6z"/>
  </svg>`,forward:`<svg viewBox="0 0 24 24" fill="currentColor">
    <path d="M4 18l8.5-6L4 6v12zm9-12v12l8.5-6L13 6z"/>
  </svg>`,skipPrevious:`<svg viewBox="0 0 24 24" fill="currentColor">
    <path d="M6 6h2v12H6V6zm3 6l8.5 6V6L9 12z"/>
  </svg>`,skipNext:`<svg viewBox="0 0 24 24" fill="currentColor">
    <path d="M16 6h2v12h-2V6zM6 6l8.5 6L6 18V6z"/>
  </svg>`,volumeHigh:`<svg viewBox="0 0 24 24" fill="currentColor">
    <path d="M3 9v6h4l5 5V4L7 9H3zm13.5 3c0-1.77-1.02-3.29-2.5-4.03v8.05c1.48-.73 2.5-2.25 2.5-4.02zM14 3.23v2.06c2.89.86 5 3.54 5 6.71s-2.11 5.85-5 6.71v2.06c4.01-.91 7-4.49 7-8.77s-2.99-7.86-7-8.77z"/>
  </svg>`,volumeMedium:`<svg viewBox="0 0 24 24" fill="currentColor">
    <path d="M3 9v6h4l5 5V4L7 9H3zm13.5 3c0-1.77-1.02-3.29-2.5-4.03v8.05c1.48-.73 2.5-2.25 2.5-4.02z"/>
  </svg>`,volumeLow:`<svg viewBox="0 0 24 24" fill="currentColor">
    <path d="M7 9v6h4l5 5V4l-5 5H7z"/>
  </svg>`,volumeMuted:`<svg viewBox="0 0 24 24" fill="currentColor">
    <path d="M16.5 12c0-1.77-1.02-3.29-2.5-4.03v2.21l2.45 2.45c.03-.2.05-.41.05-.63zm2.5 0c0 .94-.2 1.82-.54 2.64l1.51 1.51C20.63 14.91 21 13.5 21 12c0-4.28-2.99-7.86-7-8.77v2.06c2.89.86 5 3.54 5 6.71zM4.27 3L3 4.27 7.73 9H3v6h4l5 5v-6.73l4.25 4.25c-.67.52-1.42.93-2.25 1.18v2.06c1.38-.31 2.63-.95 3.69-1.81L19.73 21 21 19.73l-9-9L4.27 3zM12 4L9.91 6.09 12 8.18V4z"/>
  </svg>`,fullscreen:`<svg viewBox="0 0 24 24" fill="currentColor">
    <path d="M7 14H5v5h5v-2H7v-3zm-2-4h2V7h3V5H5v5zm12 7h-3v2h5v-5h-2v3zM14 5v2h3v3h2V5h-5z"/>
  </svg>`,fullscreenExit:`<svg viewBox="0 0 24 24" fill="currentColor">
    <path d="M5 16h3v3h2v-5H5v2zm3-8H5v2h5V5H8v3zm6 11h2v-3h3v-2h-5v5zm2-11V5h-2v5h5V8h-3z"/>
  </svg>`,settings:`<svg viewBox="0 0 24 24" fill="currentColor">
    <path d="M19.14 12.94c.04-.3.06-.61.06-.94 0-.32-.02-.64-.07-.94l2.03-1.58c.18-.14.23-.41.12-.61l-1.92-3.32c-.12-.22-.37-.29-.59-.22l-2.39.96c-.5-.38-1.03-.7-1.62-.94L14.4 2.81c-.04-.24-.24-.41-.48-.41h-3.84c-.24 0-.43.17-.47.41l-.36 2.54c-.59.24-1.13.57-1.62.94l-2.39-.96c-.22-.08-.47 0-.59.22L2.74 8.87c-.12.21-.08.47.12.61l2.03 1.58c-.05.3-.09.63-.09.94s.02.64.07.94l-2.03 1.58c-.18.14-.23.41-.12.61l1.92 3.32c.12.22.37.29.59.22l2.39-.96c.5.38 1.03.7 1.62.94l.36 2.54c.05.24.24.41.48.41h3.84c.24 0 .44-.17.47-.41l.36-2.54c.59-.24 1.13-.56 1.62-.94l2.39.96c.22.08.47 0 .59-.22l1.92-3.32c.12-.22.07-.47-.12-.61l-2.01-1.58zM12 15.6c-1.98 0-3.6-1.62-3.6-3.6s1.62-3.6 3.6-3.6 3.6 1.62 3.6 3.6-1.62 3.6-3.6 3.6z"/>
  </svg>`,captions:`<svg viewBox="0 0 24 24" fill="currentColor">
    <path d="M19 4H5c-1.11 0-2 .9-2 2v12c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm-8 7H9.5v-.5h-2v3h2V13H11v1c0 .55-.45 1-1 1H7c-.55 0-1-.45-1-1v-4c0-.55.45-1 1-1h3c.55 0 1 .45 1 1v1zm7 0h-1.5v-.5h-2v3h2V13H18v1c0 .55-.45 1-1 1h-3c-.55 0-1-.45-1-1v-4c0-.55.45-1 1-1h3c.55 0 1 .45 1 1v1z"/>
  </svg>`,captionsOff:`<svg viewBox="0 0 24 24" fill="currentColor">
    <path d="M19 4H5c-1.11 0-2 .9-2 2v12c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm-8 7H9.5v-.5h-2v3h2V13H11v1c0 .55-.45 1-1 1H7c-.55 0-1-.45-1-1v-4c0-.55.45-1 1-1h3c.55 0 1 .45 1 1v1zm7 0h-1.5v-.5h-2v3h2V13H18v1c0 .55-.45 1-1 1h-3c-.55 0-1-.45-1-1v-4c0-.55.45-1 1-1h3c.55 0 1 .45 1 1v1z"/>
    <path d="M0 0h24v24H0z" fill="none"/>
  </svg>`,pip:`<svg viewBox="0 0 24 24" fill="currentColor">
    <path d="M19 7h-8v6h8V7zm2-4H3c-1.1 0-2 .9-2 2v14c0 1.1.9 1.98 2 1.98h18c1.1 0 2-.88 2-1.98V5c0-1.1-.9-2-2-2zm0 16.01H3V4.98h18v14.03z"/>
  </svg>`,speed:`<svg viewBox="0 0 24 24" fill="currentColor">
    <path d="M20.38 8.57l-1.23 1.85a8 8 0 0 1-.22 7.58H5.07A8 8 0 0 1 15.58 6.85l1.85-1.23A10 10 0 0 0 3.35 19a2 2 0 0 0 1.72 1h13.85a2 2 0 0 0 1.74-1 10 10 0 0 0-.27-10.44z"/>
    <path d="M10.59 15.41a2 2 0 0 0 2.83 0l5.66-8.49-8.49 5.66a2 2 0 0 0 0 2.83z"/>
  </svg>`,close:`<svg viewBox="0 0 24 24" fill="currentColor">
    <path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/>
  </svg>`,check:`<svg viewBox="0 0 24 24" fill="currentColor">
    <path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"/>
  </svg>`,arrowUp:`<svg viewBox="0 0 24 24" fill="currentColor">
    <path d="M7 14l5-5 5 5z"/>
  </svg>`,arrowDown:`<svg viewBox="0 0 24 24" fill="currentColor">
    <path d="M7 10l5 5 5-5z"/>
  </svg>`,arrowLeft:`<svg viewBox="0 0 24 24" fill="currentColor">
    <path d="M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"/>
  </svg>`,arrowRight:`<svg viewBox="0 0 24 24" fill="currentColor">
    <path d="M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"/>
  </svg>`,loading:`<svg viewBox="0 0 24 24" fill="currentColor">
    <path d="M12 4V1L8 5l4 4V6c3.31 0 6 2.69 6 6 0 1.01-.25 1.97-.7 2.8l1.46 1.46C19.54 15.03 20 13.57 20 12c0-4.42-3.58-8-8-8zm0 14c-3.31 0-6-2.69-6-6 0-1.01.25-1.97.7-2.8L5.24 7.74C4.46 8.97 4 10.43 4 12c0 4.42 3.58 8 8 8v3l4-4-4-4v3z"/>
  </svg>`,error:`<svg viewBox="0 0 24 24" fill="currentColor">
    <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-2h2v2zm0-4h-2V7h2v6z"/>
  </svg>`,download:`<svg viewBox="0 0 24 24" fill="currentColor">
    <path d="M19 9h-4V3H9v6H5l7 7 7-7zM5 18v2h14v-2H5z"/>
  </svg>`,link:`<svg viewBox="0 0 24 24" fill="currentColor">
    <path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"/>
  </svg>`,playlist:`<svg viewBox="0 0 24 24" fill="currentColor">
    <path d="M15 6H3v2h12V6zm0 4H3v2h12v-2zM3 16h8v-2H3v2zM17 6v8.18c-.31-.11-.65-.18-1-.18-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3V8h3V6h-5z"/>
  </svg>`,language:`<svg viewBox="0 0 24 24" fill="currentColor">
    <path d="M11.99 2C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2zm6.93 6h-2.95c-.32-1.25-.78-2.45-1.38-3.56 1.84.63 3.37 1.91 4.33 3.56zM12 4.04c.83 1.2 1.48 2.53 1.91 3.96h-3.82c.43-1.43 1.08-2.76 1.91-3.96zM4.26 14C4.1 13.36 4 12.69 4 12s.1-1.36.26-2h3.38c-.08.66-.14 1.32-.14 2 0 .68.06 1.34.14 2H4.26zm.82 2h2.95c.32 1.25.78 2.45 1.38 3.56-1.84-.63-3.37-1.9-4.33-3.56zm2.95-8H5.08c.96-1.66 2.49-2.93 4.33-3.56C8.81 5.55 8.35 6.75 8.03 8zM12 19.96c-.83-1.2-1.48-2.53-1.91-3.96h3.82c-.43 1.43-1.08 2.76-1.91 3.96zM14.34 14H9.66c-.09-.66-.16-1.32-.16-2 0-.68.07-1.35.16-2h4.68c.09.65.16 1.32.16 2 0 .68-.07 1.34-.16 2zm.25 5.56c.6-1.11 1.06-2.31 1.38-3.56h2.95c-.96 1.65-2.49 2.93-4.33 3.56zM16.36 14c.08-.66.14-1.32.14-2 0-.68-.06-1.34-.14-2h3.38c.16.64.26 1.31.26 2s-.1 1.36-.26 2h-3.38z"/>
  </svg>`,hd:`<svg viewBox="0 0 24 24" fill="currentColor">
    <path d="M19 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.11 0 2-.9 2-2V5c0-1.1-.89-2-2-2zm-8 12H9.5v-2h-2v2H6V9h1.5v2.5h2V9H11v6zm7-1c0 .55-.45 1-1 1h-.75v1.5h-1.5V15H14c-.55 0-1-.45-1-1v-4c0-.55.45-1 1-1h3c.55 0 1 .45 1 1v4zm-3.5-.5h2v-3h-2v3z"/>
  </svg>`,transcript:`<svg viewBox="0 0 24 24" fill="currentColor">
    <path d="M14 2H6c-1.1 0-1.99.9-1.99 2L4 20c0 1.1.89 2 1.99 2H18c1.1 0 2-.9 2-2V8l-6-6zm2 16H8v-2h8v2zm0-4H8v-2h8v2zm-3-5V3.5L18.5 9H13z"/>
  </svg>`,audioDescription:`<svg viewBox="0 0 24 24" fill="currentColor">
    <path d="M12 3v9.28c-.47-.17-.97-.28-1.5-.28C8.01 12 6 14.01 6 16.5S8.01 21 10.5 21c2.31 0 4.2-1.75 4.45-4H15V6h4V3h-7z"/>
    <path d="M10.5 19c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z"/>
  </svg>`,audioDescriptionOn:`<svg viewBox="0 0 24 24" fill="currentColor">
    <path d="M12 3v9.28c-.47-.17-.97-.28-1.5-.28C8.01 12 6 14.01 6 16.5S8.01 21 10.5 21c2.31 0 4.2-1.75 4.45-4H15V6h4V3h-7z"/>
    <path d="M10.5 19c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z"/>
    <circle cx="19" cy="16" r="3" fill="#3b82f6"/>
    <path d="M18.5 17.5l1-1 1.5 1.5" stroke="white" stroke-width="1.5" fill="none" stroke-linecap="round" stroke-linejoin="round"/>
  </svg>`,signLanguage:`<svg viewBox="0 0 24 24" fill="currentColor">
    <path d="M12 2C10.34 2 9 3.34 9 5v4c0 .34.07.66.18.96L7.5 8.29C7.19 8.1 6.85 8 6.5 8 5.12 8 4 9.12 4 10.5v3c0 .83.67 1.5 1.5 1.5s1.5-.67 1.5-1.5v-3c0-.28.22-.5.5-.5s.5.22.5.5V14l2 2v-1c0-.55.45-1 1-1s1 .45 1 1v2c0 .55.45 1 1 1s1-.45 1-1V9c0-.55.45-1 1-1s1 .45 1 1v8c0 2.21-1.79 4-4 4s-4-1.79-4-4v-2.83l-2.93-2.93A3.93 3.93 0 0 1 4 8c0-1.66 1.34-3 3-3 .83 0 1.58.34 2.12.88L11 7.76V5c0-.55.45-1 1-1s1 .45 1 1v4c0 .55.45 1 1 1s1-.45 1-1V5c0-1.66-1.34-3-3-3z"/>
  </svg>`,signLanguageOn:`<svg viewBox="0 0 24 24" fill="currentColor">
    <path d="M12 2C10.34 2 9 3.34 9 5v4c0 .34.07.66.18.96L7.5 8.29C7.19 8.1 6.85 8 6.5 8 5.12 8 4 9.12 4 10.5v3c0 .83.67 1.5 1.5 1.5s1.5-.67 1.5-1.5v-3c0-.28.22-.5.5-.5s.5.22.5.5V14l2 2v-1c0-.55.45-1 1-1s1 .45 1 1v2c0 .55.45 1 1 1s1-.45 1-1V9c0-.55.45-1 1-1s1 .45 1 1v8c0 2.21-1.79 4-4 4s-4-1.79-4-4v-2.83l-2.93-2.93A3.93 3.93 0 0 1 4 8c0-1.66 1.34-3 3-3 .83 0 1.58.34 2.12.88L11 7.76V5c0-.55.45-1 1-1s1 .45 1 1v4c0 .55.45 1 1 1s1-.45 1-1V5c0-1.66-1.34-3-3-3z"/>
    <circle cx="19" cy="16" r="3" fill="#3b82f6"/>
    <path d="M18.5 17.5l1-1 1.5 1.5" stroke="white" stroke-width="1.5" fill="none" stroke-linecap="round" stroke-linejoin="round"/>
  </svg>`,speaker:`<svg viewBox="0 0 24 24" fill="currentColor">
    <path d="M3 9v6h4l5 5V4L7 9H3zm13.5 3c0-1.77-1.02-3.29-2.5-4.03v8.05c1.48-.73 2.5-2.25 2.5-4.02z"/>
  </svg>`,music:`<svg viewBox="0 0 24 24" fill="currentColor">
    <path d="M12 3v9.28c-.47-.17-.97-.28-1.5-.28C8.01 12 6 14.01 6 16.5S8.01 21 10.5 21c2.31 0 4.2-1.75 4.45-4H15V6h4V3h-7zm-1.5 16c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z"/>
  </svg>`};function O(l){return H[l]||H.play}function h(l,e=""){let t=document.createElement("span");return t.className=`vidply-icon ${e}`.trim(),t.innerHTML=O(l),t.setAttribute("aria-hidden","true"),t}var B={en:{player:{label:"Video Player",play:"Play",pause:"Pause",stop:"Stop",rewind:"Rewind",forward:"Forward",volume:"Volume",mute:"Mute",unmute:"Unmute",fullscreen:"Fullscreen",exitFullscreen:"Exit Fullscreen",captions:"Captions",settings:"Settings",speed:"Playback Speed",pip:"Picture in Picture",currentTime:"Current time",duration:"Duration",progress:"Progress",seekForward:"Seek forward {seconds} seconds",seekBackward:"Seek backward {seconds} seconds",volumeUp:"Volume up",volumeDown:"Volume down",loading:"Loading...",error:"Error loading media",buffering:"Buffering...",signLanguageVideo:"Sign Language Video"},captions:{off:"Off",select:"Select captions",fontSize:"Font Size",fontFamily:"Font Family",color:"Text Color",backgroundColor:"Background Color",opacity:"Opacity"},settings:{title:"Settings",quality:"Quality",speed:"Speed",captions:"Captions",language:"Language",reset:"Reset to defaults",close:"Close"},speeds:{"0.25":"0.25x","0.5":"0.5x","0.75":"0.75x",1:"Normal","1.25":"1.25x","1.5":"1.5x","1.75":"1.75x",2:"2x"}},de:{player:{label:"Videoplayer",play:"Abspielen",pause:"Pause",stop:"Stopp",rewind:"Zur\xFCckspulen",forward:"Vorspulen",volume:"Lautst\xE4rke",mute:"Stumm",unmute:"Ton ein",fullscreen:"Vollbild",exitFullscreen:"Vollbild beenden",captions:"Untertitel",settings:"Einstellungen",speed:"Wiedergabegeschwindigkeit",pip:"Bild-in-Bild",currentTime:"Aktuelle Zeit",duration:"Dauer",progress:"Fortschritt",loading:"L\xE4dt...",error:"Fehler beim Laden",buffering:"Puffern...",signLanguageVideo:"Geb\xE4rdensprache-Video"},captions:{off:"Aus",select:"Untertitel ausw\xE4hlen",fontSize:"Schriftgr\xF6\xDFe",fontFamily:"Schriftart",color:"Textfarbe",backgroundColor:"Hintergrundfarbe",opacity:"Deckkraft"},settings:{title:"Einstellungen",quality:"Qualit\xE4t",speed:"Geschwindigkeit",captions:"Untertitel",language:"Sprache",reset:"Zur\xFCcksetzen",close:"Schlie\xDFen"}},es:{player:{label:"Reproductor de video",play:"Reproducir",pause:"Pausa",stop:"Detener",rewind:"Retroceder",forward:"Avanzar",volume:"Volumen",mute:"Silenciar",unmute:"Activar sonido",fullscreen:"Pantalla completa",exitFullscreen:"Salir de pantalla completa",captions:"Subt\xEDtulos",settings:"Configuraci\xF3n",speed:"Velocidad de reproducci\xF3n",pip:"Imagen en imagen",currentTime:"Tiempo actual",duration:"Duraci\xF3n",progress:"Progreso",loading:"Cargando...",error:"Error al cargar",buffering:"Almacenando en b\xFAfer...",signLanguageVideo:"Video en Lengua de Se\xF1as"},captions:{off:"Desactivado",select:"Seleccionar subt\xEDtulos",fontSize:"Tama\xF1o de fuente",fontFamily:"Familia de fuente",color:"Color de texto",backgroundColor:"Color de fondo",opacity:"Opacidad"},settings:{title:"Configuraci\xF3n",quality:"Calidad",speed:"Velocidad",captions:"Subt\xEDtulos",language:"Idioma",reset:"Restablecer",close:"Cerrar"}},fr:{player:{label:"Lecteur vid\xE9o",play:"Lecture",pause:"Pause",stop:"Arr\xEAt",rewind:"Reculer",forward:"Avancer",volume:"Volume",mute:"Muet",unmute:"Activer le son",fullscreen:"Plein \xE9cran",exitFullscreen:"Quitter le plein \xE9cran",captions:"Sous-titres",settings:"Param\xE8tres",speed:"Vitesse de lecture",pip:"Image dans l'image",currentTime:"Temps actuel",duration:"Dur\xE9e",progress:"Progression",loading:"Chargement...",error:"Erreur de chargement",buffering:"Mise en m\xE9moire tampon...",signLanguageVideo:"Vid\xE9o en Langue des Signes"},captions:{off:"D\xE9sactiv\xE9",select:"S\xE9lectionner les sous-titres",fontSize:"Taille de police",fontFamily:"Police",color:"Couleur du texte",backgroundColor:"Couleur de fond",opacity:"Opacit\xE9"},settings:{title:"Param\xE8tres",quality:"Qualit\xE9",speed:"Vitesse",captions:"Sous-titres",language:"Langue",reset:"R\xE9initialiser",close:"Fermer"}},ja:{player:{label:"\u30D3\u30C7\u30AA\u30D7\u30EC\u30FC\u30E4\u30FC",play:"\u518D\u751F",pause:"\u4E00\u6642\u505C\u6B62",stop:"\u505C\u6B62",rewind:"\u5DFB\u304D\u623B\u3057",forward:"\u65E9\u9001\u308A",volume:"\u97F3\u91CF",mute:"\u30DF\u30E5\u30FC\u30C8",unmute:"\u30DF\u30E5\u30FC\u30C8\u89E3\u9664",fullscreen:"\u5168\u753B\u9762\u8868\u793A",exitFullscreen:"\u5168\u753B\u9762\u8868\u793A\u3092\u7D42\u4E86",captions:"\u5B57\u5E55",settings:"\u8A2D\u5B9A",speed:"\u518D\u751F\u901F\u5EA6",pip:"\u30D4\u30AF\u30C1\u30E3\u30FC\u30A4\u30F3\u30D4\u30AF\u30C1\u30E3\u30FC",currentTime:"\u73FE\u5728\u306E\u6642\u9593",duration:"\u518D\u751F\u6642\u9593",progress:"\u9032\u884C\u72B6\u6CC1",loading:"\u8AAD\u307F\u8FBC\u307F\u4E2D...",error:"\u8AAD\u307F\u8FBC\u307F\u30A8\u30E9\u30FC",buffering:"\u30D0\u30C3\u30D5\u30A1\u30EA\u30F3\u30B0\u4E2D...",signLanguageVideo:"\u624B\u8A71\u52D5\u753B"},captions:{off:"\u30AA\u30D5",select:"\u5B57\u5E55\u3092\u9078\u629E",fontSize:"\u30D5\u30A9\u30F3\u30C8\u30B5\u30A4\u30BA",fontFamily:"\u30D5\u30A9\u30F3\u30C8",color:"\u30C6\u30AD\u30B9\u30C8\u306E\u8272",backgroundColor:"\u80CC\u666F\u8272",opacity:"\u4E0D\u900F\u660E\u5EA6"},settings:{title:"\u8A2D\u5B9A",quality:"\u753B\u8CEA",speed:"\u901F\u5EA6",captions:"\u5B57\u5E55",language:"\u8A00\u8A9E",reset:"\u30EA\u30BB\u30C3\u30C8",close:"\u9589\u3058\u308B"}}};var S=class{constructor(){this.currentLanguage="en",this.translations=B}setLanguage(e){this.translations[e]?this.currentLanguage=e:(console.warn(`Language "${e}" not found, falling back to English`),this.currentLanguage="en")}getLanguage(){return this.currentLanguage}t(e,t={}){let s=e.split("."),i=this.translations[this.currentLanguage];for(let n of s)if(i&&typeof i=="object"&&n in i)i=i[n];else{i=this.translations.en;for(let r of s)if(i&&typeof i=="object"&&r in i)i=i[r];else return e;break}return typeof i=="string"&&Object.entries(t).forEach(([n,r])=>{i=i.replace(new RegExp(`{${n}}`,"g"),r)}),i}addTranslation(e,t){this.translations[e]||(this.translations[e]={}),Object.assign(this.translations[e],t)}},p=new S;var C=class{constructor(e){this.player=e,this.element=null,this.controls={},this.hideTimeout=null,this.isDraggingProgress=!1,this.isDraggingVolume=!1,this.init()}init(){this.createElement(),this.createControls(),this.attachEvents(),this.setupAutoHide()}attachMenuCloseHandler(e,t,s=!1){setTimeout(()=>{let i=r=>{s&&e.contains(r.target)||!e.contains(r.target)&&!t.contains(r.target)&&(e.remove(),document.removeEventListener("click",i),document.removeEventListener("keydown",n))},n=r=>{r.key==="Escape"&&(e.remove(),document.removeEventListener("click",i),document.removeEventListener("keydown",n),t.focus())};document.addEventListener("click",i),document.addEventListener("keydown",n)},100)}createElement(){this.element=a.createElement("div",{className:`${this.player.options.classPrefix}-controls`,attributes:{role:"region","aria-label":p.t("player.label")+" controls"}})}createControls(){this.player.options.progressBar&&this.createProgressBar();let e=a.createElement("div",{className:`${this.player.options.classPrefix}-controls-buttons`}),t=a.createElement("div",{className:`${this.player.options.classPrefix}-controls-left`});this.player.playlistManager&&t.appendChild(this.createPreviousButton()),this.player.options.playPauseButton&&t.appendChild(this.createPlayPauseButton()),this.player.playlistManager&&t.appendChild(this.createNextButton()),this.player.playlistManager||t.appendChild(this.createRewindButton()),this.player.playlistManager||t.appendChild(this.createForwardButton()),this.player.options.volumeControl&&t.appendChild(this.createVolumeControl()),(this.player.options.currentTime||this.player.options.duration)&&t.appendChild(this.createTimeDisplay());let s=a.createElement("div",{className:`${this.player.options.classPrefix}-controls-right`}),i=this.hasChapterTracks(),n=this.hasCaptionTracks(),r=this.hasQualityLevels(),o=this.hasAudioDescription();this.player.options.chaptersButton&&i&&s.appendChild(this.createChaptersButton()),this.player.options.qualityButton&&r&&s.appendChild(this.createQualityButton()),this.player.options.captionStyleButton&&n&&s.appendChild(this.createCaptionStyleButton()),this.player.options.speedButton&&s.appendChild(this.createSpeedButton()),this.player.options.captionsButton&&n&&s.appendChild(this.createCaptionsButton()),this.player.options.transcriptButton&&n&&s.appendChild(this.createTranscriptButton()),this.player.options.audioDescriptionButton&&o&&s.appendChild(this.createAudioDescriptionButton());let c=this.hasSignLanguage();this.player.options.signLanguageButton&&c&&s.appendChild(this.createSignLanguageButton()),this.player.options.pipButton&&"pictureInPictureEnabled"in document&&s.appendChild(this.createPipButton()),this.player.options.fullscreenButton&&s.appendChild(this.createFullscreenButton()),e.appendChild(t),e.appendChild(s),this.element.appendChild(e)}hasChapterTracks(){let e=this.player.element.textTracks;for(let t=0;t<e.length;t++)if(e[t].kind==="chapters")return!0;return!1}hasCaptionTracks(){let e=this.player.element.textTracks;for(let t=0;t<e.length;t++)if(e[t].kind==="captions"||e[t].kind==="subtitles")return!0;return!1}hasQualityLevels(){if(this.player.renderer&&this.player.renderer.hls){let e=this.player.renderer.hls.levels;return e&&e.length>1}return!1}hasAudioDescription(){return this.player.audioDescriptionSrc&&this.player.audioDescriptionSrc.length>0}hasSignLanguage(){return this.player.signLanguageSrc&&this.player.signLanguageSrc.length>0}createProgressBar(){let e=a.createElement("div",{className:`${this.player.options.classPrefix}-progress-container`,attributes:{role:"slider","aria-label":p.t("player.progress"),"aria-valuemin":"0","aria-valuemax":"100","aria-valuenow":"0",tabindex:"0"}});this.controls.buffered=a.createElement("div",{className:`${this.player.options.classPrefix}-progress-buffered`}),this.controls.played=a.createElement("div",{className:`${this.player.options.classPrefix}-progress-played`}),this.controls.progressHandle=a.createElement("div",{className:`${this.player.options.classPrefix}-progress-handle`}),this.controls.progressTooltip=a.createElement("div",{className:`${this.player.options.classPrefix}-progress-tooltip`}),e.appendChild(this.controls.buffered),e.appendChild(this.controls.played),this.controls.played.appendChild(this.controls.progressHandle),e.appendChild(this.controls.progressTooltip),this.controls.progress=e,this.element.appendChild(e),this.setupProgressBarEvents()}setupProgressBarEvents(){let e=this.controls.progress,t=s=>{let i=e.getBoundingClientRect(),n=Math.max(0,Math.min(1,(s-i.left)/i.width)),r=n*this.player.state.duration;return{percent:n,time:r}};e.addEventListener("mousedown",s=>{this.isDraggingProgress=!0;let{time:i}=t(s.clientX);this.player.seek(i)}),document.addEventListener("mousemove",s=>{if(this.isDraggingProgress){let{time:i}=t(s.clientX);this.player.seek(i)}}),document.addEventListener("mouseup",()=>{this.isDraggingProgress=!1}),e.addEventListener("mousemove",s=>{if(!this.isDraggingProgress){let{time:i}=t(s.clientX);this.controls.progressTooltip.textContent=m.formatTime(i),this.controls.progressTooltip.style.left=`${s.clientX-e.getBoundingClientRect().left}px`,this.controls.progressTooltip.style.display="block"}}),e.addEventListener("mouseleave",()=>{this.controls.progressTooltip.style.display="none"}),e.addEventListener("keydown",s=>{s.key==="ArrowLeft"?(s.preventDefault(),this.player.seekBackward(5)):s.key==="ArrowRight"&&(s.preventDefault(),this.player.seekForward(5))}),e.addEventListener("touchstart",s=>{this.isDraggingProgress=!0;let i=s.touches[0],{time:n}=t(i.clientX);this.player.seek(n)}),e.addEventListener("touchmove",s=>{if(this.isDraggingProgress){s.preventDefault();let i=s.touches[0],{time:n}=t(i.clientX);this.player.seek(n)}}),e.addEventListener("touchend",()=>{this.isDraggingProgress=!1})}createPlayPauseButton(){let e=a.createElement("button",{className:`${this.player.options.classPrefix}-button ${this.player.options.classPrefix}-play-pause`,attributes:{type:"button","aria-label":p.t("player.play")}});return e.appendChild(h("play")),e.addEventListener("click",()=>{this.player.toggle()}),this.controls.playPause=e,e}createPreviousButton(){let e=a.createElement("button",{className:`${this.player.options.classPrefix}-button ${this.player.options.classPrefix}-previous`,attributes:{type:"button","aria-label":"Previous track"}});e.appendChild(h("skipPrevious")),e.addEventListener("click",()=>{this.player.playlistManager&&this.player.playlistManager.previous()});let t=()=>{this.player.playlistManager&&(e.disabled=!this.player.playlistManager.hasPrevious()&&!this.player.playlistManager.options.loop)};return this.player.on("playlisttrackchange",t),t(),this.controls.previous=e,e}createNextButton(){let e=a.createElement("button",{className:`${this.player.options.classPrefix}-button ${this.player.options.classPrefix}-next`,attributes:{type:"button","aria-label":"Next track"}});e.appendChild(h("skipNext")),e.addEventListener("click",()=>{this.player.playlistManager&&this.player.playlistManager.next()});let t=()=>{this.player.playlistManager&&(e.disabled=!this.player.playlistManager.hasNext()&&!this.player.playlistManager.options.loop)};return this.player.on("playlisttrackchange",t),t(),this.controls.next=e,e}createRewindButton(){let e=a.createElement("button",{className:`${this.player.options.classPrefix}-button ${this.player.options.classPrefix}-rewind`,attributes:{type:"button","aria-label":"Rewind 15 seconds"}});return e.appendChild(h("rewind")),e.addEventListener("click",()=>{this.player.seekBackward(15)}),e}createForwardButton(){let e=a.createElement("button",{className:`${this.player.options.classPrefix}-button ${this.player.options.classPrefix}-forward`,attributes:{type:"button","aria-label":"Forward 15 seconds"}});return e.appendChild(h("forward")),e.addEventListener("click",()=>{this.player.seekForward(15)}),e}createVolumeControl(){let e=a.createElement("button",{className:`${this.player.options.classPrefix}-button ${this.player.options.classPrefix}-mute`,attributes:{type:"button","aria-label":p.t("player.volume"),"aria-haspopup":"true"}});return e.appendChild(h("volumeHigh")),e.addEventListener("contextmenu",t=>{t.preventDefault(),this.player.toggleMute()}),e.addEventListener("click",()=>{this.showVolumeSlider(e)}),this.controls.mute=e,e}showVolumeSlider(e){let t=document.querySelector(`.${this.player.options.classPrefix}-volume-menu`);if(t){t.remove();return}let s=a.createElement("div",{className:`${this.player.options.classPrefix}-volume-menu ${this.player.options.classPrefix}-menu`}),i=a.createElement("div",{className:`${this.player.options.classPrefix}-volume-slider`,attributes:{role:"slider","aria-label":p.t("player.volume"),"aria-valuemin":"0","aria-valuemax":"100","aria-valuenow":String(Math.round(this.player.state.volume*100)),tabindex:"0"}}),n=a.createElement("div",{className:`${this.player.options.classPrefix}-volume-track`}),r=a.createElement("div",{className:`${this.player.options.classPrefix}-volume-fill`}),o=a.createElement("div",{className:`${this.player.options.classPrefix}-volume-handle`});n.appendChild(r),r.appendChild(o),i.appendChild(n),s.appendChild(i);let c=d=>{let u=n.getBoundingClientRect(),g=Math.max(0,Math.min(1,1-(d-u.top)/u.height));this.player.setVolume(g)};i.addEventListener("mousedown",d=>{d.stopPropagation(),this.isDraggingVolume=!0,c(d.clientY)}),document.addEventListener("mousemove",d=>{this.isDraggingVolume&&c(d.clientY)}),document.addEventListener("mouseup",()=>{this.isDraggingVolume=!1}),i.addEventListener("keydown",d=>{d.key==="ArrowUp"?(d.preventDefault(),this.player.setVolume(Math.min(1,this.player.state.volume+.1))):d.key==="ArrowDown"&&(d.preventDefault(),this.player.setVolume(Math.max(0,this.player.state.volume-.1)))}),s.addEventListener("click",d=>{d.stopPropagation()}),e.appendChild(s),this.controls.volumeSlider=i,this.controls.volumeFill=r,this.attachMenuCloseHandler(s,e,!0)}createTimeDisplay(){let e=a.createElement("div",{className:`${this.player.options.classPrefix}-time`});this.controls.currentTimeDisplay=a.createElement("span",{className:`${this.player.options.classPrefix}-current-time`,textContent:"00:00"});let t=a.createElement("span",{textContent:" / ",attributes:{"aria-hidden":"true"}});return this.controls.durationDisplay=a.createElement("span",{className:`${this.player.options.classPrefix}-duration`,textContent:"00:00"}),e.appendChild(this.controls.currentTimeDisplay),e.appendChild(t),e.appendChild(this.controls.durationDisplay),e}createChaptersButton(){let e=a.createElement("button",{className:`${this.player.options.classPrefix}-button ${this.player.options.classPrefix}-chapters`,attributes:{type:"button","aria-label":"Chapters","aria-haspopup":"menu"}});return e.appendChild(h("playlist")),e.addEventListener("click",()=>{this.showChaptersMenu(e)}),this.controls.chapters=e,e}showChaptersMenu(e){let t=document.querySelector(`.${this.player.options.classPrefix}-chapters-menu`);if(t){t.remove();return}let s=a.createElement("div",{className:`${this.player.options.classPrefix}-chapters-menu ${this.player.options.classPrefix}-menu`,attributes:{role:"menu","aria-label":"Chapters"}}),i=Array.from(this.player.element.textTracks).filter(n=>n.kind==="chapters");if(i.length===0){let n=a.createElement("div",{className:`${this.player.options.classPrefix}-menu-item`,textContent:"No chapters available",style:{opacity:"0.5",cursor:"default"}});s.appendChild(n)}else{let n=i[0];if(n.mode==="disabled"&&(n.mode="hidden"),!n.cues||n.cues.length===0){let r=a.createElement("div",{className:`${this.player.options.classPrefix}-menu-item`,textContent:"Loading chapters...",style:{opacity:"0.5",cursor:"default"}});s.appendChild(r);let o=()=>{s.remove(),this.showChaptersMenu(e)};n.addEventListener("load",o,{once:!0}),setTimeout(()=>{n.cues&&n.cues.length>0&&document.contains(s)&&(s.remove(),this.showChaptersMenu(e))},500)}else{let r=n.cues;for(let o=0;o<r.length;o++){let c=r[o],d=a.createElement("button",{className:`${this.player.options.classPrefix}-menu-item`,attributes:{type:"button",role:"menuitem"}}),u=a.createElement("span",{className:`${this.player.options.classPrefix}-chapter-time`,textContent:m.formatTime(c.startTime)}),g=a.createElement("span",{className:`${this.player.options.classPrefix}-chapter-title`,textContent:c.text});d.appendChild(u),d.appendChild(document.createTextNode(" ")),d.appendChild(g),d.addEventListener("click",()=>{this.player.seek(c.startTime),s.remove()}),s.appendChild(d)}}}e.appendChild(s),this.attachMenuCloseHandler(s,e)}createQualityButton(){let e=a.createElement("button",{className:`${this.player.options.classPrefix}-button ${this.player.options.classPrefix}-quality`,attributes:{type:"button","aria-label":"Quality","aria-haspopup":"menu"}});return e.appendChild(h("hd")),e.addEventListener("click",()=>{this.showQualityMenu(e)}),this.controls.quality=e,e}showQualityMenu(e){let t=document.querySelector(`.${this.player.options.classPrefix}-quality-menu`);if(t){t.remove();return}let s=a.createElement("div",{className:`${this.player.options.classPrefix}-quality-menu ${this.player.options.classPrefix}-menu`,attributes:{role:"menu","aria-label":"Quality"}});if(this.player.renderer&&this.player.renderer.getQualities){let i=this.player.renderer.getQualities();if(i.length===0){let n=a.createElement("div",{className:`${this.player.options.classPrefix}-menu-item`,textContent:"Auto (no quality selection available)",style:{opacity:"0.5",cursor:"default"}});s.appendChild(n)}else{let n=a.createElement("button",{className:`${this.player.options.classPrefix}-menu-item`,textContent:"Auto",attributes:{type:"button",role:"menuitem"}});n.addEventListener("click",()=>{this.player.renderer.switchQuality&&this.player.renderer.switchQuality(-1),s.remove()}),s.appendChild(n),i.forEach(r=>{let o=a.createElement("button",{className:`${this.player.options.classPrefix}-menu-item`,textContent:r.name||`${r.height}p`,attributes:{type:"button",role:"menuitem"}});o.addEventListener("click",()=>{this.player.renderer.switchQuality&&this.player.renderer.switchQuality(r.index),s.remove()}),s.appendChild(o)})}}else{let i=a.createElement("div",{className:`${this.player.options.classPrefix}-menu-item`,textContent:"Quality selection not available",style:{opacity:"0.5",cursor:"default"}});s.appendChild(i)}e.appendChild(s),this.attachMenuCloseHandler(s,e)}createCaptionStyleButton(){let e=a.createElement("button",{className:`${this.player.options.classPrefix}-button ${this.player.options.classPrefix}-caption-style`,attributes:{type:"button","aria-label":"Caption styling","aria-haspopup":"menu",title:"Caption styling"}}),t=a.createElement("span",{textContent:"Aa",style:{fontSize:"14px",fontWeight:"bold"}});return e.appendChild(t),e.addEventListener("click",()=>{this.showCaptionStyleMenu(e)}),this.controls.captionStyle=e,e}showCaptionStyleMenu(e){let t=document.querySelector(`.${this.player.options.classPrefix}-caption-style-menu`);if(t){t.remove();return}let s=a.createElement("div",{className:`${this.player.options.classPrefix}-caption-style-menu ${this.player.options.classPrefix}-menu ${this.player.options.classPrefix}-settings-menu`,attributes:{role:"menu","aria-label":"Caption styling"}});if(s.addEventListener("click",d=>{d.stopPropagation()}),!this.player.captionManager||this.player.captionManager.tracks.length===0){let d=a.createElement("div",{className:`${this.player.options.classPrefix}-menu-item`,textContent:"No captions available",style:{opacity:"0.5",cursor:"default",padding:"12px 16px"}});s.appendChild(d),e.appendChild(s),this.attachMenuCloseHandler(s,e,!0);return}let i=this.createStyleControl("Font Size","captionsFontSize",[{label:"Small",value:"80%"},{label:"Medium",value:"100%"},{label:"Large",value:"120%"},{label:"X-Large",value:"150%"}]);s.appendChild(i);let n=this.createStyleControl("Font","captionsFontFamily",[{label:"Sans-serif",value:"sans-serif"},{label:"Serif",value:"serif"},{label:"Monospace",value:"monospace"}]);s.appendChild(n);let r=this.createColorControl("Text Color","captionsColor");s.appendChild(r);let o=this.createColorControl("Background","captionsBackgroundColor");s.appendChild(o);let c=this.createOpacityControl("Opacity","captionsOpacity");s.appendChild(c),s.style.minWidth="220px",e.appendChild(s),this.attachMenuCloseHandler(s,e,!0)}createStyleControl(e,t,s){let i=a.createElement("div",{className:`${this.player.options.classPrefix}-style-group`}),n=a.createElement("label",{textContent:e,style:{display:"block",fontSize:"12px",marginBottom:"4px",color:"rgba(255,255,255,0.7)"}});i.appendChild(n);let r=a.createElement("select",{className:`${this.player.options.classPrefix}-style-select`,style:{width:"100%",padding:"6px",background:"var(--vidply-white)",border:"1px solid var(--vidply-white-10)",borderRadius:"4px",color:"var(--vidply-black)",fontSize:"13px"}}),o=this.player.options[t];return s.forEach(c=>{let d=a.createElement("option",{textContent:c.label,attributes:{value:c.value}});c.value===o&&(d.selected=!0),r.appendChild(d)}),r.addEventListener("mousedown",c=>{c.stopPropagation()}),r.addEventListener("click",c=>{c.stopPropagation()}),r.addEventListener("change",c=>{c.stopPropagation(),this.player.options[t]=c.target.value,this.player.captionManager&&this.player.captionManager.setCaptionStyle(t.replace("captions","").charAt(0).toLowerCase()+t.replace("captions","").slice(1),c.target.value)}),i.appendChild(r),i}createColorControl(e,t){let s=a.createElement("div",{className:`${this.player.options.classPrefix}-style-group`}),i=a.createElement("label",{textContent:e,style:{display:"block",fontSize:"12px",marginBottom:"4px",color:"rgba(255,255,255,0.7)"}});s.appendChild(i);let n=a.createElement("input",{attributes:{type:"color",value:this.player.options[t]},style:{width:"100%",height:"32px",padding:"2px",background:"rgba(255,255,255,0.1)",border:"1px solid rgba(255,255,255,0.2)",borderRadius:"4px",cursor:"pointer"}});return n.addEventListener("mousedown",r=>{r.stopPropagation()}),n.addEventListener("click",r=>{r.stopPropagation()}),n.addEventListener("change",r=>{r.stopPropagation(),this.player.options[t]=r.target.value,this.player.captionManager&&this.player.captionManager.setCaptionStyle(t.replace("captions","").charAt(0).toLowerCase()+t.replace("captions","").slice(1),r.target.value)}),s.appendChild(n),s}createOpacityControl(e,t){let s=a.createElement("div",{className:`${this.player.options.classPrefix}-style-group`}),i=a.createElement("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"4px"}}),n=a.createElement("label",{textContent:e,style:{fontSize:"12px",color:"rgba(255,255,255,0.7)"}}),r=a.createElement("span",{textContent:Math.round(this.player.options[t]*100)+"%",style:{fontSize:"12px",color:"rgba(255,255,255,0.7)"}});i.appendChild(n),i.appendChild(r),s.appendChild(i);let o=a.createElement("input",{attributes:{type:"range",min:"0",max:"1",step:"0.1",value:String(this.player.options[t])},style:{width:"100%",cursor:"pointer"}});return o.addEventListener("mousedown",c=>{c.stopPropagation()}),o.addEventListener("click",c=>{c.stopPropagation()}),o.addEventListener("input",c=>{c.stopPropagation();let d=parseFloat(c.target.value);r.textContent=Math.round(d*100)+"%",this.player.options[t]=d,this.player.captionManager&&this.player.captionManager.setCaptionStyle(t.replace("captions","").charAt(0).toLowerCase()+t.replace("captions","").slice(1),d)}),s.appendChild(o),s}createSpeedButton(){let e=a.createElement("button",{className:`${this.player.options.classPrefix}-button ${this.player.options.classPrefix}-speed`,attributes:{type:"button","aria-label":p.t("player.speed"),"aria-haspopup":"menu"}});e.appendChild(h("speed"));let t=a.createElement("span",{className:`${this.player.options.classPrefix}-speed-text`,textContent:"1x"});return e.appendChild(t),e.addEventListener("click",()=>{this.showSpeedMenu(e)}),this.controls.speed=e,this.controls.speedText=t,e}showSpeedMenu(e){let t=document.querySelector(`.${this.player.options.classPrefix}-speed-menu`);if(t){t.remove();return}let s=a.createElement("div",{className:`${this.player.options.classPrefix}-speed-menu ${this.player.options.classPrefix}-menu`,attributes:{role:"menu"}});[.25,.5,.75,1,1.25,1.5,1.75,2].forEach(n=>{let r=a.createElement("button",{className:`${this.player.options.classPrefix}-menu-item`,textContent:p.t(`speeds.${n}`)||`${n}x`,attributes:{type:"button",role:"menuitem"}});n===this.player.state.playbackSpeed&&(r.classList.add(`${this.player.options.classPrefix}-menu-item-active`),r.appendChild(h("check"))),r.addEventListener("click",()=>{this.player.setPlaybackSpeed(n),s.remove()}),s.appendChild(r)}),e.appendChild(s),this.attachMenuCloseHandler(s,e)}createCaptionsButton(){let e=a.createElement("button",{className:`${this.player.options.classPrefix}-button ${this.player.options.classPrefix}-captions-button`,attributes:{type:"button","aria-label":p.t("player.captions"),"aria-pressed":"false","aria-haspopup":"menu"}});return e.appendChild(h("captionsOff")),e.addEventListener("click",()=>{this.showCaptionsMenu(e)}),this.controls.captions=e,e}showCaptionsMenu(e){let t=document.querySelector(`.${this.player.options.classPrefix}-captions-menu`);if(t){t.remove();return}let s=a.createElement("div",{className:`${this.player.options.classPrefix}-captions-menu ${this.player.options.classPrefix}-menu`,attributes:{role:"menu","aria-label":p.t("captions.select")}});if(!this.player.captionManager||this.player.captionManager.tracks.length===0){let r=a.createElement("div",{className:`${this.player.options.classPrefix}-menu-item`,textContent:"No captions available",style:{opacity:"0.5",cursor:"default"}});s.appendChild(r),e.appendChild(s),this.attachMenuCloseHandler(s,e);return}let i=a.createElement("button",{className:`${this.player.options.classPrefix}-menu-item`,textContent:p.t("captions.off"),attributes:{type:"button",role:"menuitem"}});this.player.state.captionsEnabled||(i.classList.add(`${this.player.options.classPrefix}-menu-item-active`),i.appendChild(h("check"))),i.addEventListener("click",()=>{this.player.disableCaptions(),this.updateCaptionsButton(),s.remove()}),s.appendChild(i),this.player.captionManager.getAvailableTracks().forEach(r=>{let o=a.createElement("button",{className:`${this.player.options.classPrefix}-menu-item`,textContent:r.label,attributes:{type:"button",role:"menuitem",lang:r.language}});this.player.state.captionsEnabled&&this.player.captionManager.currentTrack===this.player.captionManager.tracks[r.index]&&(o.classList.add(`${this.player.options.classPrefix}-menu-item-active`),o.appendChild(h("check"))),o.addEventListener("click",()=>{this.player.captionManager.switchTrack(r.index),this.updateCaptionsButton(),s.remove()}),s.appendChild(o)}),e.appendChild(s),this.attachMenuCloseHandler(s,e)}updateCaptionsButton(){if(!this.controls.captions)return;let e=this.controls.captions.querySelector(".vidply-icon"),t=this.player.state.captionsEnabled;e.innerHTML=t?h("captions").innerHTML:h("captionsOff").innerHTML,this.controls.captions.setAttribute("aria-pressed",t?"true":"false")}createTranscriptButton(){let e=a.createElement("button",{className:`${this.player.options.classPrefix}-button ${this.player.options.classPrefix}-transcript`,attributes:{type:"button","aria-label":"Toggle transcript","aria-pressed":"false"}});return e.appendChild(h("transcript")),e.addEventListener("click",()=>{this.player.transcriptManager&&(this.player.transcriptManager.toggleTranscript(),this.updateTranscriptButton())}),this.controls.transcript=e,e}updateTranscriptButton(){if(!this.controls.transcript)return;let e=this.player.transcriptManager&&this.player.transcriptManager.isVisible;this.controls.transcript.setAttribute("aria-pressed",e?"true":"false")}createAudioDescriptionButton(){let e=a.createElement("button",{className:`${this.player.options.classPrefix}-button ${this.player.options.classPrefix}-audio-description`,attributes:{type:"button","aria-label":"Audio description","aria-pressed":"false",title:"Toggle audio description"}});return e.appendChild(h("audioDescription")),e.addEventListener("click",async()=>{await this.player.toggleAudioDescription(),this.updateAudioDescriptionButton()}),this.controls.audioDescription=e,e}updateAudioDescriptionButton(){if(!this.controls.audioDescription)return;let e=this.controls.audioDescription.querySelector(".vidply-icon"),t=this.player.state.audioDescriptionEnabled;e.innerHTML=t?h("audioDescriptionOn").innerHTML:h("audioDescription").innerHTML,this.controls.audioDescription.setAttribute("aria-pressed",t?"true":"false"),this.controls.audioDescription.setAttribute("aria-label",t?"Disable audio description":"Enable audio description")}createSignLanguageButton(){let e=a.createElement("button",{className:`${this.player.options.classPrefix}-button ${this.player.options.classPrefix}-sign-language`,attributes:{type:"button","aria-label":"Sign language video","aria-pressed":"false",title:"Toggle sign language video"}});return e.appendChild(h("signLanguage")),e.addEventListener("click",()=>{this.player.toggleSignLanguage(),this.updateSignLanguageButton()}),this.controls.signLanguage=e,e}updateSignLanguageButton(){if(!this.controls.signLanguage)return;let e=this.controls.signLanguage.querySelector(".vidply-icon"),t=this.player.state.signLanguageEnabled;e.innerHTML=t?h("signLanguageOn").innerHTML:h("signLanguage").innerHTML,this.controls.signLanguage.setAttribute("aria-pressed",t?"true":"false"),this.controls.signLanguage.setAttribute("aria-label",t?"Hide sign language video":"Show sign language video")}createSettingsButton(){let e=a.createElement("button",{className:`${this.player.options.classPrefix}-button ${this.player.options.classPrefix}-settings`,attributes:{type:"button","aria-label":p.t("player.settings")}});return e.appendChild(h("settings")),e.addEventListener("click",()=>{this.player.showSettings()}),e}createPipButton(){let e=a.createElement("button",{className:`${this.player.options.classPrefix}-button ${this.player.options.classPrefix}-pip`,attributes:{type:"button","aria-label":p.t("player.pip")}});return e.appendChild(h("pip")),e.addEventListener("click",()=>{this.player.togglePiP()}),e}createFullscreenButton(){let e=a.createElement("button",{className:`${this.player.options.classPrefix}-button ${this.player.options.classPrefix}-fullscreen`,attributes:{type:"button","aria-label":p.t("player.fullscreen")}});return e.appendChild(h("fullscreen")),e.addEventListener("click",()=>{this.player.toggleFullscreen()}),this.controls.fullscreen=e,e}attachEvents(){this.player.on("play",()=>this.updatePlayPauseButton()),this.player.on("pause",()=>this.updatePlayPauseButton()),this.player.on("timeupdate",()=>this.updateProgress()),this.player.on("loadedmetadata",()=>this.updateDuration()),this.player.on("volumechange",()=>this.updateVolumeDisplay()),this.player.on("progress",()=>this.updateBuffered()),this.player.on("playbackspeedchange",()=>this.updateSpeedDisplay()),this.player.on("fullscreenchange",()=>this.updateFullscreenButton()),this.player.on("captionsenabled",()=>this.updateCaptionsButton()),this.player.on("captionsdisabled",()=>this.updateCaptionsButton()),this.player.on("audiodescriptionenabled",()=>this.updateAudioDescriptionButton()),this.player.on("audiodescriptiondisabled",()=>this.updateAudioDescriptionButton()),this.player.on("signlanguageenabled",()=>this.updateSignLanguageButton()),this.player.on("signlanguagedisabled",()=>this.updateSignLanguageButton())}updatePlayPauseButton(){if(!this.controls.playPause)return;let e=this.controls.playPause.querySelector(".vidply-icon"),t=this.player.state.playing;e.innerHTML=t?h("pause").innerHTML:h("play").innerHTML,this.controls.playPause.setAttribute("aria-label",t?p.t("player.pause"):p.t("player.play"))}updateProgress(){if(!this.controls.played)return;let e=this.player.state.currentTime/this.player.state.duration*100;this.controls.played.style.width=`${e}%`,this.controls.progress.setAttribute("aria-valuenow",String(Math.round(e))),this.controls.currentTimeDisplay&&(this.controls.currentTimeDisplay.textContent=m.formatTime(this.player.state.currentTime))}updateDuration(){this.controls.durationDisplay&&(this.controls.durationDisplay.textContent=m.formatTime(this.player.state.duration))}updateVolumeDisplay(){if(!this.controls.volumeFill)return;let e=this.player.state.volume*100;if(this.controls.volumeFill.style.height=`${e}%`,this.controls.mute){let t=this.controls.mute.querySelector(".vidply-icon"),s;this.player.state.muted||this.player.state.volume===0?s="volumeMuted":this.player.state.volume<.3?s="volumeLow":this.player.state.volume<.7?s="volumeMedium":s="volumeHigh",t.innerHTML=h(s).innerHTML,this.controls.mute.setAttribute("aria-label",this.player.state.muted?p.t("player.unmute"):p.t("player.mute"))}this.controls.volumeSlider&&this.controls.volumeSlider.setAttribute("aria-valuenow",String(Math.round(e)))}updateBuffered(){if(!this.controls.buffered||!this.player.element.buffered||this.player.element.buffered.length===0)return;let t=this.player.element.buffered.end(this.player.element.buffered.length-1)/this.player.state.duration*100;this.controls.buffered.style.width=`${t}%`}updateSpeedDisplay(){this.controls.speedText&&(this.controls.speedText.textContent=`${this.player.state.playbackSpeed}x`)}updateFullscreenButton(){if(!this.controls.fullscreen)return;let e=this.controls.fullscreen.querySelector(".vidply-icon"),t=this.player.state.fullscreen;e.innerHTML=t?h("fullscreenExit").innerHTML:h("fullscreen").innerHTML,this.controls.fullscreen.setAttribute("aria-label",t?p.t("player.exitFullscreen"):p.t("player.fullscreen"))}setupAutoHide(){if(this.player.element.tagName!=="VIDEO")return;let e=()=>{this.element.classList.add(`${this.player.options.classPrefix}-controls-visible`),this.player.state.controlsVisible=!0,clearTimeout(this.hideTimeout),this.player.state.playing&&(this.hideTimeout=setTimeout(()=>{this.element.classList.remove(`${this.player.options.classPrefix}-controls-visible`),this.player.state.controlsVisible=!1},this.player.options.hideControlsDelay))};this.player.container.addEventListener("mousemove",e),this.player.container.addEventListener("touchstart",e),this.player.container.addEventListener("click",e),this.element.addEventListener("focusin",e),this.player.on("pause",()=>{e(),clearTimeout(this.hideTimeout)}),this.player.on("play",()=>{e()}),e()}show(){this.element.style.display=""}hide(){this.element.style.display="none"}destroy(){this.hideTimeout&&clearTimeout(this.hideTimeout),this.element&&this.element.parentNode&&this.element.parentNode.removeChild(this.element)}};var f=class{constructor(e){this.player=e,this.element=null,this.tracks=[],this.currentTrack=null,this.currentCue=null,this.init()}init(){this.createElement(),this.loadTracks(),this.attachEvents(),this.player.options.captionsDefault&&this.tracks.length>0&&this.enable()}createElement(){this.element=a.createElement("div",{className:`${this.player.options.classPrefix}-captions`,attributes:{"aria-live":"polite","aria-atomic":"true",role:"region","aria-label":p.t("player.captions")}}),this.updateStyles(),(this.player.videoWrapper||this.player.container).appendChild(this.element)}loadTracks(){let e=this.player.element.textTracks;for(let t=0;t<e.length;t++){let s=e[t];(s.kind==="subtitles"||s.kind==="captions")&&(this.tracks.push({track:s,language:s.language,label:s.label,kind:s.kind,index:t}),s.mode="hidden")}}attachEvents(){this.player.on("timeupdate",()=>{this.updateCaptions()}),this.player.on("captionschange",()=>{this.updateStyles()})}enable(e=0){if(this.tracks.length===0)return;this.currentTrack&&(this.currentTrack.track.mode="hidden");let t=this.tracks[e];t&&(t.track.mode="hidden",this.currentTrack=t,this.player.state.captionsEnabled=!0,this.cueChangeHandler&&t.track.removeEventListener("cuechange",this.cueChangeHandler),this.cueChangeHandler=()=>{this.updateCaptions()},t.track.addEventListener("cuechange",this.cueChangeHandler),this.element.style.display="block",this.player.emit("captionsenabled",t))}disable(){this.currentTrack&&(this.currentTrack.track.mode="hidden",this.currentTrack=null),this.element.style.display="none",this.element.innerHTML="",this.currentCue=null,this.player.state.captionsEnabled=!1,this.player.emit("captionsdisabled")}updateCaptions(){if(!this.currentTrack||!this.currentTrack.track.activeCues)return;let e=this.currentTrack.track.activeCues;if(e.length>0){let t=e[0];if(this.currentCue!==t){this.currentCue=t;let s=t.text;s=this.parseVTTFormatting(s),this.element.innerHTML=a.sanitizeHTML(s),this.element.style.display="block",this.player.emit("captionchange",t)}}else this.currentCue&&(this.element.innerHTML="",this.element.style.display="none",this.currentCue=null)}parseVTTFormatting(e){return e=e.replace(/<c[^>]*>(.*?)<\/c>/g,'<span class="caption-class">$1</span>'),e=e.replace(/<b>(.*?)<\/b>/g,"<strong>$1</strong>"),e=e.replace(/<i>(.*?)<\/i>/g,"<em>$1</em>"),e=e.replace(/<u>(.*?)<\/u>/g,"<u>$1</u>"),e=e.replace(/<v\s+([^>]+)>(.*?)<\/v>/g,'<span class="caption-voice" data-voice="$1">$2</span>'),e}updateStyles(){if(!this.element)return;let e=this.player.options;this.element.style.fontSize=e.captionsFontSize,this.element.style.fontFamily=e.captionsFontFamily,this.element.style.color=e.captionsColor,this.element.style.backgroundColor=this.hexToRgba(e.captionsBackgroundColor,e.captionsOpacity)}hexToRgba(e,t){let s=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return s?`rgba(${parseInt(s[1],16)}, ${parseInt(s[2],16)}, ${parseInt(s[3],16)}, ${t})`:e}setCaptionStyle(e,t){switch(e){case"fontSize":this.player.options.captionsFontSize=t;break;case"fontFamily":this.player.options.captionsFontFamily=t;break;case"color":this.player.options.captionsColor=t;break;case"backgroundColor":this.player.options.captionsBackgroundColor=t;break;case"opacity":this.player.options.captionsOpacity=t;break}this.updateStyles(),this.player.emit("captionschange")}getAvailableTracks(){return this.tracks.map((e,t)=>({index:t,language:e.language,label:e.label||e.language,kind:e.kind}))}switchTrack(e){e>=0&&e<this.tracks.length&&(this.disable(),this.enable(e))}destroy(){this.disable(),this.element&&this.element.parentNode&&this.element.parentNode.removeChild(this.element)}};var E=class{constructor(e){this.player=e,this.shortcuts=e.options.keyboardShortcuts,this.init()}init(){this.attachEvents()}attachEvents(){this.player.container.addEventListener("keydown",e=>{this.handleKeydown(e)}),this.player.container.hasAttribute("tabindex")||this.player.container.setAttribute("tabindex","0")}handleKeydown(e){if(e.target.tagName==="INPUT"||e.target.tagName==="TEXTAREA"||e.target.tagName==="SELECT")return;let t=e.key,s=!1;for(let[i,n]of Object.entries(this.shortcuts))if(n.includes(t)&&(s=this.executeAction(i,e),s)){e.preventDefault(),e.stopPropagation(),this.announceAction(i);break}}executeAction(e,t){switch(e){case"play-pause":return this.player.toggle(),!0;case"volume-up":return this.player.setVolume(Math.min(1,this.player.state.volume+.1)),!0;case"volume-down":return this.player.setVolume(Math.max(0,this.player.state.volume-.1)),!0;case"seek-forward":return this.player.seekForward(),!0;case"seek-backward":return this.player.seekBackward(),!0;case"seek-forward-large":return this.player.seekForward(this.player.options.seekIntervalLarge),!0;case"seek-backward-large":return this.player.seekBackward(this.player.options.seekIntervalLarge),!0;case"mute":return this.player.toggleMute(),!0;case"fullscreen":return this.player.toggleFullscreen(),!0;case"captions":if(this.player.captionManager&&this.player.captionManager.tracks.length>1){let s=document.querySelector(".vidply-captions");s&&this.player.controlBar&&this.player.controlBar.showCaptionsMenu(s)}else this.player.toggleCaptions();return!0;case"speed-up":return this.player.setPlaybackSpeed(Math.min(2,this.player.state.playbackSpeed+.25)),!0;case"speed-down":return this.player.setPlaybackSpeed(Math.max(.25,this.player.state.playbackSpeed-.25)),!0;case"settings":return this.player.showSettings(),!0;default:return!1}}announceAction(e){if(!this.player.options.screenReaderAnnouncements)return;let t="";switch(e){case"play-pause":t=this.player.state.playing?"Playing":"Paused";break;case"volume-up":t=`Volume ${Math.round(this.player.state.volume*100)}%`;break;case"volume-down":t=`Volume ${Math.round(this.player.state.volume*100)}%`;break;case"mute":t=this.player.state.muted?"Muted":"Unmuted";break;case"fullscreen":t=this.player.state.fullscreen?"Fullscreen":"Exit fullscreen";break;case"captions":t=this.player.state.captionsEnabled?"Captions on":"Captions off";break;case"speed-up":case"speed-down":t=`Speed ${this.player.state.playbackSpeed}x`;break}t&&this.announce(t)}announce(e,t="polite"){let s=document.getElementById("vidply-announcer");s||(s=document.createElement("div"),s.id="vidply-announcer",s.className="vidply-sr-only",s.setAttribute("aria-live",t),s.setAttribute("aria-atomic","true"),s.style.cssText=`
        position: absolute;
        left: -10000px;
        width: 1px;
        height: 1px;
        overflow: hidden;
      `,document.body.appendChild(s)),s.textContent="",setTimeout(()=>{s.textContent=e},100)}updateShortcut(e,t){Array.isArray(t)&&(this.shortcuts[e]=t)}destroy(){}};var w=class{constructor(e){this.player=e,this.element=null,this.isOpen=!1,this.init()}init(){this.createElement()}createElement(){this.overlay=a.createElement("div",{className:`${this.player.options.classPrefix}-settings-overlay`,attributes:{role:"dialog","aria-modal":"true","aria-label":p.t("settings.title")}}),this.overlay.style.display="none",this.element=a.createElement("div",{className:`${this.player.options.classPrefix}-settings-dialog`});let e=a.createElement("div",{className:`${this.player.options.classPrefix}-settings-header`}),t=a.createElement("h2",{textContent:p.t("settings.title"),attributes:{id:`${this.player.options.classPrefix}-settings-title`}}),s=a.createElement("button",{className:`${this.player.options.classPrefix}-button ${this.player.options.classPrefix}-settings-close`,attributes:{type:"button","aria-label":p.t("settings.close")}});s.appendChild(h("close")),s.addEventListener("click",()=>this.hide()),e.appendChild(t),e.appendChild(s);let i=a.createElement("div",{className:`${this.player.options.classPrefix}-settings-content`});i.appendChild(this.createSpeedSettings()),this.player.captionManager&&this.player.captionManager.tracks.length>0&&i.appendChild(this.createCaptionSettings());let n=a.createElement("div",{className:`${this.player.options.classPrefix}-settings-footer`}),r=a.createElement("button",{className:`${this.player.options.classPrefix}-button`,textContent:p.t("settings.reset"),attributes:{type:"button"}});r.addEventListener("click",()=>this.resetSettings()),n.appendChild(r),this.element.appendChild(e),this.element.appendChild(i),this.element.appendChild(n),this.overlay.appendChild(this.element),this.player.container.appendChild(this.overlay),this.overlay.addEventListener("click",o=>{o.target===this.overlay&&this.hide()}),document.addEventListener("keydown",o=>{o.key==="Escape"&&this.isOpen&&this.hide()})}createSpeedSettings(){let e=a.createElement("div",{className:`${this.player.options.classPrefix}-settings-section`}),t=a.createElement("label",{textContent:p.t("settings.speed"),attributes:{for:`${this.player.options.classPrefix}-speed-select`}}),s=a.createElement("select",{className:`${this.player.options.classPrefix}-settings-select`,attributes:{id:`${this.player.options.classPrefix}-speed-select`}});return[.25,.5,.75,1,1.25,1.5,1.75,2].forEach(n=>{let r=a.createElement("option",{textContent:p.t(`speeds.${n}`)||`${n}x`,attributes:{value:String(n)}});n===this.player.state.playbackSpeed&&(r.selected=!0),s.appendChild(r)}),s.addEventListener("change",n=>{this.player.setPlaybackSpeed(parseFloat(n.target.value))}),e.appendChild(t),e.appendChild(s),e}createCaptionSettings(){let e=a.createElement("div",{className:`${this.player.options.classPrefix}-settings-section`}),t=a.createElement("h3",{textContent:p.t("settings.captions")});e.appendChild(t);let s=a.createElement("label",{textContent:p.t("captions.select"),attributes:{for:`${this.player.options.classPrefix}-caption-track-select`}}),i=a.createElement("select",{className:`${this.player.options.classPrefix}-settings-select`,attributes:{id:`${this.player.options.classPrefix}-caption-track-select`}}),n=a.createElement("option",{textContent:p.t("captions.off"),attributes:{value:"-1"}});return i.appendChild(n),this.player.captionManager.getAvailableTracks().forEach(o=>{let c=a.createElement("option",{textContent:o.label,attributes:{value:String(o.index)}});i.appendChild(c)}),i.addEventListener("change",o=>{let c=parseInt(o.target.value);c===-1?this.player.disableCaptions():this.player.captionManager.switchTrack(c)}),e.appendChild(s),e.appendChild(i),e.appendChild(this.createCaptionStyleControl("fontSize",p.t("captions.fontSize"),[{label:"Small",value:"80%"},{label:"Medium",value:"100%"},{label:"Large",value:"120%"},{label:"X-Large",value:"150%"}])),e.appendChild(this.createCaptionStyleControl("fontFamily",p.t("captions.fontFamily"),[{label:"Sans-serif",value:"sans-serif"},{label:"Serif",value:"serif"},{label:"Monospace",value:"monospace"}])),e.appendChild(this.createColorControl("color",p.t("captions.color"))),e.appendChild(this.createColorControl("backgroundColor",p.t("captions.backgroundColor"))),e.appendChild(this.createRangeControl("opacity",p.t("captions.opacity"),0,1,.1)),e}createCaptionStyleControl(e,t,s){let i=a.createElement("div",{className:`${this.player.options.classPrefix}-settings-control`}),n=a.createElement("label",{textContent:t,attributes:{for:`${this.player.options.classPrefix}-caption-${e}`}}),r=a.createElement("select",{className:`${this.player.options.classPrefix}-settings-select`,attributes:{id:`${this.player.options.classPrefix}-caption-${e}`}});return s.forEach(o=>{let c=a.createElement("option",{textContent:o.label,attributes:{value:o.value}});o.value===this.player.options[`captions${e.charAt(0).toUpperCase()+e.slice(1)}`]&&(c.selected=!0),r.appendChild(c)}),r.addEventListener("change",o=>{this.player.captionManager.setCaptionStyle(e,o.target.value)}),i.appendChild(n),i.appendChild(r),i}createColorControl(e,t){let s=a.createElement("div",{className:`${this.player.options.classPrefix}-settings-control`}),i=a.createElement("label",{textContent:t,attributes:{for:`${this.player.options.classPrefix}-caption-${e}`}}),n=a.createElement("input",{className:`${this.player.options.classPrefix}-settings-color`,attributes:{type:"color",id:`${this.player.options.classPrefix}-caption-${e}`,value:this.player.options[`captions${e.charAt(0).toUpperCase()+e.slice(1)}`]}});return n.addEventListener("change",r=>{this.player.captionManager.setCaptionStyle(e,r.target.value)}),s.appendChild(i),s.appendChild(n),s}createRangeControl(e,t,s,i,n){let r=a.createElement("div",{className:`${this.player.options.classPrefix}-settings-control`}),o=a.createElement("label",{textContent:t,attributes:{for:`${this.player.options.classPrefix}-caption-${e}`}}),c=a.createElement("input",{className:`${this.player.options.classPrefix}-settings-range`,attributes:{type:"range",id:`${this.player.options.classPrefix}-caption-${e}`,min:String(s),max:String(i),step:String(n),value:String(this.player.options[`captions${e.charAt(0).toUpperCase()+e.slice(1)}`])}}),d=a.createElement("span",{className:`${this.player.options.classPrefix}-settings-value`,textContent:String(this.player.options[`captions${e.charAt(0).toUpperCase()+e.slice(1)}`])});return c.addEventListener("input",u=>{let g=parseFloat(u.target.value);d.textContent=g.toFixed(1),this.player.captionManager.setCaptionStyle(e,g)}),r.appendChild(o),r.appendChild(c),r.appendChild(d),r}resetSettings(){this.player.setPlaybackSpeed(1),this.player.captionManager&&(this.player.captionManager.setCaptionStyle("fontSize","100%"),this.player.captionManager.setCaptionStyle("fontFamily","sans-serif"),this.player.captionManager.setCaptionStyle("color","#FFFFFF"),this.player.captionManager.setCaptionStyle("backgroundColor","#000000"),this.player.captionManager.setCaptionStyle("opacity",.8)),this.hide(),setTimeout(()=>this.show(),100)}show(){this.overlay.style.display="flex",this.isOpen=!0;let e=this.element.querySelector(`.${this.player.options.classPrefix}-settings-close`);e&&e.focus(),this.player.emit("settingsopen")}hide(){this.overlay.style.display="none",this.isOpen=!1,this.player.container.focus(),this.player.emit("settingsclose")}destroy(){this.overlay&&this.overlay.parentNode&&this.overlay.parentNode.removeChild(this.overlay)}};var x=class{constructor(e){this.player=e,this.transcriptWindow=null,this.transcriptEntries=[],this.currentActiveEntry=null,this.isVisible=!1,this.isDragging=!1,this.dragOffsetX=0,this.dragOffsetY=0,this.handlers={timeupdate:()=>this.updateActiveEntry(),resize:null,mousemove:null,mouseup:null,touchmove:null,touchend:null,mousedown:null,touchstart:null,keydown:null},this.init()}init(){this.player.on("timeupdate",this.handlers.timeupdate),this.player.on("fullscreenchange",()=>{this.isVisible&&setTimeout(()=>this.positionTranscript(),100)})}toggleTranscript(){this.isVisible?this.hideTranscript():this.showTranscript()}showTranscript(){if(this.transcriptWindow){this.transcriptWindow.style.display="flex",this.isVisible=!0;return}this.createTranscriptWindow(),this.loadTranscriptData(),this.transcriptWindow&&(this.transcriptWindow.style.display="flex",setTimeout(()=>this.positionTranscript(),0)),this.isVisible=!0}hideTranscript(){this.transcriptWindow&&(this.transcriptWindow.style.display="none",this.isVisible=!1)}createTranscriptWindow(){this.transcriptWindow=a.createElement("div",{className:`${this.player.options.classPrefix}-transcript-window`,attributes:{role:"dialog","aria-label":"Video Transcript",tabindex:"-1"}}),this.transcriptHeader=a.createElement("div",{className:`${this.player.options.classPrefix}-transcript-header`,attributes:{"aria-label":"Drag to reposition transcript. Use arrow keys to move, Home to reset position, Escape to close.",tabindex:"0"}});let e=a.createElement("h3",{textContent:"Transcript"}),t=a.createElement("button",{className:`${this.player.options.classPrefix}-transcript-close`,attributes:{type:"button","aria-label":"Close transcript"}});t.appendChild(h("close")),t.addEventListener("click",()=>this.hideTranscript()),this.transcriptHeader.appendChild(e),this.transcriptHeader.appendChild(t),this.transcriptContent=a.createElement("div",{className:`${this.player.options.classPrefix}-transcript-content`}),this.transcriptWindow.appendChild(this.transcriptHeader),this.transcriptWindow.appendChild(this.transcriptContent),this.player.container.appendChild(this.transcriptWindow),this.positionTranscript(),this.setupDragAndDrop();let s;this.handlers.resize=()=>{clearTimeout(s),s=setTimeout(()=>this.positionTranscript(),100)},window.addEventListener("resize",this.handlers.resize)}positionTranscript(){if(!this.transcriptWindow||!this.player.videoWrapper||!this.isVisible)return;let e=this.player.videoWrapper.getBoundingClientRect();this.player.state.fullscreen?(this.transcriptWindow.style.position="fixed",this.transcriptWindow.style.left="auto",this.transcriptWindow.style.right="20px",this.transcriptWindow.style.bottom="80px",this.transcriptWindow.style.top="auto",this.transcriptWindow.style.maxHeight="calc(100vh - 180px)",this.transcriptWindow.style.height="auto"):(this.transcriptWindow.style.position="absolute",this.transcriptWindow.style.left=`${e.width+8}px`,this.transcriptWindow.style.right="auto",this.transcriptWindow.style.bottom="auto",this.transcriptWindow.style.top="0",this.transcriptWindow.style.height=`${e.height}px`,this.transcriptWindow.style.maxHeight="none")}loadTranscriptData(){this.transcriptEntries=[],this.transcriptContent.innerHTML="";let t=Array.from(this.player.element.textTracks).find(i=>i.kind==="captions"||i.kind==="subtitles");if(!t){this.showNoTranscriptMessage();return}if(t.mode==="disabled"&&(t.mode="hidden"),!t.cues||t.cues.length===0){let i=a.createElement("div",{className:`${this.player.options.classPrefix}-transcript-loading`,textContent:"Loading transcript..."});this.transcriptContent.appendChild(i);let n=()=>{this.loadTranscriptData()};t.addEventListener("load",n,{once:!0}),setTimeout(()=>{t.cues&&t.cues.length>0&&this.loadTranscriptData()},500);return}Array.from(t.cues).forEach((i,n)=>{let r=this.createTranscriptEntry(i,n);this.transcriptEntries.push({element:r,cue:i,startTime:i.startTime,endTime:i.endTime}),this.transcriptContent.appendChild(r)})}createTranscriptEntry(e,t){let s=a.createElement("div",{className:`${this.player.options.classPrefix}-transcript-entry`,attributes:{"data-start":String(e.startTime),"data-end":String(e.endTime),role:"button",tabindex:"0"}}),i=a.createElement("span",{className:`${this.player.options.classPrefix}-transcript-time`,textContent:m.formatTime(e.startTime)}),n=a.createElement("span",{className:`${this.player.options.classPrefix}-transcript-text`,textContent:this.stripVTTFormatting(e.text)});s.appendChild(i),s.appendChild(n);let r=()=>{this.player.seek(e.startTime),this.player.state.paused&&this.player.play()};return s.addEventListener("click",r),s.addEventListener("keydown",o=>{(o.key==="Enter"||o.key===" ")&&(o.preventDefault(),r())}),s}stripVTTFormatting(e){return e.replace(/<[^>]+>/g,"").replace(/\n/g," ").trim()}showNoTranscriptMessage(){let e=a.createElement("div",{className:`${this.player.options.classPrefix}-transcript-empty`,textContent:"No transcript available for this video."});this.transcriptContent.appendChild(e)}updateActiveEntry(){if(!this.isVisible||this.transcriptEntries.length===0)return;let e=this.player.state.currentTime,t=this.transcriptEntries.find(s=>e>=s.startTime&&e<s.endTime);t&&t!==this.currentActiveEntry?(this.currentActiveEntry&&this.currentActiveEntry.element.classList.remove(`${this.player.options.classPrefix}-transcript-entry-active`),t.element.classList.add(`${this.player.options.classPrefix}-transcript-entry-active`),this.scrollToEntry(t.element),this.currentActiveEntry=t):!t&&this.currentActiveEntry&&(this.currentActiveEntry.element.classList.remove(`${this.player.options.classPrefix}-transcript-entry-active`),this.currentActiveEntry=null)}scrollToEntry(e){if(!this.transcriptContent)return;let t=this.transcriptContent.getBoundingClientRect(),s=e.getBoundingClientRect();if(s.top<t.top||s.bottom>t.bottom){let i=e.offsetTop-this.transcriptContent.clientHeight/2+e.clientHeight/2;this.transcriptContent.scrollTo({top:i,behavior:"smooth"})}}setupDragAndDrop(){!this.transcriptHeader||!this.transcriptWindow||(this.handlers.mousedown=e=>{e.target.closest(`.${this.player.options.classPrefix}-transcript-close`)||(this.startDragging(e.clientX,e.clientY),e.preventDefault())},this.handlers.mousemove=e=>{this.isDragging&&this.drag(e.clientX,e.clientY)},this.handlers.mouseup=()=>{this.isDragging&&this.stopDragging()},this.handlers.touchstart=e=>{if(e.target.closest(`.${this.player.options.classPrefix}-transcript-close`))return;let t=e.touches[0];this.startDragging(t.clientX,t.clientY)},this.handlers.touchmove=e=>{if(this.isDragging){let t=e.touches[0];this.drag(t.clientX,t.clientY),e.preventDefault()}},this.handlers.touchend=()=>{this.isDragging&&this.stopDragging()},this.handlers.keydown=e=>{if(!["ArrowLeft","ArrowRight","ArrowUp","ArrowDown","Home","Escape"].includes(e.key))return;if(e.preventDefault(),e.stopPropagation(),e.key==="Home"){this.resetPosition();return}if(e.key==="Escape"){this.hideTranscript();return}let t=e.shiftKey?50:10,s=parseFloat(this.transcriptWindow.style.left)||0,i=parseFloat(this.transcriptWindow.style.top)||0;if(window.getComputedStyle(this.transcriptWindow).transform!=="none"){let c=this.transcriptWindow.getBoundingClientRect();s=c.left,i=c.top,this.transcriptWindow.style.transform="none",this.transcriptWindow.style.left=`${s}px`,this.transcriptWindow.style.top=`${i}px`}let r=s,o=i;switch(e.key){case"ArrowLeft":r-=t;break;case"ArrowRight":r+=t;break;case"ArrowUp":o-=t;break;case"ArrowDown":o+=t;break}this.transcriptWindow.style.left=`${r}px`,this.transcriptWindow.style.top=`${o}px`},this.transcriptHeader.addEventListener("mousedown",this.handlers.mousedown),document.addEventListener("mousemove",this.handlers.mousemove),document.addEventListener("mouseup",this.handlers.mouseup),this.transcriptHeader.addEventListener("touchstart",this.handlers.touchstart),document.addEventListener("touchmove",this.handlers.touchmove),document.addEventListener("touchend",this.handlers.touchend),this.transcriptHeader.addEventListener("keydown",this.handlers.keydown))}startDragging(e,t){let s=this.transcriptWindow.getBoundingClientRect(),i=this.player.container.getBoundingClientRect(),n=s.left-i.left,r=s.top-i.top;window.getComputedStyle(this.transcriptWindow).transform!=="none"&&(this.transcriptWindow.style.transform="none",this.transcriptWindow.style.left=`${n}px`,this.transcriptWindow.style.top=`${r}px`),this.dragOffsetX=e-s.left,this.dragOffsetY=t-s.top,this.isDragging=!0,this.transcriptWindow.classList.add(`${this.player.options.classPrefix}-transcript-dragging`),document.body.style.cursor="grabbing",document.body.style.userSelect="none"}drag(e,t){if(!this.isDragging)return;let s=e-this.dragOffsetX,i=t-this.dragOffsetY,n=this.player.container.getBoundingClientRect(),r=s-n.left,o=i-n.top;this.transcriptWindow.style.left=`${r}px`,this.transcriptWindow.style.top=`${o}px`}stopDragging(){this.isDragging=!1,this.transcriptWindow.classList.remove(`${this.player.options.classPrefix}-transcript-dragging`),document.body.style.cursor="",document.body.style.userSelect=""}setPosition(e,t){let s=this.transcriptWindow.getBoundingClientRect(),i=document.documentElement.clientWidth,n=document.documentElement.clientHeight,r=100,o=-(s.width-r),c=-(s.height-r),d=i-r,u=n-r;e=Math.max(o,Math.min(e,d)),t=Math.max(c,Math.min(t,u)),this.transcriptWindow.style.left=`${e}px`,this.transcriptWindow.style.top=`${t}px`,this.transcriptWindow.style.transform="none"}resetPosition(){this.transcriptWindow.style.left="50%",this.transcriptWindow.style.top="50%",this.transcriptWindow.style.transform="translate(-50%, -50%)"}destroy(){this.handlers.timeupdate&&this.player.off("timeupdate",this.handlers.timeupdate),this.transcriptHeader&&(this.handlers.mousedown&&this.transcriptHeader.removeEventListener("mousedown",this.handlers.mousedown),this.handlers.touchstart&&this.transcriptHeader.removeEventListener("touchstart",this.handlers.touchstart),this.handlers.keydown&&this.transcriptHeader.removeEventListener("keydown",this.handlers.keydown)),this.handlers.mousemove&&document.removeEventListener("mousemove",this.handlers.mousemove),this.handlers.mouseup&&document.removeEventListener("mouseup",this.handlers.mouseup),this.handlers.touchmove&&document.removeEventListener("touchmove",this.handlers.touchmove),this.handlers.touchend&&document.removeEventListener("touchend",this.handlers.touchend),this.handlers.resize&&window.removeEventListener("resize",this.handlers.resize),this.handlers=null,this.transcriptWindow&&this.transcriptWindow.parentNode&&this.transcriptWindow.parentNode.removeChild(this.transcriptWindow),this.transcriptWindow=null,this.transcriptHeader=null,this.transcriptContent=null,this.transcriptEntries=[]}};$();var k=class{constructor(e){this.player=e,this.youtube=null,this.videoId=null,this.isReady=!1,this.iframe=null}async init(){if(this.videoId=this.extractVideoId(this.player.element.src),!this.videoId)throw new Error("Invalid YouTube URL");await this.loadYouTubeAPI(),this.createIframe(),await this.initializePlayer()}extractVideoId(e){let t=[/(?:youtube\.com\/watch\?v=|youtu\.be\/)([^&\s]+)/,/youtube\.com\/embed\/([^&\s]+)/];for(let s of t){let i=e.match(s);if(i&&i[1])return i[1]}return null}async loadYouTubeAPI(){return window.YT&&window.YT.Player?Promise.resolve():new Promise((e,t)=>{if(window.onYouTubeIframeAPIReady){let n=window.onYouTubeIframeAPIReady;window.onYouTubeIframeAPIReady=()=>{n(),e()};return}let s=document.createElement("script");s.src="https://www.youtube.com/iframe_api",window.onYouTubeIframeAPIReady=()=>{e()},s.onerror=()=>t(new Error("Failed to load YouTube API"));let i=document.getElementsByTagName("script")[0];i.parentNode.insertBefore(s,i)})}createIframe(){this.player.element.style.display="none",this.iframe=document.createElement("div"),this.iframe.id=`youtube-player-${Math.random().toString(36).substr(2,9)}`,this.iframe.style.width="100%",this.iframe.style.height="100%",this.player.element.parentNode.insertBefore(this.iframe,this.player.element)}async initializePlayer(){return new Promise(e=>{this.youtube=new window.YT.Player(this.iframe.id,{videoId:this.videoId,width:"100%",height:"100%",playerVars:{controls:0,disablekb:1,fs:0,modestbranding:1,rel:0,showinfo:0,iv_load_policy:3,autoplay:this.player.options.autoplay?1:0,mute:this.player.options.muted?1:0,start:this.player.options.startTime||0},events:{onReady:t=>{this.isReady=!0,this.attachEvents(),e()},onStateChange:t=>this.handleStateChange(t),onError:t=>this.handleError(t)}})})}attachEvents(){this.timeUpdateInterval=setInterval(()=>{if(this.isReady&&this.youtube){let e=this.youtube.getCurrentTime(),t=this.youtube.getDuration();this.player.state.currentTime=e,this.player.state.duration=t,this.player.emit("timeupdate",e)}},250),this.youtube.getDuration&&(this.player.state.duration=this.youtube.getDuration(),this.player.emit("loadedmetadata"))}handleStateChange(e){let t=window.YT.PlayerState;switch(e.data){case t.PLAYING:this.player.state.playing=!0,this.player.state.paused=!1,this.player.state.ended=!1,this.player.state.buffering=!1,this.player.emit("play"),this.player.emit("playing"),this.player.options.onPlay&&this.player.options.onPlay.call(this.player);break;case t.PAUSED:this.player.state.playing=!1,this.player.state.paused=!0,this.player.emit("pause"),this.player.options.onPause&&this.player.options.onPause.call(this.player);break;case t.ENDED:this.player.state.playing=!1,this.player.state.paused=!0,this.player.state.ended=!0,this.player.emit("ended"),this.player.options.onEnded&&this.player.options.onEnded.call(this.player),this.player.options.loop&&(this.youtube.seekTo(0),this.youtube.playVideo());break;case t.BUFFERING:this.player.state.buffering=!0,this.player.emit("waiting");break;case t.CUED:this.player.emit("loadedmetadata");break}}handleError(e){let t={2:"Invalid video ID",5:"HTML5 player error",100:"Video not found",101:"Video not allowed to be played in embedded players",150:"Video not allowed to be played in embedded players"},s=new Error(t[e.data]||"YouTube player error");this.player.handleError(s)}play(){this.isReady&&this.youtube&&this.youtube.playVideo()}pause(){this.isReady&&this.youtube&&this.youtube.pauseVideo()}seek(e){this.isReady&&this.youtube&&this.youtube.seekTo(e,!0)}setVolume(e){this.isReady&&this.youtube&&(this.youtube.setVolume(e*100),this.player.state.volume=e)}setMuted(e){this.isReady&&this.youtube&&(e?this.youtube.mute():this.youtube.unMute(),this.player.state.muted=e)}setPlaybackSpeed(e){this.isReady&&this.youtube&&(this.youtube.setPlaybackRate(e),this.player.state.playbackSpeed=e)}destroy(){this.timeUpdateInterval&&clearInterval(this.timeUpdateInterval),this.youtube&&this.youtube.destroy&&this.youtube.destroy(),this.iframe&&this.iframe.parentNode&&this.iframe.parentNode.removeChild(this.iframe),this.player.element&&(this.player.element.style.display="")}};var L=class{constructor(e){this.player=e,this.vimeo=null,this.videoId=null,this.isReady=!1,this.iframe=null}async init(){if(this.videoId=this.extractVideoId(this.player.element.src),!this.videoId)throw new Error("Invalid Vimeo URL");await this.loadVimeoAPI(),this.createIframe(),await this.initializePlayer()}extractVideoId(e){let t=[/vimeo\.com\/(\d+)/,/vimeo\.com\/video\/(\d+)/,/player\.vimeo\.com\/video\/(\d+)/];for(let s of t){let i=e.match(s);if(i&&i[1])return i[1]}return null}async loadVimeoAPI(){return window.Vimeo&&window.Vimeo.Player?Promise.resolve():new Promise((e,t)=>{let s=document.createElement("script");s.src="https://player.vimeo.com/api/player.js",s.onload=()=>e(),s.onerror=()=>t(new Error("Failed to load Vimeo API")),document.head.appendChild(s)})}createIframe(){this.player.element.style.display="none",this.iframe=document.createElement("div"),this.iframe.id=`vimeo-player-${Math.random().toString(36).substr(2,9)}`,this.iframe.style.width="100%",this.iframe.style.height="100%",this.player.element.parentNode.insertBefore(this.iframe,this.player.element)}async initializePlayer(){let e={id:this.videoId,width:"100%",height:"100%",controls:!1,autoplay:this.player.options.autoplay,muted:this.player.options.muted,loop:this.player.options.loop,keyboard:!1};this.player.options.startTime>0&&(e.startTime=this.player.options.startTime),this.vimeo=new window.Vimeo.Player(this.iframe.id,e),await this.vimeo.ready(),this.isReady=!0,this.attachEvents();try{let t=await this.vimeo.getDuration();this.player.state.duration=t,this.player.emit("loadedmetadata")}catch(t){this.player.log("Error getting duration:",t,"warn")}}attachEvents(){this.vimeo.on("play",()=>{this.player.state.playing=!0,this.player.state.paused=!1,this.player.state.ended=!1,this.player.emit("play"),this.player.options.onPlay&&this.player.options.onPlay.call(this.player)}),this.vimeo.on("pause",()=>{this.player.state.playing=!1,this.player.state.paused=!0,this.player.emit("pause"),this.player.options.onPause&&this.player.options.onPause.call(this.player)}),this.vimeo.on("ended",()=>{this.player.state.playing=!1,this.player.state.paused=!0,this.player.state.ended=!0,this.player.emit("ended"),this.player.options.onEnded&&this.player.options.onEnded.call(this.player)}),this.vimeo.on("timeupdate",e=>{this.player.state.currentTime=e.seconds,this.player.state.duration=e.duration,this.player.emit("timeupdate",e.seconds),this.player.options.onTimeUpdate&&this.player.options.onTimeUpdate.call(this.player,e.seconds)}),this.vimeo.on("volumechange",e=>{this.player.state.volume=e.volume,this.player.emit("volumechange",e.volume)}),this.vimeo.on("bufferstart",()=>{this.player.state.buffering=!0,this.player.emit("waiting")}),this.vimeo.on("bufferend",()=>{this.player.state.buffering=!1,this.player.emit("canplay")}),this.vimeo.on("seeking",()=>{this.player.state.seeking=!0,this.player.emit("seeking")}),this.vimeo.on("seeked",()=>{this.player.state.seeking=!1,this.player.emit("seeked")}),this.vimeo.on("playbackratechange",e=>{this.player.state.playbackSpeed=e.playbackRate,this.player.emit("ratechange",e.playbackRate)}),this.vimeo.on("error",e=>{this.player.handleError(new Error(`Vimeo error: ${e.message}`))})}play(){this.isReady&&this.vimeo&&this.vimeo.play().catch(e=>{this.player.log("Play error:",e,"warn")})}pause(){this.isReady&&this.vimeo&&this.vimeo.pause().catch(e=>{this.player.log("Pause error:",e,"warn")})}seek(e){this.isReady&&this.vimeo&&this.vimeo.setCurrentTime(e).catch(t=>{this.player.log("Seek error:",t,"warn")})}setVolume(e){this.isReady&&this.vimeo&&(this.vimeo.setVolume(e).catch(t=>{this.player.log("Volume error:",t,"warn")}),this.player.state.volume=e)}setMuted(e){this.isReady&&this.vimeo&&(e?this.vimeo.setVolume(0):this.vimeo.setVolume(this.player.state.volume),this.player.state.muted=e)}setPlaybackSpeed(e){this.isReady&&this.vimeo&&(this.vimeo.setPlaybackRate(e).catch(t=>{this.player.log("Playback rate error:",t,"warn")}),this.player.state.playbackSpeed=e)}destroy(){this.vimeo&&this.vimeo.destroy&&this.vimeo.destroy(),this.iframe&&this.iframe.parentNode&&this.iframe.parentNode.removeChild(this.iframe),this.player.element&&(this.player.element.style.display="")}};var P=class{constructor(e){this.player=e,this.media=e.element,this.hls=null}async init(){this.canPlayNatively()?(this.player.log("Using native HLS support"),await this.initNative()):(this.player.log("Using hls.js for HLS support"),await this.initHlsJs())}canPlayNatively(){return document.createElement("video").canPlayType("application/vnd.apple.mpegurl")!==""}async initNative(){let e=(await Promise.resolve().then(()=>($(),N))).HTML5Renderer,t=new e(this.player);await t.init(),Object.getOwnPropertyNames(Object.getPrototypeOf(t)).forEach(s=>{s!=="constructor"&&typeof t[s]=="function"&&(this[s]=t[s].bind(t))})}async initHlsJs(){var t;if(window.Hls||await this.loadHlsJs(),!window.Hls.isSupported())throw new Error("HLS is not supported in this browser");this.hls=new window.Hls({debug:this.player.options.debug,enableWorker:!0,lowLatencyMode:!1,backBufferLength:90}),this.hls.attachMedia(this.media);let e=this.player.element.src||((t=this.player.element.querySelector("source"))==null?void 0:t.src);this.hls.loadSource(e),this.attachHlsEvents(),this.attachMediaEvents()}async loadHlsJs(){return new Promise((e,t)=>{let s=document.createElement("script");s.src="https://cdn.jsdelivr.net/npm/hls.js@latest",s.onload=()=>e(),s.onerror=()=>t(new Error("Failed to load hls.js")),document.head.appendChild(s)})}attachHlsEvents(){this.hls.on(window.Hls.Events.MANIFEST_PARSED,(e,t)=>{this.player.log("HLS manifest loaded, found "+t.levels.length+" quality levels"),this.player.emit("hlsmanifestparsed",t)}),this.hls.on(window.Hls.Events.LEVEL_SWITCHED,(e,t)=>{this.player.log("HLS level switched to "+t.level),this.player.emit("hlslevelswitched",t)}),this.hls.on(window.Hls.Events.ERROR,(e,t)=>{this.handleHlsError(t)}),this.hls.on(window.Hls.Events.FRAG_BUFFERED,()=>{this.player.state.buffering=!1})}attachMediaEvents(){this.media.addEventListener("loadedmetadata",()=>{this.player.state.duration=this.media.duration,this.player.emit("loadedmetadata")}),this.media.addEventListener("play",()=>{this.player.state.playing=!0,this.player.state.paused=!1,this.player.state.ended=!1,this.player.emit("play"),this.player.options.onPlay&&this.player.options.onPlay.call(this.player)}),this.media.addEventListener("pause",()=>{this.player.state.playing=!1,this.player.state.paused=!0,this.player.emit("pause"),this.player.options.onPause&&this.player.options.onPause.call(this.player)}),this.media.addEventListener("ended",()=>{this.player.state.playing=!1,this.player.state.paused=!0,this.player.state.ended=!0,this.player.emit("ended"),this.player.options.onEnded&&this.player.options.onEnded.call(this.player),this.player.options.loop&&(this.player.seek(0),this.player.play())}),this.media.addEventListener("timeupdate",()=>{this.player.state.currentTime=this.media.currentTime,this.player.emit("timeupdate",this.media.currentTime),this.player.options.onTimeUpdate&&this.player.options.onTimeUpdate.call(this.player,this.media.currentTime)}),this.media.addEventListener("volumechange",()=>{this.player.state.volume=this.media.volume,this.player.state.muted=this.media.muted,this.player.emit("volumechange",this.media.volume)}),this.media.addEventListener("waiting",()=>{this.player.state.buffering=!0,this.player.emit("waiting")}),this.media.addEventListener("canplay",()=>{this.player.state.buffering=!1,this.player.emit("canplay")}),this.media.addEventListener("error",()=>{this.player.handleError(this.media.error)})}handleHlsError(e){if(e.fatal)switch(e.type){case window.Hls.ErrorTypes.NETWORK_ERROR:this.player.log("Fatal network error, trying to recover...","error"),this.hls.startLoad();break;case window.Hls.ErrorTypes.MEDIA_ERROR:this.player.log("Fatal media error, trying to recover...","error"),this.hls.recoverMediaError();break;default:this.player.log("Fatal error, cannot recover","error"),this.player.handleError(new Error(`HLS Error: ${e.type} - ${e.details}`)),this.hls.destroy();break}else this.player.log("Non-fatal HLS error: "+e.details,"warn")}play(){let e=this.media.play();e!==void 0&&e.catch(t=>{this.player.log("Play failed:",t,"warn")})}pause(){this.media.pause()}seek(e){this.media.currentTime=e}setVolume(e){this.media.volume=e}setMuted(e){this.media.muted=e}setPlaybackSpeed(e){this.media.playbackRate=e}switchQuality(e){this.hls&&(this.hls.currentLevel=e)}getQualities(){return this.hls&&this.hls.levels?this.hls.levels.map((e,t)=>({index:t,height:e.height,width:e.width,bitrate:e.bitrate,name:`${e.height}p`})):[]}destroy(){this.hls&&(this.hls.destroy(),this.hls=null)}};var y=class extends b{constructor(e,t={}){if(super(),this.element=typeof e=="string"?document.querySelector(e):e,!this.element)throw new Error("VidPly: Element not found");if(this.element.tagName!=="VIDEO"&&this.element.tagName!=="AUDIO"){let s=t.mediaType||"video",i=document.createElement(s);Array.from(this.element.attributes).forEach(r=>{r.name!=="id"&&r.name!=="class"&&!r.name.startsWith("data-")&&i.setAttribute(r.name,r.value)}),this.element.querySelectorAll("track").forEach(r=>{i.appendChild(r.cloneNode(!0))}),this.element.innerHTML="",this.element.appendChild(i),this.element=i}this.options={width:null,height:null,poster:null,responsive:!0,fillContainer:!1,autoplay:!1,loop:!1,muted:!1,volume:.8,playbackSpeed:1,preload:"metadata",startTime:0,controls:!0,hideControlsDelay:3e3,playPauseButton:!0,progressBar:!0,currentTime:!0,duration:!0,volumeControl:!0,muteButton:!0,chaptersButton:!0,qualityButton:!0,captionStyleButton:!0,speedButton:!0,captionsButton:!0,transcriptButton:!0,fullscreenButton:!0,pipButton:!0,seekInterval:10,seekIntervalLarge:30,captions:!0,captionsDefault:!1,captionsFontSize:"100%",captionsFontFamily:"sans-serif",captionsColor:"#FFFFFF",captionsBackgroundColor:"#000000",captionsOpacity:.8,audioDescription:!0,audioDescriptionSrc:null,audioDescriptionButton:!0,signLanguage:!0,signLanguageSrc:null,signLanguageButton:!0,signLanguagePosition:"bottom-right",transcript:!1,transcriptPosition:"external",transcriptContainer:null,keyboard:!0,keyboardShortcuts:{"play-pause":[" ","p","k"],"volume-up":["ArrowUp"],"volume-down":["ArrowDown"],"seek-forward":["ArrowRight","f"],"seek-backward":["ArrowLeft","r"],"seek-forward-large":["l"],"seek-backward-large":["j"],mute:["m"],fullscreen:["f"],captions:["c"],"speed-up":[">"],"speed-down":["<"],settings:["s"]},ariaLabels:{},screenReaderAnnouncements:!0,highContrast:!1,focusHighlight:!0,language:"en",languages:["en"],debug:!1,classPrefix:"vidply",iconType:"svg",pauseOthersOnPlay:!0,onReady:null,onPlay:null,onPause:null,onEnded:null,onTimeUpdate:null,onVolumeChange:null,onError:null,...t},this.state={ready:!1,playing:!1,paused:!0,ended:!1,buffering:!1,seeking:!1,muted:this.options.muted,volume:this.options.volume,currentTime:0,duration:0,playbackSpeed:this.options.playbackSpeed,fullscreen:!1,pip:!1,captionsEnabled:this.options.captionsDefault,currentCaption:null,controlsVisible:!0,audioDescriptionEnabled:!1,signLanguageEnabled:!1},this.originalSrc=null,this.audioDescriptionSrc=this.options.audioDescriptionSrc,this.signLanguageSrc=this.options.signLanguageSrc,this.signLanguageVideo=null,this.container=null,this.renderer=null,this.controlBar=null,this.captionManager=null,this.keyboardManager=null,this.settingsDialog=null,this.init()}async init(){var e;try{this.log("Initializing VidPly player"),p.setLanguage(this.options.language),this.createContainer(),this.element.src||((e=this.element.querySelector("source"))==null?void 0:e.src)?await this.initializeRenderer():this.log("No initial source - waiting for playlist or manual load"),this.options.controls&&(this.controlBar=new C(this),this.videoWrapper.appendChild(this.controlBar.element)),this.options.captions&&(this.captionManager=new f(this)),(this.options.transcript||this.options.transcriptButton)&&(this.transcriptManager=new x(this)),this.options.keyboard&&(this.keyboardManager=new E(this)),this.options.settingsButton&&(this.settingsDialog=new w(this)),this.options.startTime>0&&this.seek(this.options.startTime),this.options.muted&&this.mute(),this.options.volume!==.8&&this.setVolume(this.options.volume),this.state.ready=!0,this.emit("ready"),this.options.onReady&&this.options.onReady.call(this),this.options.autoplay&&this.play(),this.log("Player initialized successfully")}catch(t){this.handleError(t)}}createContainer(){this.container=a.createElement("div",{className:`${this.options.classPrefix}-player`,attributes:{role:"region","aria-label":p.t("player.label"),tabindex:"-1"}});let e=this.element.tagName.toLowerCase();this.container.classList.add(`${this.options.classPrefix}-${e}`),this.options.responsive&&this.container.classList.add(`${this.options.classPrefix}-responsive`),this.videoWrapper=a.createElement("div",{className:`${this.options.classPrefix}-video-wrapper`}),this.element.parentNode.insertBefore(this.container,this.element),this.container.appendChild(this.videoWrapper),this.videoWrapper.appendChild(this.element),this.element.style.width="100%",this.element.style.height="100%",this.options.width&&(this.container.style.width=typeof this.options.width=="number"?`${this.options.width}px`:this.options.width),this.options.height&&(this.container.style.height=typeof this.options.height=="number"?`${this.options.height}px`:this.options.height),this.options.poster&&this.element.tagName==="VIDEO"&&(this.element.poster=this.options.poster)}async initializeRenderer(){var s;let e=this.element.src||((s=this.element.querySelector("source"))==null?void 0:s.src);if(!e)throw new Error("No media source found");this.originalSrc||(this.originalSrc=e);let t;e.includes("youtube.com")||e.includes("youtu.be")?t=k:e.includes("vimeo.com")?t=L:e.includes(".m3u8")?t=P:t=v,this.log(`Using ${t.name} renderer`),this.renderer=new t(this),await this.renderer.init()}async load(e){try{this.log("Loading new media:",e.src),this.renderer&&this.pause(),this.element.querySelectorAll("track").forEach(i=>i.remove()),this.element.src=e.src,e.type&&(this.element.type=e.type),e.poster&&this.element.tagName==="VIDEO"&&(this.element.poster=e.poster),e.tracks&&e.tracks.length>0&&e.tracks.forEach(i=>{let n=document.createElement("track");n.src=i.src,n.kind=i.kind||"captions",n.srclang=i.srclang||"en",n.label=i.label||i.srclang,i.default&&(n.default=!0),this.element.appendChild(n)});let s=this.shouldChangeRenderer(e.src);s&&this.renderer&&(this.renderer.destroy(),this.renderer=null),!this.renderer||s?await this.initializeRenderer():(this.renderer.media=this.element,this.element.load()),this.captionManager&&(this.captionManager.destroy(),this.captionManager=new f(this)),this.emit("sourcechange",e),this.log("Media loaded successfully")}catch(t){this.handleError(t)}}shouldChangeRenderer(e){if(!this.renderer)return!0;let t=e.includes("youtube.com")||e.includes("youtu.be"),s=e.includes("vimeo.com"),i=e.includes(".m3u8"),n=this.renderer.constructor.name;return!!(t&&n!=="YouTubeRenderer"||s&&n!=="VimeoRenderer"||i&&n!=="HLSRenderer"||!t&&!s&&!i&&n!=="HTML5Renderer")}play(){this.renderer&&this.renderer.play()}pause(){this.renderer&&this.renderer.pause()}stop(){this.pause(),this.seek(0)}toggle(){this.state.playing?this.pause():this.play()}seek(e){this.renderer&&this.renderer.seek(e)}seekForward(e=this.options.seekInterval){this.seek(Math.min(this.state.currentTime+e,this.state.duration))}seekBackward(e=this.options.seekInterval){this.seek(Math.max(this.state.currentTime-e,0))}setVolume(e){let t=Math.max(0,Math.min(1,e));this.renderer&&this.renderer.setVolume(t),this.state.volume=t,t>0&&this.state.muted&&(this.state.muted=!1)}getVolume(){return this.state.volume}mute(){this.renderer&&this.renderer.setMuted(!0),this.state.muted=!0}unmute(){this.renderer&&this.renderer.setMuted(!1),this.state.muted=!1}toggleMute(){this.state.muted?this.unmute():this.mute()}setPlaybackSpeed(e){let t=Math.max(.25,Math.min(2,e));this.renderer&&this.renderer.setPlaybackSpeed(t),this.state.playbackSpeed=t,this.emit("playbackspeedchange",t)}getPlaybackSpeed(){return this.state.playbackSpeed}enterFullscreen(){let e=this.container;e.requestFullscreen?e.requestFullscreen():e.webkitRequestFullscreen?e.webkitRequestFullscreen():e.mozRequestFullScreen?e.mozRequestFullScreen():e.msRequestFullscreen&&e.msRequestFullscreen(),this.state.fullscreen=!0,this.container.classList.add(`${this.options.classPrefix}-fullscreen`),this.emit("fullscreenchange",!0)}exitFullscreen(){document.exitFullscreen?document.exitFullscreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.msExitFullscreen&&document.msExitFullscreen(),this.state.fullscreen=!1,this.container.classList.remove(`${this.options.classPrefix}-fullscreen`),this.emit("fullscreenchange",!1)}toggleFullscreen(){this.state.fullscreen?this.exitFullscreen():this.enterFullscreen()}enterPiP(){this.element.requestPictureInPicture&&(this.element.requestPictureInPicture(),this.state.pip=!0,this.emit("pipchange",!0))}exitPiP(){document.pictureInPictureElement&&(document.exitPictureInPicture(),this.state.pip=!1,this.emit("pipchange",!1))}togglePiP(){this.state.pip?this.exitPiP():this.enterPiP()}enableCaptions(){this.captionManager&&(this.captionManager.enable(),this.state.captionsEnabled=!0)}disableCaptions(){this.captionManager&&(this.captionManager.disable(),this.state.captionsEnabled=!1)}toggleCaptions(){this.state.captionsEnabled?this.disableCaptions():this.enableCaptions()}async enableAudioDescription(){if(!this.audioDescriptionSrc){console.warn("VidPly: No audio description source provided");return}let e=this.state.currentTime,t=this.state.playing;this.element.src=this.audioDescriptionSrc,await new Promise(s=>{let i=()=>{this.element.removeEventListener("loadedmetadata",i),s()};this.element.addEventListener("loadedmetadata",i)}),this.seek(e),t&&this.play(),this.state.audioDescriptionEnabled=!0,this.emit("audiodescriptionenabled")}async disableAudioDescription(){if(!this.originalSrc)return;let e=this.state.currentTime,t=this.state.playing;this.element.src=this.originalSrc,await new Promise(s=>{let i=()=>{this.element.removeEventListener("loadedmetadata",i),s()};this.element.addEventListener("loadedmetadata",i)}),this.seek(e),t&&this.play(),this.state.audioDescriptionEnabled=!1,this.emit("audiodescriptiondisabled")}async toggleAudioDescription(){this.state.audioDescriptionEnabled?await this.disableAudioDescription():await this.enableAudioDescription()}enableSignLanguage(){if(!this.signLanguageSrc){console.warn("No sign language video source provided");return}if(this.signLanguageVideo){this.signLanguageVideo.style.display="block",this.state.signLanguageEnabled=!0,this.emit("signlanguageenabled");return}this.signLanguageVideo=document.createElement("video"),this.signLanguageVideo.className="vidply-sign-language-video",this.signLanguageVideo.src=this.signLanguageSrc,this.signLanguageVideo.setAttribute("aria-label",this.i18n.t("signLanguageVideo"));let e=this.options.signLanguagePosition||"bottom-right";this.signLanguageVideo.classList.add(`vidply-sign-position-${e}`),this.signLanguageVideo.muted=!0,this.signLanguageVideo.currentTime=this.state.currentTime,this.state.paused||this.signLanguageVideo.play(),this.container.appendChild(this.signLanguageVideo),this.signLanguageHandlers={play:()=>{this.signLanguageVideo&&this.signLanguageVideo.play()},pause:()=>{this.signLanguageVideo&&this.signLanguageVideo.pause()},timeupdate:()=>{this.signLanguageVideo&&Math.abs(this.signLanguageVideo.currentTime-this.state.currentTime)>.5&&(this.signLanguageVideo.currentTime=this.state.currentTime)},ratechange:()=>{this.signLanguageVideo&&(this.signLanguageVideo.playbackRate=this.state.playbackSpeed)}},this.on("play",this.signLanguageHandlers.play),this.on("pause",this.signLanguageHandlers.pause),this.on("timeupdate",this.signLanguageHandlers.timeupdate),this.on("ratechange",this.signLanguageHandlers.ratechange),this.state.signLanguageEnabled=!0,this.emit("signlanguageenabled")}disableSignLanguage(){this.signLanguageVideo&&(this.signLanguageVideo.style.display="none"),this.state.signLanguageEnabled=!1,this.emit("signlanguagedisabled")}toggleSignLanguage(){this.state.signLanguageEnabled?this.disableSignLanguage():this.enableSignLanguage()}cleanupSignLanguage(){this.signLanguageHandlers&&(this.off("play",this.signLanguageHandlers.play),this.off("pause",this.signLanguageHandlers.pause),this.off("timeupdate",this.signLanguageHandlers.timeupdate),this.off("ratechange",this.signLanguageHandlers.ratechange),this.signLanguageHandlers=null),this.signLanguageVideo&&this.signLanguageVideo.parentNode&&(this.signLanguageVideo.pause(),this.signLanguageVideo.src="",this.signLanguageVideo.parentNode.removeChild(this.signLanguageVideo),this.signLanguageVideo=null)}showSettings(){this.settingsDialog&&this.settingsDialog.show()}hideSettings(){this.settingsDialog&&this.settingsDialog.hide()}getCurrentTime(){return this.state.currentTime}getDuration(){return this.state.duration}isPlaying(){return this.state.playing}isPaused(){return this.state.paused}isEnded(){return this.state.ended}isMuted(){return this.state.muted}isFullscreen(){return this.state.fullscreen}handleError(e){this.log("Error:",e,"error"),this.emit("error",e),this.options.onError&&this.options.onError.call(this,e)}log(e,t="log"){this.options.debug&&console[t]("[VidPly]",e)}destroy(){this.log("Destroying player"),this.renderer&&this.renderer.destroy(),this.controlBar&&this.controlBar.destroy(),this.captionManager&&this.captionManager.destroy(),this.keyboardManager&&this.keyboardManager.destroy(),this.settingsDialog&&this.settingsDialog.destroy(),this.transcriptManager&&this.transcriptManager.destroy(),this.cleanupSignLanguage(),this.container&&this.container.parentNode&&(this.container.parentNode.insertBefore(this.element,this.container),this.container.parentNode.removeChild(this.container)),this.removeAllListeners()}};y.instances=[];var T=class{constructor(e,t={}){this.player=e,this.tracks=[],this.currentIndex=-1,this.options={autoAdvance:t.autoAdvance!==!1,loop:t.loop||!1,showPanel:t.showPanel!==!1,...t},this.container=null,this.playlistPanel=null,this.trackInfoElement=null,this.handleTrackEnd=this.handleTrackEnd.bind(this),this.handleTrackError=this.handleTrackError.bind(this),this.init()}init(){this.player.on("ended",this.handleTrackEnd),this.player.on("error",this.handleTrackError),this.options.showPanel&&this.createUI()}loadPlaylist(e){this.tracks=e,this.currentIndex=-1,this.container&&this.container.classList.add("vidply-has-playlist"),this.playlistPanel&&this.renderPlaylist(),e.length>0&&this.play(0)}play(e){if(e<0||e>=this.tracks.length){console.warn("VidPly Playlist: Invalid track index",e);return}let t=this.tracks[e];this.currentIndex=e,this.player.load({src:t.src,type:t.type,poster:t.poster,tracks:t.tracks||[]}),this.updateTrackInfo(t),this.updatePlaylistUI(),this.player.emit("playlisttrackchange",{index:e,item:t,total:this.tracks.length}),setTimeout(()=>{this.player.play()},100)}next(){let e=this.currentIndex+1;if(e>=this.tracks.length)if(this.options.loop)e=0;else return;this.play(e)}previous(){let e=this.currentIndex-1;if(e<0)if(this.options.loop)e=this.tracks.length-1;else return;this.play(e)}handleTrackEnd(){this.options.autoAdvance&&this.next()}handleTrackError(e){console.error("VidPly Playlist: Track error",e),this.options.autoAdvance&&setTimeout(()=>{this.next()},1e3)}createUI(){if(this.container=this.player.container,!this.container){console.warn("VidPly Playlist: No container found");return}this.trackInfoElement=a.createElement("div",{className:"vidply-track-info"}),this.trackInfoElement.style.display="none",this.container.appendChild(this.trackInfoElement),this.playlistPanel=a.createElement("div",{className:"vidply-playlist-panel"}),this.playlistPanel.style.display="none",this.container.appendChild(this.playlistPanel)}updateTrackInfo(e){if(!this.trackInfoElement)return;let t=this.currentIndex+1,s=this.tracks.length;this.trackInfoElement.innerHTML=`
      <div class="vidply-track-number">Track ${t} of ${s}</div>
      <div class="vidply-track-title">${a.escapeHTML(e.title||"Untitled")}</div>
      ${e.artist?`<div class="vidply-track-artist">${a.escapeHTML(e.artist)}</div>`:""}
    `,this.trackInfoElement.style.display="block"}renderPlaylist(){if(!this.playlistPanel)return;this.playlistPanel.innerHTML="";let e=a.createElement("div",{className:"vidply-playlist-header"});e.textContent=`Playlist (${this.tracks.length})`,this.playlistPanel.appendChild(e);let t=a.createElement("div",{className:"vidply-playlist-list"});this.tracks.forEach((s,i)=>{let n=this.createPlaylistItem(s,i);t.appendChild(n)}),this.playlistPanel.appendChild(t),this.playlistPanel.style.display="block"}createPlaylistItem(e,t){let s=a.createElement("div",{className:"vidply-playlist-item",role:"button",tabIndex:0,"aria-label":`Play ${e.title||"Track "+(t+1)}`});t===this.currentIndex&&s.classList.add("vidply-playlist-item-active");let i=a.createElement("div",{className:"vidply-playlist-thumbnail"});if(e.poster)i.style.backgroundImage=`url(${e.poster})`;else{let c=h("music");c.classList.add("vidply-playlist-thumbnail-icon"),i.appendChild(c)}s.appendChild(i);let n=a.createElement("div",{className:"vidply-playlist-item-info"}),r=a.createElement("div",{className:"vidply-playlist-item-title"});if(r.textContent=e.title||`Track ${t+1}`,n.appendChild(r),e.artist){let c=a.createElement("div",{className:"vidply-playlist-item-artist"});c.textContent=e.artist,n.appendChild(c)}s.appendChild(n);let o=h("play");return o.classList.add("vidply-playlist-item-icon"),s.appendChild(o),s.addEventListener("click",()=>{this.play(t)}),s.addEventListener("keydown",c=>{(c.key==="Enter"||c.key===" ")&&(c.preventDefault(),this.play(t))}),s}updatePlaylistUI(){if(!this.playlistPanel)return;this.playlistPanel.querySelectorAll(".vidply-playlist-item").forEach((t,s)=>{s===this.currentIndex?(t.classList.add("vidply-playlist-item-active"),t.scrollIntoView({behavior:"smooth",block:"nearest"})):t.classList.remove("vidply-playlist-item-active")})}getCurrentTrack(){return this.tracks[this.currentIndex]||null}getPlaylistInfo(){return{currentIndex:this.currentIndex,totalTracks:this.tracks.length,currentTrack:this.getCurrentTrack(),hasNext:this.currentIndex<this.tracks.length-1,hasPrevious:this.currentIndex>0}}addTrack(e){this.tracks.push(e),this.playlistPanel&&this.renderPlaylist()}removeTrack(e){e<0||e>=this.tracks.length||(this.tracks.splice(e,1),e<this.currentIndex?this.currentIndex--:e===this.currentIndex&&(this.currentIndex>=this.tracks.length&&(this.currentIndex=this.tracks.length-1),this.currentIndex>=0&&this.play(this.currentIndex)),this.playlistPanel&&this.renderPlaylist())}clear(){this.tracks=[],this.currentIndex=-1,this.playlistPanel&&(this.playlistPanel.innerHTML="",this.playlistPanel.style.display="none"),this.trackInfoElement&&(this.trackInfoElement.innerHTML="",this.trackInfoElement.style.display="none")}destroy(){this.player.off("ended",this.handleTrackEnd),this.player.off("error",this.handleTrackError),this.trackInfoElement&&this.trackInfoElement.remove(),this.playlistPanel&&this.playlistPanel.remove(),this.clear()}};function D(){document.querySelectorAll("[data-vidply]").forEach(e=>{let t=e.dataset.vidplyOptions?JSON.parse(e.dataset.vidplyOptions):{};new y(e,t)})}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",D):D();var U=y;return W(q);})();
