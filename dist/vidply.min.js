/*!
 * VidPly v1.0.0
 * Universal, Accessible Video Player
 * (c) 2025 Matthias Peltzer
 * Released under GPL-2.0-or-later License
 */
var VidPly=(()=>{var M=Object.defineProperty;var I=Object.getOwnPropertyDescriptor;var R=Object.getOwnPropertyNames;var F=Object.prototype.hasOwnProperty;var W=(o,e)=>()=>(o&&(e=o(o=0)),e);var H=(o,e)=>{for(var t in e)M(o,t,{get:e[t],enumerable:!0})},O=(o,e,t,i)=>{if(e&&typeof e=="object"||typeof e=="function")for(let s of R(e))!F.call(o,s)&&s!==t&&M(o,s,{get:()=>e[s],enumerable:!(i=I(e,s))||i.enumerable});return o};var q=o=>O(M({},"__esModule",{value:!0}),o);var D={};H(D,{HTML5Renderer:()=>v});var v,V=W(()=>{v=class{constructor(e){this.player=e,this.media=e.element}async init(){this.media.controls=!1,this.media.removeAttribute("controls"),this.attachEvents(),this.media.preload=this.player.options.preload,this.media.load()}attachEvents(){this.media.addEventListener("loadedmetadata",()=>{this.player.state.duration=this.media.duration,this.player.emit("loadedmetadata")}),this.media.addEventListener("play",()=>{this.player.state.playing=!0,this.player.state.paused=!1,this.player.state.ended=!1,this.player.emit("play"),this.player.options.onPlay&&this.player.options.onPlay.call(this.player),this.player.options.pauseOthersOnPlay&&this.pauseOtherPlayers()}),this.media.addEventListener("pause",()=>{this.player.state.playing=!1,this.player.state.paused=!0,this.player.emit("pause"),this.player.options.onPause&&this.player.options.onPause.call(this.player)}),this.media.addEventListener("ended",()=>{this.player.state.playing=!1,this.player.state.paused=!0,this.player.state.ended=!0,this.player.emit("ended"),this.player.options.onEnded&&this.player.options.onEnded.call(this.player),this.player.options.loop&&(this.player.seek(0),this.player.play())}),this.media.addEventListener("timeupdate",()=>{this.player.state.currentTime=this.media.currentTime,this.player.emit("timeupdate",this.media.currentTime),this.player.options.onTimeUpdate&&this.player.options.onTimeUpdate.call(this.player,this.media.currentTime)}),this.media.addEventListener("volumechange",()=>{this.player.state.volume=this.media.volume,this.player.state.muted=this.media.muted,this.player.emit("volumechange",this.media.volume),this.player.options.onVolumeChange&&this.player.options.onVolumeChange.call(this.player,this.media.volume)}),this.media.addEventListener("seeking",()=>{this.player.state.seeking=!0,this.player.emit("seeking")}),this.media.addEventListener("seeked",()=>{this.player.state.seeking=!1,this.player.emit("seeked")}),this.media.addEventListener("waiting",()=>{this.player.state.buffering=!0,this.player.emit("waiting")}),this.media.addEventListener("canplay",()=>{this.player.state.buffering=!1,this.player.emit("canplay")}),this.media.addEventListener("progress",()=>{if(this.media.buffered.length>0){let e=this.media.buffered.end(this.media.buffered.length-1);this.player.emit("progress",e)}}),this.media.addEventListener("error",e=>{this.player.handleError(this.media.error)}),this.media.addEventListener("ratechange",()=>{this.player.state.playbackSpeed=this.media.playbackRate,this.player.emit("ratechange",this.media.playbackRate)})}pauseOtherPlayers(){document.querySelectorAll(".vidply-player").forEach(t=>{if(t!==this.player.container){let i=t.querySelector("video, audio");i&&!i.paused&&i.pause()}})}play(){let e=this.media.play();e!==void 0&&e.catch(t=>{this.player.log("Play failed:",t,"warn"),this.player.options.autoplay&&!this.player.state.muted&&(this.player.log("Retrying play with muted audio","info"),this.media.muted=!0,this.media.play().catch(i=>{this.player.handleError(i)}))})}pause(){this.media.pause()}seek(e){this.media.currentTime=e}setVolume(e){this.media.volume=e}setMuted(e){this.media.muted=e}setPlaybackSpeed(e){this.media.playbackRate=e}getQualities(){let e=Array.from(this.media.querySelectorAll("source"));return e.length<=1?[]:e.map((t,i)=>{let s=t.getAttribute("data-quality")||t.getAttribute("label")||"",a=t.getAttribute("data-height")||this.extractHeightFromLabel(s),r=t.getAttribute("data-width")||"";return{index:i,height:a?parseInt(a):0,width:r?parseInt(r):0,src:t.src,type:t.type,name:s||(a?`${a}p`:`Quality ${i+1}`)}}).filter(t=>t.height>0)}extractHeightFromLabel(e){let t=e.match(/(\d+)p/i);return t?parseInt(t[1]):0}switchQuality(e){let t=this.getQualities();if(e<0||e>=t.length){this.player.log("Invalid quality index","warn");return}let i=t[e],s=this.media.currentTime,a=!this.media.paused;if(this.media.currentSrc===i.src){this.player.log("Already at this quality level","info");return}this.player.log(`Switching to quality: ${i.name}`,"info"),this.media.src=i.src;let l=()=>{this.media.removeEventListener("loadedmetadata",l),this.media.currentTime=s,a&&this.media.play().catch(c=>{this.player.log("Failed to resume playback after quality switch","warn")}),this.player.emit("qualitychange",{quality:i.name,index:e})};this.media.addEventListener("loadedmetadata",l),this.media.load()}getCurrentQuality(){let e=this.getQualities(),t=this.media.currentSrc;for(let i=0;i<e.length;i++)if(e[i].src===t)return i;return 0}destroy(){this.media.removeEventListener("loadedmetadata",()=>{}),this.media.removeEventListener("play",()=>{}),this.media.removeEventListener("pause",()=>{})}}});var X={};H(X,{Player:()=>g,PlaylistManager:()=>S,default:()=>j});var w=class{constructor(){this.events={}}on(e,t){return this.events[e]||(this.events[e]=[]),this.events[e].push(t),this}once(e,t){let i=(...s)=>{t(...s),this.off(e,i)};return this.on(e,i)}off(e,t){return this.events[e]?(t?this.events[e]=this.events[e].filter(i=>i!==t):delete this.events[e],this):this}emit(e,...t){return this.events[e]?(this.events[e].forEach(i=>{i(...t)}),this):this}removeAllListeners(){return this.events={},this}};var n={createElement(o,e={}){let t=document.createElement(o);return e.className&&(t.className=e.className),e.attributes&&Object.entries(e.attributes).forEach(([i,s])=>{t.setAttribute(i,s)}),e.innerHTML&&(t.innerHTML=e.innerHTML),e.textContent&&(t.textContent=e.textContent),e.style&&Object.assign(t.style,e.style),e.children&&e.children.forEach(i=>{i&&t.appendChild(i)}),t},addClass(o,e){o&&e&&o.classList.add(e)},removeClass(o,e){o&&e&&o.classList.remove(e)},toggleClass(o,e){o&&e&&o.classList.toggle(e)},hasClass(o,e){return o&&o.classList.contains(e)},show(o){o&&(o.style.display="")},hide(o){o&&(o.style.display="none")},fadeIn(o,e=300){if(!o)return;o.style.opacity="0",o.style.display="";let t=null,i=s=>{t||(t=s);let a=s-t,r=Math.min(a/e,1);o.style.opacity=r,a<e&&requestAnimationFrame(i)};requestAnimationFrame(i)},fadeOut(o,e=300){if(!o)return;let t=parseFloat(getComputedStyle(o).opacity)||1,i=null,s=a=>{i||(i=a);let r=a-i,l=Math.max(t-r/e,0);o.style.opacity=l,r<e?requestAnimationFrame(s):o.style.display="none"};requestAnimationFrame(s)},offset(o){if(!o)return{top:0,left:0};let e=o.getBoundingClientRect();return{top:e.top+window.pageYOffset,left:e.left+window.pageXOffset,width:e.width,height:e.height}},escapeHTML(o){let e=document.createElement("div");return e.textContent=o,e.innerHTML},sanitizeHTML(o){let e=document.createElement("div"),t=o.replace(/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,"").replace(/<iframe\b[^<]*(?:(?!<\/iframe>)<[^<]*)*<\/iframe>/gi,"").replace(/on\w+\s*=/gi,"").replace(/javascript:/gi,"");return e.innerHTML=t,e.innerHTML}};var m={formatTime(o,e=!1){if(!isFinite(o)||o<0)return e?"00:00:00":"00:00";let t=Math.floor(o/3600),i=Math.floor(o%3600/60),s=Math.floor(o%60),a=r=>String(r).padStart(2,"0");return t>0||e?`${a(t)}:${a(i)}:${a(s)}`:`${a(i)}:${a(s)}`},parseTime(o){let e=o.split(":").map(t=>parseInt(t,10));return e.length===3?e[0]*3600+e[1]*60+e[2]:e.length===2?e[0]*60+e[1]:e.length===1?e[0]:0},formatDuration(o){if(!isFinite(o)||o<0)return"0 seconds";let e=Math.floor(o/3600),t=Math.floor(o%3600/60),i=Math.floor(o%60),s=[];return e>0&&s.push(`${e} hour${e!==1?"s":""}`),t>0&&s.push(`${t} minute${t!==1?"s":""}`),(i>0||s.length===0)&&s.push(`${i} second${i!==1?"s":""}`),s.join(", ")},formatPercentage(o,e){return e===0?0:Math.round(o/e*100)}};var Q={play:'<path d="M8 5v14l11-7z"/>',pause:'<path d="M6 4h4v16H6V4zm8 0h4v16h-4V4z"/>',stop:'<rect x="6" y="6" width="12" height="12"/>',rewind:'<path d="M11 18V6l-8.5 6 8.5 6zm.5-6l8.5 6V6l-8.5 6z"/>',forward:'<path d="M4 18l8.5-6L4 6v12zm9-12v12l8.5-6L13 6z"/>',skipPrevious:'<path d="M6 6h2v12H6V6zm3 6l8.5 6V6L9 12z"/>',skipNext:'<path d="M16 6h2v12h-2V6zM6 6l8.5 6L6 18V6z"/>',restart:'<path d="M12 5V1L7 6l5 5V7c3.31 0 6 2.69 6 6s-2.69 6-6 6-6-2.69-6-6H4c0 4.42 3.58 8 8 8s8-3.58 8-8-3.58-8-8-8z"/>',volumeHigh:'<path d="M3 9v6h4l5 5V4L7 9H3zm13.5 3c0-1.77-1.02-3.29-2.5-4.03v8.05c1.48-.73 2.5-2.25 2.5-4.02zM14 3.23v2.06c2.89.86 5 3.54 5 6.71s-2.11 5.85-5 6.71v2.06c4.01-.91 7-4.49 7-8.77s-2.99-7.86-7-8.77z"/>',volumeMedium:'<path d="M3 9v6h4l5 5V4L7 9H3zm13.5 3c0-1.77-1.02-3.29-2.5-4.03v8.05c1.48-.73 2.5-2.25 2.5-4.02z"/>',volumeLow:'<path d="M7 9v6h4l5 5V4l-5 5H7z"/>',volumeMuted:'<path d="M16.5 12c0-1.77-1.02-3.29-2.5-4.03v2.21l2.45 2.45c.03-.2.05-.41.05-.63zm2.5 0c0 .94-.2 1.82-.54 2.64l1.51 1.51C20.63 14.91 21 13.5 21 12c0-4.28-2.99-7.86-7-8.77v2.06c2.89.86 5 3.54 5 6.71zM4.27 3L3 4.27 7.73 9H3v6h4l5 5v-6.73l4.25 4.25c-.67.52-1.42.93-2.25 1.18v2.06c1.38-.31 2.63-.95 3.69-1.81L19.73 21 21 19.73l-9-9L4.27 3zM12 4L9.91 6.09 12 8.18V4z"/>',fullscreen:'<path d="M7 14H5v5h5v-2H7v-3zm-2-4h2V7h3V5H5v5zm12 7h-3v2h5v-5h-2v3zM14 5v2h3v3h2V5h-5z"/>',fullscreenExit:'<path d="M5 16h3v3h2v-5H5v2zm3-8H5v2h5V5H8v3zm6 11h2v-3h3v-2h-5v5zm2-11V5h-2v5h5V8h-3z"/>',settings:'<path d="M19.14 12.94c.04-.3.06-.61.06-.94 0-.32-.02-.64-.07-.94l2.03-1.58c.18-.14.23-.41.12-.61l-1.92-3.32c-.12-.22-.37-.29-.59-.22l-2.39.96c-.5-.38-1.03-.7-1.62-.94L14.4 2.81c-.04-.24-.24-.41-.48-.41h-3.84c-.24 0-.43.17-.47.41l-.36 2.54c-.59.24-1.13.57-1.62.94l-2.39-.96c-.22-.08-.47 0-.59.22L2.74 8.87c-.12.21-.08.47.12.61l2.03 1.58c-.05.3-.09.63-.09.94s.02.64.07.94l-2.03 1.58c-.18.14-.23.41-.12.61l1.92 3.32c.12.22.37.29.59.22l2.39-.96c.5.38 1.03.7 1.62.94l.36 2.54c.05.24.24.41.48.41h3.84c.24 0 .44-.17.47-.41l.36-2.54c.59-.24 1.13-.56 1.62-.94l2.39.96c.22.08.47 0 .59-.22l1.92-3.32c.12-.22.07-.47-.12-.61l-2.01-1.58zM12 15.6c-1.98 0-3.6-1.62-3.6-3.6s1.62-3.6 3.6-3.6 3.6 1.62 3.6 3.6-1.62 3.6-3.6 3.6z"/>',captions:'<path d="M19 4H5c-1.11 0-2 .9-2 2v12c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm-8 7H9.5v-.5h-2v3h2V13H11v1c0 .55-.45 1-1 1H7c-.55 0-1-.45-1-1v-4c0-.55.45-1 1-1h3c.55 0 1 .45 1 1v1zm7 0h-1.5v-.5h-2v3h2V13H18v1c0 .55-.45 1-1 1h-3c-.55 0-1-.45-1-1v-4c0-.55.45-1 1-1h3c.55 0 1 .45 1 1v1z"/>',captionsOff:'<path d="M19 4H5c-1.11 0-2 .9-2 2v12c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm-8 7H9.5v-.5h-2v3h2V13H11v1c0 .55-.45 1-1 1H7c-.55 0-1-.45-1-1v-4c0-.55.45-1 1-1h3c.55 0 1 .45 1 1v1zm7 0h-1.5v-.5h-2v3h2V13H18v1c0 .55-.45 1-1 1h-3c-.55 0-1-.45-1-1v-4c0-.55.45-1 1-1h3c.55 0 1 .45 1 1v1z"/><path d="M0 0h24v24H0z" fill="none"/>',pip:'<path d="M19 7h-8v6h8V7zm2-4H3c-1.1 0-2 .9-2 2v14c0 1.1.9 1.98 2 1.98h18c1.1 0 2-.88 2-1.98V5c0-1.1-.9-2-2-2zm0 16.01H3V4.98h18v14.03z"/>',speed:'<path d="M20.38 8.57l-1.23 1.85a8 8 0 0 1-.22 7.58H5.07A8 8 0 0 1 15.58 6.85l1.85-1.23A10 10 0 0 0 3.35 19a2 2 0 0 0 1.72 1h13.85a2 2 0 0 0 1.74-1 10 10 0 0 0-.27-10.44z"/><path d="M10.59 15.41a2 2 0 0 0 2.83 0l5.66-8.49-8.49 5.66a2 2 0 0 0 0 2.83z"/>',close:'<path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/>',check:'<path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"/>',arrowUp:'<path d="M7 14l5-5 5 5z"/>',arrowDown:'<path d="M7 10l5 5 5-5z"/>',arrowLeft:'<path d="M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"/>',arrowRight:'<path d="M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"/>',loading:'<path d="M12 4V1L8 5l4 4V6c3.31 0 6 2.69 6 6 0 1.01-.25 1.97-.7 2.8l1.46 1.46C19.54 15.03 20 13.57 20 12c0-4.42-3.58-8-8-8zm0 14c-3.31 0-6-2.69-6-6 0-1.01.25-1.97.7-2.8L5.24 7.74C4.46 8.97 4 10.43 4 12c0 4.42 3.58 8 8 8v3l4-4-4-4v3z"/>',error:'<path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-2h2v2zm0-4h-2V7h2v6z"/>',download:'<path d="M19 9h-4V3H9v6H5l7 7 7-7zM5 18v2h14v-2H5z"/>',link:'<path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"/>',playlist:'<path d="M15 6H3v2h12V6zm0 4H3v2h12v-2zM3 16h8v-2H3v2zM17 6v8.18c-.31-.11-.65-.18-1-.18-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3V8h3V6h-5z"/>',language:'<path d="M11.99 2C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2zm6.93 6h-2.95c-.32-1.25-.78-2.45-1.38-3.56 1.84.63 3.37 1.91 4.33 3.56zM12 4.04c.83 1.2 1.48 2.53 1.91 3.96h-3.82c.43-1.43 1.08-2.76 1.91-3.96zM4.26 14C4.1 13.36 4 12.69 4 12s.1-1.36.26-2h3.38c-.08.66-.14 1.32-.14 2 0 .68.06 1.34.14 2H4.26zm.82 2h2.95c.32 1.25.78 2.45 1.38 3.56-1.84-.63-3.37-1.9-4.33-3.56zm2.95-8H5.08c.96-1.66 2.49-2.93 4.33-3.56C8.81 5.55 8.35 6.75 8.03 8zM12 19.96c-.83-1.2-1.48-2.53-1.91-3.96h3.82c-.43 1.43-1.08 2.76-1.91 3.96zM14.34 14H9.66c-.09-.66-.16-1.32-.16-2 0-.68.07-1.35.16-2h4.68c.09.65.16 1.32.16 2 0 .68-.07 1.34-.16 2zm.25 5.56c.6-1.11 1.06-2.31 1.38-3.56h2.95c-.96 1.65-2.49 2.93-4.33 3.56zM16.36 14c.08-.66.14-1.32.14-2 0-.68-.06-1.34-.14-2h3.38c.16.64.26 1.31.26 2s-.1 1.36-.26 2h-3.38z"/>',hd:'<path d="M19 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.11 0 2-.9 2-2V5c0-1.1-.89-2-2-2zm-8 12H9.5v-2h-2v2H6V9h1.5v2.5h2V9H11v6zm7-1c0 .55-.45 1-1 1h-.75v1.5h-1.5V15H14c-.55 0-1-.45-1-1v-4c0-.55.45-1 1-1h3c.55 0 1 .45 1 1v4zm-3.5-.5h2v-3h-2v3z"/>',transcript:'<path d="M14 2H6c-1.1 0-1.99.9-1.99 2L4 20c0 1.1.89 2 1.99 2H18c1.1 0 2-.9 2-2V8l-6-6zm2 16H8v-2h8v2zm0-4H8v-2h8v2zm-3-5V3.5L18.5 9H13z"/>',audioDescription:'<path d="M12 3v9.28c-.47-.17-.97-.28-1.5-.28C8.01 12 6 14.01 6 16.5S8.01 21 10.5 21c2.31 0 4.2-1.75 4.45-4H15V6h4V3h-7z"/><path d="M10.5 19c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z"/>',audioDescriptionOn:'<path d="M12 3v9.28c-.47-.17-.97-.28-1.5-.28C8.01 12 6 14.01 6 16.5S8.01 21 10.5 21c2.31 0 4.2-1.75 4.45-4H15V6h4V3h-7z"/><path d="M10.5 19c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z"/><circle cx="19" cy="16" r="3" fill="#3b82f6"/><path d="M18.5 17.5l1-1 1.5 1.5" stroke="white" stroke-width="1.5" fill="none" stroke-linecap="round" stroke-linejoin="round"/>',signLanguage:'<path d="M12 2C10.34 2 9 3.34 9 5v4c0 .34.07.66.18.96L7.5 8.29C7.19 8.1 6.85 8 6.5 8 5.12 8 4 9.12 4 10.5v3c0 .83.67 1.5 1.5 1.5s1.5-.67 1.5-1.5v-3c0-.28.22-.5.5-.5s.5.22.5.5V14l2 2v-1c0-.55.45-1 1-1s1 .45 1 1v2c0 .55.45 1 1 1s1-.45 1-1V9c0-.55.45-1 1-1s1 .45 1 1v8c0 2.21-1.79 4-4 4s-4-1.79-4-4v-2.83l-2.93-2.93A3.93 3.93 0 0 1 4 8c0-1.66 1.34-3 3-3 .83 0 1.58.34 2.12.88L11 7.76V5c0-.55.45-1 1-1s1 .45 1 1v4c0 .55.45 1 1 1s1-.45 1-1V5c0-1.66-1.34-3-3-3z"/>',signLanguageOn:'<path d="M12 2C10.34 2 9 3.34 9 5v4c0 .34.07.66.18.96L7.5 8.29C7.19 8.1 6.85 8 6.5 8 5.12 8 4 9.12 4 10.5v3c0 .83.67 1.5 1.5 1.5s1.5-.67 1.5-1.5v-3c0-.28.22-.5.5-.5s.5.22.5.5V14l2 2v-1c0-.55.45-1 1-1s1 .45 1 1v2c0 .55.45 1 1 1s1-.45 1-1V9c0-.55.45-1 1-1s1 .45 1 1v8c0 2.21-1.79 4-4 4s-4-1.79-4-4v-2.83l-2.93-2.93A3.93 3.93 0 0 1 4 8c0-1.66 1.34-3 3-3 .83 0 1.58.34 2.12.88L11 7.76V5c0-.55.45-1 1-1s1 .45 1 1v4c0 .55.45 1 1 1s1-.45 1-1V5c0-1.66-1.34-3-3-3z"/><circle cx="19" cy="16" r="3" fill="#3b82f6"/><path d="M18.5 17.5l1-1 1.5 1.5" stroke="white" stroke-width="1.5" fill="none" stroke-linecap="round" stroke-linejoin="round"/>',speaker:'<path d="M3 9v6h4l5 5V4L7 9H3zm13.5 3c0-1.77-1.02-3.29-2.5-4.03v8.05c1.48-.73 2.5-2.25 2.5-4.02z"/>',music:'<path d="M12 3v9.28c-.47-.17-.97-.28-1.5-.28C8.01 12 6 14.01 6 16.5S8.01 21 10.5 21c2.31 0 4.2-1.75 4.45-4H15V6h4V3h-7zm-1.5 16c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z"/>',moreVertical:'<path d="M12 8c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2zm0 2c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm0 6c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2z"/>',moreHorizontal:'<path d="M6 10c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm12 0c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm-6 0c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2z"/>'},U=o=>`<svg viewBox="0 0 24 24" fill="currentColor">${o}</svg>`,B=Object.fromEntries(Object.entries(Q).map(([o,e])=>[o,U(e)]));function Y(o){return B[o]||B.play}function h(o,e=""){let t=document.createElement("span");return t.className=`vidply-icon ${e}`.trim(),t.innerHTML=Y(o),t.setAttribute("aria-hidden","true"),t}function A(){let o=document.createElementNS("http://www.w3.org/2000/svg","svg");o.setAttribute("class","vidply-play-overlay"),o.setAttribute("viewBox","0 0 80 80"),o.setAttribute("width","80"),o.setAttribute("height","80"),o.setAttribute("aria-hidden","true"),o.setAttribute("role","presentation"),o.style.cursor="pointer";let e=document.createElementNS("http://www.w3.org/2000/svg","defs"),t=`vidply-play-shadow-${Math.random().toString(36).substr(2,9)}`,i=document.createElementNS("http://www.w3.org/2000/svg","filter");i.setAttribute("id",t),i.setAttribute("x","-50%"),i.setAttribute("y","-50%"),i.setAttribute("width","200%"),i.setAttribute("height","200%");let s=document.createElementNS("http://www.w3.org/2000/svg","feGaussianBlur");s.setAttribute("in","SourceAlpha"),s.setAttribute("stdDeviation","3");let a=document.createElementNS("http://www.w3.org/2000/svg","feOffset");a.setAttribute("dx","0"),a.setAttribute("dy","2"),a.setAttribute("result","offsetblur");let r=document.createElementNS("http://www.w3.org/2000/svg","feComponentTransfer"),l=document.createElementNS("http://www.w3.org/2000/svg","feFuncA");l.setAttribute("type","linear"),l.setAttribute("slope","0.3"),r.appendChild(l);let c=document.createElementNS("http://www.w3.org/2000/svg","feMerge"),d=document.createElementNS("http://www.w3.org/2000/svg","feMergeNode"),u=document.createElementNS("http://www.w3.org/2000/svg","feMergeNode");u.setAttribute("in","SourceGraphic"),c.appendChild(d),c.appendChild(u),i.appendChild(s),i.appendChild(a),i.appendChild(r),i.appendChild(c),e.appendChild(i),o.appendChild(e);let y=document.createElementNS("http://www.w3.org/2000/svg","circle");y.setAttribute("cx","40"),y.setAttribute("cy","40"),y.setAttribute("r","40"),y.setAttribute("fill","rgba(255, 255, 255, 0.95)"),y.setAttribute("filter",`url(#${t})`),y.setAttribute("class","vidply-play-overlay-bg"),o.appendChild(y);let b=document.createElementNS("http://www.w3.org/2000/svg","polygon");return b.setAttribute("points","32,28 32,52 54,40"),b.setAttribute("fill","#0a406e"),b.setAttribute("class","vidply-play-overlay-icon"),o.appendChild(b),o}var N={en:{player:{label:"Video Player",play:"Play",pause:"Pause",stop:"Stop",restart:"Restart from beginning",rewind:"Rewind",forward:"Forward",rewindSeconds:"Rewind {seconds} seconds",forwardSeconds:"Forward {seconds} seconds",previous:"Previous track",next:"Next track",volume:"Volume",mute:"Mute",unmute:"Unmute",fullscreen:"Fullscreen",exitFullscreen:"Exit Fullscreen",captions:"Captions",chapters:"Chapters",quality:"Quality",captionStyling:"Caption styling",transcript:"Toggle transcript",audioDescription:"Audio description",signLanguage:"Sign language video",settings:"Settings",speed:"Playback Speed",pip:"Picture in Picture",currentTime:"Current time",duration:"Duration",progress:"Progress",seekForward:"Seek forward {seconds} seconds",seekBackward:"Seek backward {seconds} seconds",volumeUp:"Volume up",volumeDown:"Volume down",loading:"Loading...",loadingChapters:"Loading chapters...",error:"Error loading media",buffering:"Buffering...",signLanguageVideo:"Sign Language Video",noChapters:"No chapters available",noCaptions:"No captions available",auto:"Auto",autoQuality:"Auto (no quality selection available)",noQuality:"Quality selection not available"},captions:{off:"Off",select:"Select captions",fontSize:"Font Size",fontFamily:"Font Family",color:"Text Color",backgroundColor:"Background Color",opacity:"Opacity"},settings:{title:"Settings",quality:"Quality",speed:"Speed",captions:"Captions",language:"Language",reset:"Reset to defaults",close:"Close"},speeds:{"0.25":"0.25x","0.5":"0.5x","0.75":"0.75x",1:"Normal","1.25":"1.25x","1.5":"1.5x","1.75":"1.75x",2:"2x"}},de:{player:{label:"Videoplayer",play:"Abspielen",pause:"Pause",stop:"Stopp",restart:"Von vorne beginnen",rewind:"Zur\xFCckspulen",forward:"Vorspulen",rewindSeconds:"{seconds} Sekunden zur\xFCckspulen",forwardSeconds:"{seconds} Sekunden vorspulen",previous:"Vorheriger Titel",next:"N\xE4chster Titel",volume:"Lautst\xE4rke",mute:"Stumm",unmute:"Ton ein",fullscreen:"Vollbild",exitFullscreen:"Vollbild beenden",captions:"Untertitel",chapters:"Kapitel",quality:"Qualit\xE4t",captionStyling:"Untertitel-Stil",transcript:"Transkript umschalten",audioDescription:"Audiodeskription",signLanguage:"Geb\xE4rdensprache-Video",settings:"Einstellungen",speed:"Wiedergabegeschwindigkeit",pip:"Bild-in-Bild",currentTime:"Aktuelle Zeit",duration:"Dauer",progress:"Fortschritt",seekForward:"{seconds} Sekunden vorspulen",seekBackward:"{seconds} Sekunden zur\xFCckspulen",volumeUp:"Lauter",volumeDown:"Leiser",loading:"L\xE4dt...",loadingChapters:"Kapitel werden geladen...",error:"Fehler beim Laden",buffering:"Puffern...",signLanguageVideo:"Geb\xE4rdensprache-Video",noChapters:"Keine Kapitel verf\xFCgbar",noCaptions:"Keine Untertitel verf\xFCgbar",auto:"Automatisch",autoQuality:"Automatisch (keine Qualit\xE4tsauswahl verf\xFCgbar)",noQuality:"Qualit\xE4tsauswahl nicht verf\xFCgbar"},captions:{off:"Aus",select:"Untertitel ausw\xE4hlen",fontSize:"Schriftgr\xF6\xDFe",fontFamily:"Schriftart",color:"Textfarbe",backgroundColor:"Hintergrundfarbe",opacity:"Deckkraft"},settings:{title:"Einstellungen",quality:"Qualit\xE4t",speed:"Geschwindigkeit",captions:"Untertitel",language:"Sprache",reset:"Zur\xFCcksetzen",close:"Schlie\xDFen"},speeds:{"0.25":"0,25x","0.5":"0,5x","0.75":"0,75x",1:"Normal","1.25":"1,25x","1.5":"1,5x","1.75":"1,75x",2:"2x"}},es:{player:{label:"Reproductor de video",play:"Reproducir",pause:"Pausa",stop:"Detener",restart:"Reiniciar desde el principio",rewind:"Retroceder",forward:"Avanzar",rewindSeconds:"Retroceder {seconds} segundos",forwardSeconds:"Avanzar {seconds} segundos",previous:"Pista anterior",next:"Siguiente pista",volume:"Volumen",mute:"Silenciar",unmute:"Activar sonido",fullscreen:"Pantalla completa",exitFullscreen:"Salir de pantalla completa",captions:"Subt\xEDtulos",chapters:"Cap\xEDtulos",quality:"Calidad",captionStyling:"Estilo de subt\xEDtulos",transcript:"Alternar transcripci\xF3n",audioDescription:"Audiodescripci\xF3n",signLanguage:"Video en lengua de se\xF1as",settings:"Configuraci\xF3n",speed:"Velocidad de reproducci\xF3n",pip:"Imagen en imagen",currentTime:"Tiempo actual",duration:"Duraci\xF3n",progress:"Progreso",seekForward:"Avanzar {seconds} segundos",seekBackward:"Retroceder {seconds} segundos",volumeUp:"Subir volumen",volumeDown:"Bajar volumen",loading:"Cargando...",loadingChapters:"Cargando cap\xEDtulos...",error:"Error al cargar",buffering:"Almacenando en b\xFAfer...",signLanguageVideo:"Video en Lengua de Se\xF1as",noChapters:"No hay cap\xEDtulos disponibles",noCaptions:"No hay subt\xEDtulos disponibles",auto:"Autom\xE1tico",autoQuality:"Autom\xE1tico (selecci\xF3n de calidad no disponible)",noQuality:"Selecci\xF3n de calidad no disponible"},captions:{off:"Desactivado",select:"Seleccionar subt\xEDtulos",fontSize:"Tama\xF1o de fuente",fontFamily:"Familia de fuente",color:"Color de texto",backgroundColor:"Color de fondo",opacity:"Opacidad"},settings:{title:"Configuraci\xF3n",quality:"Calidad",speed:"Velocidad",captions:"Subt\xEDtulos",language:"Idioma",reset:"Restablecer",close:"Cerrar"},speeds:{"0.25":"0,25x","0.5":"0,5x","0.75":"0,75x",1:"Normal","1.25":"1,25x","1.5":"1,5x","1.75":"1,75x",2:"2x"}},fr:{player:{label:"Lecteur vid\xE9o",play:"Lecture",pause:"Pause",stop:"Arr\xEAt",restart:"Red\xE9marrer du d\xE9but",rewind:"Reculer",forward:"Avancer",rewindSeconds:"Reculer de {seconds} secondes",forwardSeconds:"Avancer de {seconds} secondes",previous:"Piste pr\xE9c\xE9dente",next:"Piste suivante",volume:"Volume",mute:"Muet",unmute:"Activer le son",fullscreen:"Plein \xE9cran",exitFullscreen:"Quitter le plein \xE9cran",captions:"Sous-titres",chapters:"Chapitres",quality:"Qualit\xE9",captionStyling:"Style des sous-titres",transcript:"Activer/d\xE9sactiver la transcription",audioDescription:"Audiodescription",signLanguage:"Vid\xE9o en langue des signes",settings:"Param\xE8tres",speed:"Vitesse de lecture",pip:"Image dans l'image",currentTime:"Temps actuel",duration:"Dur\xE9e",progress:"Progression",seekForward:"Avancer de {seconds} secondes",seekBackward:"Reculer de {seconds} secondes",volumeUp:"Augmenter le volume",volumeDown:"Diminuer le volume",loading:"Chargement...",loadingChapters:"Chargement des chapitres...",error:"Erreur de chargement",buffering:"Mise en m\xE9moire tampon...",signLanguageVideo:"Vid\xE9o en Langue des Signes",noChapters:"Aucun chapitre disponible",noCaptions:"Aucun sous-titre disponible",auto:"Automatique",autoQuality:"Automatique (s\xE9lection de qualit\xE9 non disponible)",noQuality:"S\xE9lection de qualit\xE9 non disponible"},captions:{off:"D\xE9sactiv\xE9",select:"S\xE9lectionner les sous-titres",fontSize:"Taille de police",fontFamily:"Police",color:"Couleur du texte",backgroundColor:"Couleur de fond",opacity:"Opacit\xE9"},settings:{title:"Param\xE8tres",quality:"Qualit\xE9",speed:"Vitesse",captions:"Sous-titres",language:"Langue",reset:"R\xE9initialiser",close:"Fermer"},speeds:{"0.25":"0,25x","0.5":"0,5x","0.75":"0,75x",1:"Normal","1.25":"1,25x","1.5":"1,5x","1.75":"1,75x",2:"2x"}},ja:{player:{label:"\u30D3\u30C7\u30AA\u30D7\u30EC\u30FC\u30E4\u30FC",play:"\u518D\u751F",pause:"\u4E00\u6642\u505C\u6B62",stop:"\u505C\u6B62",restart:"\u6700\u521D\u304B\u3089\u518D\u751F",rewind:"\u5DFB\u304D\u623B\u3057",forward:"\u65E9\u9001\u308A",rewindSeconds:"{seconds}\u79D2\u623B\u3059",forwardSeconds:"{seconds}\u79D2\u9032\u3081\u308B",previous:"\u524D\u306E\u30C8\u30E9\u30C3\u30AF",next:"\u6B21\u306E\u30C8\u30E9\u30C3\u30AF",volume:"\u97F3\u91CF",mute:"\u30DF\u30E5\u30FC\u30C8",unmute:"\u30DF\u30E5\u30FC\u30C8\u89E3\u9664",fullscreen:"\u5168\u753B\u9762\u8868\u793A",exitFullscreen:"\u5168\u753B\u9762\u8868\u793A\u3092\u7D42\u4E86",captions:"\u5B57\u5E55",chapters:"\u30C1\u30E3\u30D7\u30BF\u30FC",quality:"\u753B\u8CEA",captionStyling:"\u5B57\u5E55\u30B9\u30BF\u30A4\u30EB",transcript:"\u6587\u5B57\u8D77\u3053\u3057\u5207\u308A\u66FF\u3048",audioDescription:"\u97F3\u58F0\u89E3\u8AAC",signLanguage:"\u624B\u8A71\u52D5\u753B",settings:"\u8A2D\u5B9A",speed:"\u518D\u751F\u901F\u5EA6",pip:"\u30D4\u30AF\u30C1\u30E3\u30FC\u30A4\u30F3\u30D4\u30AF\u30C1\u30E3\u30FC",currentTime:"\u73FE\u5728\u306E\u6642\u9593",duration:"\u518D\u751F\u6642\u9593",progress:"\u9032\u884C\u72B6\u6CC1",seekForward:"{seconds}\u79D2\u9032\u3081\u308B",seekBackward:"{seconds}\u79D2\u623B\u3059",volumeUp:"\u97F3\u91CF\u3092\u4E0A\u3052\u308B",volumeDown:"\u97F3\u91CF\u3092\u4E0B\u3052\u308B",loading:"\u8AAD\u307F\u8FBC\u307F\u4E2D...",loadingChapters:"\u30C1\u30E3\u30D7\u30BF\u30FC\u8AAD\u307F\u8FBC\u307F\u4E2D...",error:"\u8AAD\u307F\u8FBC\u307F\u30A8\u30E9\u30FC",buffering:"\u30D0\u30C3\u30D5\u30A1\u30EA\u30F3\u30B0\u4E2D...",signLanguageVideo:"\u624B\u8A71\u52D5\u753B",noChapters:"\u30C1\u30E3\u30D7\u30BF\u30FC\u304C\u3042\u308A\u307E\u305B\u3093",noCaptions:"\u5B57\u5E55\u304C\u3042\u308A\u307E\u305B\u3093",auto:"\u81EA\u52D5",autoQuality:"\u81EA\u52D5\uFF08\u753B\u8CEA\u9078\u629E\u4E0D\u53EF\uFF09",noQuality:"\u753B\u8CEA\u9078\u629E\u4E0D\u53EF"},captions:{off:"\u30AA\u30D5",select:"\u5B57\u5E55\u3092\u9078\u629E",fontSize:"\u30D5\u30A9\u30F3\u30C8\u30B5\u30A4\u30BA",fontFamily:"\u30D5\u30A9\u30F3\u30C8",color:"\u30C6\u30AD\u30B9\u30C8\u306E\u8272",backgroundColor:"\u80CC\u666F\u8272",opacity:"\u4E0D\u900F\u660E\u5EA6"},settings:{title:"\u8A2D\u5B9A",quality:"\u753B\u8CEA",speed:"\u901F\u5EA6",captions:"\u5B57\u5E55",language:"\u8A00\u8A9E",reset:"\u30EA\u30BB\u30C3\u30C8",close:"\u9589\u3058\u308B"},speeds:{"0.25":"0.25\u500D\u901F","0.5":"0.5\u500D\u901F","0.75":"0.75\u500D\u901F",1:"\u901A\u5E38","1.25":"1.25\u500D\u901F","1.5":"1.5\u500D\u901F","1.75":"1.75\u500D\u901F",2:"2\u500D\u901F"}}};var $=class{constructor(){this.currentLanguage="en",this.translations=N}setLanguage(e){this.translations[e]?this.currentLanguage=e:(console.warn(`Language "${e}" not found, falling back to English`),this.currentLanguage="en")}getLanguage(){return this.currentLanguage}t(e,t={}){let i=e.split("."),s=this.translations[this.currentLanguage];for(let a of i)if(s&&typeof s=="object"&&a in s)s=s[a];else{s=this.translations.en;for(let r of i)if(s&&typeof s=="object"&&r in s)s=s[r];else return e;break}return typeof s=="string"&&Object.entries(t).forEach(([a,r])=>{s=s.replace(new RegExp(`{${a}}`,"g"),r)}),s}addTranslation(e,t){this.translations[e]||(this.translations[e]={}),Object.assign(this.translations[e],t)}},p=new $;var E=class{constructor(e){this.player=e,this.element=null,this.controls={},this.hideTimeout=null,this.isDraggingProgress=!1,this.isDraggingVolume=!1,this.init()}init(){this.createElement(),this.createControls(),this.attachEvents(),this.setupAutoHide()}isMobile(){return window.innerWidth<640}positionMenu(e,t){this.isMobile()||setTimeout(()=>{let s=t.getBoundingClientRect(),a=e.getBoundingClientRect(),r=window.innerWidth,l=window.innerHeight,c=s.top,d=l-s.bottom;c<a.height+20&&d>c&&(e.style.bottom="auto",e.style.top="calc(100% + 8px)",e.classList.add("vidply-menu-below"));let u=s.left+s.width/2-a.width/2;u<10?(e.style.right="auto",e.style.left="0",e.style.transform="translateX(0)"):u+a.width>r-10&&(e.style.left="auto",e.style.right="0",e.style.transform="translateX(0)")},0)}attachMenuCloseHandler(e,t,i=!1){this.positionMenu(e,t),setTimeout(()=>{let s=r=>{i&&e.contains(r.target)||!e.contains(r.target)&&!t.contains(r.target)&&(e.remove(),document.removeEventListener("click",s),document.removeEventListener("keydown",a))},a=r=>{r.key==="Escape"&&(e.remove(),document.removeEventListener("click",s),document.removeEventListener("keydown",a),t.focus())};document.addEventListener("click",s),document.addEventListener("keydown",a)},100)}createElement(){this.element=n.createElement("div",{className:`${this.player.options.classPrefix}-controls`,attributes:{role:"region","aria-label":p.t("player.label")+" controls"}})}createControls(){this.player.options.progressBar&&this.createProgressBar();let e=n.createElement("div",{className:`${this.player.options.classPrefix}-controls-buttons`}),t=n.createElement("div",{className:`${this.player.options.classPrefix}-controls-left`});this.player.playlistManager&&t.appendChild(this.createPreviousButton()),this.player.options.playPauseButton&&t.appendChild(this.createPlayPauseButton()),t.appendChild(this.createRestartButton()),this.player.playlistManager&&t.appendChild(this.createNextButton()),this.player.playlistManager||t.appendChild(this.createRewindButton()),this.player.playlistManager||t.appendChild(this.createForwardButton()),this.player.options.volumeControl&&t.appendChild(this.createVolumeControl()),(this.player.options.currentTime||this.player.options.duration)&&t.appendChild(this.createTimeDisplay()),this.rightButtons=n.createElement("div",{className:`${this.player.options.classPrefix}-controls-right`});let i=this.hasChapterTracks(),s=this.hasCaptionTracks(),a=this.hasQualityLevels(),r=this.hasAudioDescription();this.player.options.chaptersButton&&i&&this.rightButtons.appendChild(this.createChaptersButton()),this.player.options.qualityButton&&a&&this.rightButtons.appendChild(this.createQualityButton()),this.player.options.captionStyleButton&&s&&this.rightButtons.appendChild(this.createCaptionStyleButton()),this.player.options.speedButton&&this.rightButtons.appendChild(this.createSpeedButton()),this.player.options.captionsButton&&s&&this.rightButtons.appendChild(this.createCaptionsButton()),this.player.options.transcriptButton&&s&&this.rightButtons.appendChild(this.createTranscriptButton()),this.player.options.audioDescriptionButton&&r&&this.rightButtons.appendChild(this.createAudioDescriptionButton());let l=this.hasSignLanguage();this.player.options.signLanguageButton&&l&&this.rightButtons.appendChild(this.createSignLanguageButton()),this.player.options.pipButton&&"pictureInPictureEnabled"in document&&this.rightButtons.appendChild(this.createPipButton()),this.player.options.fullscreenButton&&this.rightButtons.appendChild(this.createFullscreenButton()),e.appendChild(t),e.appendChild(this.rightButtons),this.element.appendChild(e)}hasChapterTracks(){let e=this.player.element.textTracks;for(let t=0;t<e.length;t++)if(e[t].kind==="chapters")return!0;return!1}hasCaptionTracks(){let e=this.player.element.textTracks;for(let t=0;t<e.length;t++)if(e[t].kind==="captions"||e[t].kind==="subtitles")return!0;return!1}hasQualityLevels(){if(this.player.renderer&&this.player.renderer.getQualities){let e=this.player.renderer.getQualities();return e&&e.length>1}return!1}hasAudioDescription(){return this.player.audioDescriptionSrc&&this.player.audioDescriptionSrc.length>0}hasSignLanguage(){return this.player.signLanguageSrc&&this.player.signLanguageSrc.length>0}createProgressBar(){let e=n.createElement("div",{className:`${this.player.options.classPrefix}-progress-container`,attributes:{role:"slider","aria-label":p.t("player.progress"),"aria-valuemin":"0","aria-valuemax":"100","aria-valuenow":"0",tabindex:"0"}});this.controls.buffered=n.createElement("div",{className:`${this.player.options.classPrefix}-progress-buffered`}),this.controls.played=n.createElement("div",{className:`${this.player.options.classPrefix}-progress-played`}),this.controls.progressHandle=n.createElement("div",{className:`${this.player.options.classPrefix}-progress-handle`}),this.controls.progressTooltip=n.createElement("div",{className:`${this.player.options.classPrefix}-progress-tooltip`}),e.appendChild(this.controls.buffered),e.appendChild(this.controls.played),this.controls.played.appendChild(this.controls.progressHandle),e.appendChild(this.controls.progressTooltip),this.controls.progress=e,this.element.appendChild(e),this.setupProgressBarEvents()}setupProgressBarEvents(){let e=this.controls.progress,t=i=>{let s=e.getBoundingClientRect(),a=Math.max(0,Math.min(1,(i-s.left)/s.width)),r=a*this.player.state.duration;return{percent:a,time:r}};e.addEventListener("mousedown",i=>{this.isDraggingProgress=!0;let{time:s}=t(i.clientX);this.player.seek(s)}),document.addEventListener("mousemove",i=>{if(this.isDraggingProgress){let{time:s}=t(i.clientX);this.player.seek(s)}}),document.addEventListener("mouseup",()=>{this.isDraggingProgress=!1}),e.addEventListener("mousemove",i=>{if(!this.isDraggingProgress){let{time:s}=t(i.clientX);this.controls.progressTooltip.textContent=m.formatTime(s),this.controls.progressTooltip.style.left=`${i.clientX-e.getBoundingClientRect().left}px`,this.controls.progressTooltip.style.display="block"}}),e.addEventListener("mouseleave",()=>{this.controls.progressTooltip.style.display="none"}),e.addEventListener("keydown",i=>{i.key==="ArrowLeft"?(i.preventDefault(),this.player.seekBackward(5)):i.key==="ArrowRight"&&(i.preventDefault(),this.player.seekForward(5))}),e.addEventListener("touchstart",i=>{this.isDraggingProgress=!0;let s=i.touches[0],{time:a}=t(s.clientX);this.player.seek(a)}),e.addEventListener("touchmove",i=>{if(this.isDraggingProgress){i.preventDefault();let s=i.touches[0],{time:a}=t(s.clientX);this.player.seek(a)}}),e.addEventListener("touchend",()=>{this.isDraggingProgress=!1})}createPlayPauseButton(){let e=n.createElement("button",{className:`${this.player.options.classPrefix}-button ${this.player.options.classPrefix}-play-pause`,attributes:{type:"button","aria-label":p.t("player.play")}});return e.appendChild(h("play")),e.addEventListener("click",()=>{this.player.toggle()}),this.controls.playPause=e,e}createRestartButton(){let e=n.createElement("button",{className:`${this.player.options.classPrefix}-button ${this.player.options.classPrefix}-restart`,attributes:{type:"button","aria-label":p.t("player.restart")}});return e.appendChild(h("restart")),e.addEventListener("click",()=>{this.player.seek(0),this.player.play()}),e}createPreviousButton(){let e=n.createElement("button",{className:`${this.player.options.classPrefix}-button ${this.player.options.classPrefix}-previous`,attributes:{type:"button","aria-label":p.t("player.previous")}});e.appendChild(h("skipPrevious")),e.addEventListener("click",()=>{this.player.playlistManager&&this.player.playlistManager.previous()});let t=()=>{this.player.playlistManager&&(e.disabled=!this.player.playlistManager.hasPrevious()&&!this.player.playlistManager.options.loop)};return this.player.on("playlisttrackchange",t),t(),this.controls.previous=e,e}createNextButton(){let e=n.createElement("button",{className:`${this.player.options.classPrefix}-button ${this.player.options.classPrefix}-next`,attributes:{type:"button","aria-label":p.t("player.next")}});e.appendChild(h("skipNext")),e.addEventListener("click",()=>{this.player.playlistManager&&this.player.playlistManager.next()});let t=()=>{this.player.playlistManager&&(e.disabled=!this.player.playlistManager.hasNext()&&!this.player.playlistManager.options.loop)};return this.player.on("playlisttrackchange",t),t(),this.controls.next=e,e}createRewindButton(){let e=n.createElement("button",{className:`${this.player.options.classPrefix}-button ${this.player.options.classPrefix}-rewind`,attributes:{type:"button","aria-label":p.t("player.rewindSeconds",{seconds:15})}});return e.appendChild(h("rewind")),e.addEventListener("click",()=>{this.player.seekBackward(15)}),e}createForwardButton(){let e=n.createElement("button",{className:`${this.player.options.classPrefix}-button ${this.player.options.classPrefix}-forward`,attributes:{type:"button","aria-label":p.t("player.forwardSeconds",{seconds:15})}});return e.appendChild(h("forward")),e.addEventListener("click",()=>{this.player.seekForward(15)}),e}createVolumeControl(){let e=n.createElement("button",{className:`${this.player.options.classPrefix}-button ${this.player.options.classPrefix}-mute`,attributes:{type:"button","aria-label":p.t("player.volume"),"aria-haspopup":"true"}});return e.appendChild(h("volumeHigh")),e.addEventListener("contextmenu",t=>{t.preventDefault(),this.player.toggleMute()}),e.addEventListener("click",()=>{this.showVolumeSlider(e)}),this.controls.mute=e,e}showVolumeSlider(e){let t=document.querySelector(`.${this.player.options.classPrefix}-volume-menu`);if(t){t.remove();return}let i=n.createElement("div",{className:`${this.player.options.classPrefix}-volume-menu ${this.player.options.classPrefix}-menu`}),s=n.createElement("div",{className:`${this.player.options.classPrefix}-volume-slider`,attributes:{role:"slider","aria-label":p.t("player.volume"),"aria-valuemin":"0","aria-valuemax":"100","aria-valuenow":String(Math.round(this.player.state.volume*100)),tabindex:"0"}}),a=n.createElement("div",{className:`${this.player.options.classPrefix}-volume-track`}),r=n.createElement("div",{className:`${this.player.options.classPrefix}-volume-fill`}),l=n.createElement("div",{className:`${this.player.options.classPrefix}-volume-handle`});a.appendChild(r),r.appendChild(l),s.appendChild(a),i.appendChild(s);let c=d=>{let u=a.getBoundingClientRect(),y=Math.max(0,Math.min(1,1-(d-u.top)/u.height));this.player.setVolume(y)};s.addEventListener("mousedown",d=>{d.stopPropagation(),this.isDraggingVolume=!0,c(d.clientY)}),document.addEventListener("mousemove",d=>{this.isDraggingVolume&&c(d.clientY)}),document.addEventListener("mouseup",()=>{this.isDraggingVolume=!1}),s.addEventListener("keydown",d=>{d.key==="ArrowUp"?(d.preventDefault(),this.player.setVolume(Math.min(1,this.player.state.volume+.1))):d.key==="ArrowDown"&&(d.preventDefault(),this.player.setVolume(Math.max(0,this.player.state.volume-.1)))}),i.addEventListener("click",d=>{d.stopPropagation()}),e.appendChild(i),this.controls.volumeSlider=s,this.controls.volumeFill=r,this.attachMenuCloseHandler(i,e,!0)}createTimeDisplay(){let e=n.createElement("div",{className:`${this.player.options.classPrefix}-time`});this.controls.currentTimeDisplay=n.createElement("span",{className:`${this.player.options.classPrefix}-current-time`,textContent:"00:00"});let t=n.createElement("span",{textContent:" / ",attributes:{"aria-hidden":"true"}});return this.controls.durationDisplay=n.createElement("span",{className:`${this.player.options.classPrefix}-duration`,textContent:"00:00"}),e.appendChild(this.controls.currentTimeDisplay),e.appendChild(t),e.appendChild(this.controls.durationDisplay),e}createChaptersButton(){let e=n.createElement("button",{className:`${this.player.options.classPrefix}-button ${this.player.options.classPrefix}-chapters`,attributes:{type:"button","aria-label":p.t("player.chapters"),"aria-haspopup":"menu"}});return e.appendChild(h("playlist")),e.addEventListener("click",()=>{this.showChaptersMenu(e)}),this.controls.chapters=e,e}showChaptersMenu(e){let t=document.querySelector(`.${this.player.options.classPrefix}-chapters-menu`);if(t){t.remove();return}let i=n.createElement("div",{className:`${this.player.options.classPrefix}-chapters-menu ${this.player.options.classPrefix}-menu`,attributes:{role:"menu","aria-label":p.t("player.chapters")}}),s=Array.from(this.player.element.textTracks).filter(a=>a.kind==="chapters");if(s.length===0){let a=n.createElement("div",{className:`${this.player.options.classPrefix}-menu-item`,textContent:p.t("player.noChapters"),style:{opacity:"0.5",cursor:"default"}});i.appendChild(a)}else{let a=s[0];if(a.mode==="disabled"&&(a.mode="hidden"),!a.cues||a.cues.length===0){let r=n.createElement("div",{className:`${this.player.options.classPrefix}-menu-item`,textContent:p.t("player.loadingChapters"),style:{opacity:"0.5",cursor:"default"}});i.appendChild(r);let l=()=>{i.remove(),this.showChaptersMenu(e)};a.addEventListener("load",l,{once:!0}),setTimeout(()=>{a.cues&&a.cues.length>0&&document.contains(i)&&(i.remove(),this.showChaptersMenu(e))},500)}else{let r=a.cues;for(let l=0;l<r.length;l++){let c=r[l],d=n.createElement("button",{className:`${this.player.options.classPrefix}-menu-item`,attributes:{type:"button",role:"menuitem"}}),u=n.createElement("span",{className:`${this.player.options.classPrefix}-chapter-time`,textContent:m.formatTime(c.startTime)}),y=n.createElement("span",{className:`${this.player.options.classPrefix}-chapter-title`,textContent:c.text});d.appendChild(u),d.appendChild(document.createTextNode(" ")),d.appendChild(y),d.addEventListener("click",()=>{this.player.seek(c.startTime),i.remove()}),i.appendChild(d)}}}e.appendChild(i),this.attachMenuCloseHandler(i,e)}createQualityButton(){let e=n.createElement("button",{className:`${this.player.options.classPrefix}-button ${this.player.options.classPrefix}-quality`,attributes:{type:"button","aria-label":p.t("player.quality"),"aria-haspopup":"menu"}});e.appendChild(h("hd"));let t=n.createElement("span",{className:`${this.player.options.classPrefix}-quality-text`,textContent:""});return e.appendChild(t),e.addEventListener("click",()=>{this.showQualityMenu(e)}),this.controls.quality=e,this.controls.qualityText=t,setTimeout(()=>this.updateQualityIndicator(),500),e}showQualityMenu(e){let t=document.querySelector(`.${this.player.options.classPrefix}-quality-menu`);if(t){t.remove();return}let i=n.createElement("div",{className:`${this.player.options.classPrefix}-quality-menu ${this.player.options.classPrefix}-menu`,attributes:{role:"menu","aria-label":p.t("player.quality")}});if(this.player.renderer&&this.player.renderer.getQualities){let s=this.player.renderer.getQualities(),a=this.player.renderer.getCurrentQuality?this.player.renderer.getCurrentQuality():-1,r=this.player.renderer.hls!==void 0;if(s.length===0){let l=n.createElement("div",{className:`${this.player.options.classPrefix}-menu-item`,textContent:p.t("player.autoQuality"),style:{opacity:"0.5",cursor:"default"}});i.appendChild(l)}else{if(r){let l=n.createElement("button",{className:`${this.player.options.classPrefix}-menu-item`,textContent:p.t("player.auto"),attributes:{type:"button",role:"menuitem"}});this.player.renderer.hls&&this.player.renderer.hls.currentLevel===-1&&(l.classList.add(`${this.player.options.classPrefix}-menu-item-active`),l.appendChild(h("check"))),l.addEventListener("click",()=>{this.player.renderer.switchQuality&&this.player.renderer.switchQuality(-1),i.remove()}),i.appendChild(l)}s.forEach(l=>{let c=n.createElement("button",{className:`${this.player.options.classPrefix}-menu-item`,textContent:l.name||`${l.height}p`,attributes:{type:"button",role:"menuitem"}});l.index===a&&(c.classList.add(`${this.player.options.classPrefix}-menu-item-active`),c.appendChild(h("check"))),c.addEventListener("click",()=>{this.player.renderer.switchQuality&&this.player.renderer.switchQuality(l.index),i.remove()}),i.appendChild(c)})}}else{let s=n.createElement("div",{className:`${this.player.options.classPrefix}-menu-item`,textContent:p.t("player.noQuality"),style:{opacity:"0.5",cursor:"default"}});i.appendChild(s)}e.appendChild(i),this.attachMenuCloseHandler(i,e)}createCaptionStyleButton(){let e=n.createElement("button",{className:`${this.player.options.classPrefix}-button ${this.player.options.classPrefix}-caption-style`,attributes:{type:"button","aria-label":p.t("player.captionStyling"),"aria-haspopup":"menu",title:p.t("player.captionStyling")}}),t=n.createElement("span",{textContent:"Aa",style:{fontSize:"14px",fontWeight:"bold"}});return e.appendChild(t),e.addEventListener("click",()=>{this.showCaptionStyleMenu(e)}),this.controls.captionStyle=e,e}showCaptionStyleMenu(e){let t=document.querySelector(`.${this.player.options.classPrefix}-caption-style-menu`);if(t){t.remove();return}let i=n.createElement("div",{className:`${this.player.options.classPrefix}-caption-style-menu ${this.player.options.classPrefix}-menu ${this.player.options.classPrefix}-settings-menu`,attributes:{role:"menu","aria-label":p.t("player.captionStyling")}});if(i.addEventListener("click",d=>{d.stopPropagation()}),!this.player.captionManager||this.player.captionManager.tracks.length===0){let d=n.createElement("div",{className:`${this.player.options.classPrefix}-menu-item`,textContent:p.t("player.noCaptions"),style:{opacity:"0.5",cursor:"default",padding:"12px 16px"}});i.appendChild(d),e.appendChild(i),this.attachMenuCloseHandler(i,e,!0);return}let s=this.createStyleControl("Font Size","captionsFontSize",[{label:"Small",value:"80%"},{label:"Medium",value:"100%"},{label:"Large",value:"120%"},{label:"X-Large",value:"150%"}]);i.appendChild(s);let a=this.createStyleControl("Font","captionsFontFamily",[{label:"Sans-serif",value:"sans-serif"},{label:"Serif",value:"serif"},{label:"Monospace",value:"monospace"}]);i.appendChild(a);let r=this.createColorControl("Text Color","captionsColor");i.appendChild(r);let l=this.createColorControl("Background","captionsBackgroundColor");i.appendChild(l);let c=this.createOpacityControl("Opacity","captionsOpacity");i.appendChild(c),i.style.minWidth="220px",e.appendChild(i),this.attachMenuCloseHandler(i,e,!0)}createStyleControl(e,t,i){let s=n.createElement("div",{className:`${this.player.options.classPrefix}-style-group`}),a=n.createElement("label",{textContent:e,style:{display:"block",fontSize:"12px",marginBottom:"4px",color:"rgba(255,255,255,0.7)"}});s.appendChild(a);let r=n.createElement("select",{className:`${this.player.options.classPrefix}-style-select`,style:{width:"100%",padding:"6px",background:"var(--vidply-white)",border:"1px solid var(--vidply-white-10)",borderRadius:"4px",color:"var(--vidply-black)",fontSize:"13px"}}),l=this.player.options[t];return i.forEach(c=>{let d=n.createElement("option",{textContent:c.label,attributes:{value:c.value}});c.value===l&&(d.selected=!0),r.appendChild(d)}),r.addEventListener("mousedown",c=>{c.stopPropagation()}),r.addEventListener("click",c=>{c.stopPropagation()}),r.addEventListener("change",c=>{c.stopPropagation(),this.player.options[t]=c.target.value,this.player.captionManager&&this.player.captionManager.setCaptionStyle(t.replace("captions","").charAt(0).toLowerCase()+t.replace("captions","").slice(1),c.target.value)}),s.appendChild(r),s}createColorControl(e,t){let i=n.createElement("div",{className:`${this.player.options.classPrefix}-style-group`}),s=n.createElement("label",{textContent:e,style:{display:"block",fontSize:"12px",marginBottom:"4px",color:"rgba(255,255,255,0.7)"}});i.appendChild(s);let a=n.createElement("input",{attributes:{type:"color",value:this.player.options[t]},style:{width:"100%",height:"32px",padding:"2px",background:"rgba(255,255,255,0.1)",border:"1px solid rgba(255,255,255,0.2)",borderRadius:"4px",cursor:"pointer"}});return a.addEventListener("mousedown",r=>{r.stopPropagation()}),a.addEventListener("click",r=>{r.stopPropagation()}),a.addEventListener("change",r=>{r.stopPropagation(),this.player.options[t]=r.target.value,this.player.captionManager&&this.player.captionManager.setCaptionStyle(t.replace("captions","").charAt(0).toLowerCase()+t.replace("captions","").slice(1),r.target.value)}),i.appendChild(a),i}createOpacityControl(e,t){let i=n.createElement("div",{className:`${this.player.options.classPrefix}-style-group`}),s=n.createElement("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"4px"}}),a=n.createElement("label",{textContent:e,style:{fontSize:"12px",color:"rgba(255,255,255,0.7)"}}),r=n.createElement("span",{textContent:Math.round(this.player.options[t]*100)+"%",style:{fontSize:"12px",color:"rgba(255,255,255,0.7)"}});s.appendChild(a),s.appendChild(r),i.appendChild(s);let l=n.createElement("input",{attributes:{type:"range",min:"0",max:"1",step:"0.1",value:String(this.player.options[t])},style:{width:"100%",cursor:"pointer"}});return l.addEventListener("mousedown",c=>{c.stopPropagation()}),l.addEventListener("click",c=>{c.stopPropagation()}),l.addEventListener("input",c=>{c.stopPropagation();let d=parseFloat(c.target.value);r.textContent=Math.round(d*100)+"%",this.player.options[t]=d,this.player.captionManager&&this.player.captionManager.setCaptionStyle(t.replace("captions","").charAt(0).toLowerCase()+t.replace("captions","").slice(1),d)}),i.appendChild(l),i}createSpeedButton(){let e=n.createElement("button",{className:`${this.player.options.classPrefix}-button ${this.player.options.classPrefix}-speed`,attributes:{type:"button","aria-label":p.t("player.speed"),"aria-haspopup":"menu"}});e.appendChild(h("speed"));let t=n.createElement("span",{className:`${this.player.options.classPrefix}-speed-text`,textContent:"1x"});return e.appendChild(t),e.addEventListener("click",()=>{this.showSpeedMenu(e)}),this.controls.speed=e,this.controls.speedText=t,e}showSpeedMenu(e){let t=document.querySelector(`.${this.player.options.classPrefix}-speed-menu`);if(t){t.remove();return}let i=n.createElement("div",{className:`${this.player.options.classPrefix}-speed-menu ${this.player.options.classPrefix}-menu`,attributes:{role:"menu"}});[.25,.5,.75,1,1.25,1.5,1.75,2].forEach(a=>{let r=n.createElement("button",{className:`${this.player.options.classPrefix}-menu-item`,textContent:p.t(`speeds.${a}`)||`${a}x`,attributes:{type:"button",role:"menuitem"}});a===this.player.state.playbackSpeed&&(r.classList.add(`${this.player.options.classPrefix}-menu-item-active`),r.appendChild(h("check"))),r.addEventListener("click",()=>{this.player.setPlaybackSpeed(a),i.remove()}),i.appendChild(r)}),e.appendChild(i),this.attachMenuCloseHandler(i,e)}createCaptionsButton(){let e=n.createElement("button",{className:`${this.player.options.classPrefix}-button ${this.player.options.classPrefix}-captions-button`,attributes:{type:"button","aria-label":p.t("player.captions"),"aria-pressed":"false","aria-haspopup":"menu"}});return e.appendChild(h("captionsOff")),e.addEventListener("click",()=>{this.showCaptionsMenu(e)}),this.controls.captions=e,e}showCaptionsMenu(e){let t=document.querySelector(`.${this.player.options.classPrefix}-captions-menu`);if(t){t.remove();return}let i=n.createElement("div",{className:`${this.player.options.classPrefix}-captions-menu ${this.player.options.classPrefix}-menu`,attributes:{role:"menu","aria-label":p.t("captions.select")}});if(!this.player.captionManager||this.player.captionManager.tracks.length===0){let r=n.createElement("div",{className:`${this.player.options.classPrefix}-menu-item`,textContent:p.t("player.noCaptions"),style:{opacity:"0.5",cursor:"default"}});i.appendChild(r),e.appendChild(i),this.attachMenuCloseHandler(i,e);return}let s=n.createElement("button",{className:`${this.player.options.classPrefix}-menu-item`,textContent:p.t("captions.off"),attributes:{type:"button",role:"menuitem"}});this.player.state.captionsEnabled||(s.classList.add(`${this.player.options.classPrefix}-menu-item-active`),s.appendChild(h("check"))),s.addEventListener("click",()=>{this.player.disableCaptions(),this.updateCaptionsButton(),i.remove()}),i.appendChild(s),this.player.captionManager.getAvailableTracks().forEach(r=>{let l=n.createElement("button",{className:`${this.player.options.classPrefix}-menu-item`,textContent:r.label,attributes:{type:"button",role:"menuitem",lang:r.language}});this.player.state.captionsEnabled&&this.player.captionManager.currentTrack===this.player.captionManager.tracks[r.index]&&(l.classList.add(`${this.player.options.classPrefix}-menu-item-active`),l.appendChild(h("check"))),l.addEventListener("click",()=>{this.player.captionManager.switchTrack(r.index),this.updateCaptionsButton(),i.remove()}),i.appendChild(l)}),e.appendChild(i),this.attachMenuCloseHandler(i,e)}updateCaptionsButton(){if(!this.controls.captions)return;let e=this.controls.captions.querySelector(".vidply-icon"),t=this.player.state.captionsEnabled;e.innerHTML=t?h("captions").innerHTML:h("captionsOff").innerHTML,this.controls.captions.setAttribute("aria-pressed",t?"true":"false")}createTranscriptButton(){let e=n.createElement("button",{className:`${this.player.options.classPrefix}-button ${this.player.options.classPrefix}-transcript`,attributes:{type:"button","aria-label":p.t("player.transcript"),"aria-pressed":"false"}});return e.appendChild(h("transcript")),e.addEventListener("click",()=>{this.player.transcriptManager&&(this.player.transcriptManager.toggleTranscript(),this.updateTranscriptButton())}),this.controls.transcript=e,e}updateTranscriptButton(){if(!this.controls.transcript)return;let e=this.player.transcriptManager&&this.player.transcriptManager.isVisible;this.controls.transcript.setAttribute("aria-pressed",e?"true":"false")}createAudioDescriptionButton(){let e=n.createElement("button",{className:`${this.player.options.classPrefix}-button ${this.player.options.classPrefix}-audio-description`,attributes:{type:"button","aria-label":p.t("player.audioDescription"),"aria-pressed":"false",title:p.t("player.audioDescription")}});return e.appendChild(h("audioDescription")),e.addEventListener("click",async()=>{await this.player.toggleAudioDescription(),this.updateAudioDescriptionButton()}),this.controls.audioDescription=e,e}updateAudioDescriptionButton(){if(!this.controls.audioDescription)return;let e=this.controls.audioDescription.querySelector(".vidply-icon"),t=this.player.state.audioDescriptionEnabled;e.innerHTML=t?h("audioDescriptionOn").innerHTML:h("audioDescription").innerHTML,this.controls.audioDescription.setAttribute("aria-pressed",t?"true":"false"),this.controls.audioDescription.setAttribute("aria-label",t?"Disable audio description":"Enable audio description")}createSignLanguageButton(){let e=n.createElement("button",{className:`${this.player.options.classPrefix}-button ${this.player.options.classPrefix}-sign-language`,attributes:{type:"button","aria-label":p.t("player.signLanguage"),"aria-pressed":"false",title:p.t("player.signLanguage")}});return e.appendChild(h("signLanguage")),e.addEventListener("click",()=>{this.player.toggleSignLanguage(),this.updateSignLanguageButton()}),this.controls.signLanguage=e,e}updateSignLanguageButton(){if(!this.controls.signLanguage)return;let e=this.controls.signLanguage.querySelector(".vidply-icon"),t=this.player.state.signLanguageEnabled;e.innerHTML=t?h("signLanguageOn").innerHTML:h("signLanguage").innerHTML,this.controls.signLanguage.setAttribute("aria-pressed",t?"true":"false"),this.controls.signLanguage.setAttribute("aria-label",t?"Hide sign language video":"Show sign language video")}createSettingsButton(){let e=n.createElement("button",{className:`${this.player.options.classPrefix}-button ${this.player.options.classPrefix}-settings`,attributes:{type:"button","aria-label":p.t("player.settings")}});return e.appendChild(h("settings")),e.addEventListener("click",()=>{this.player.showSettings()}),e}createPipButton(){let e=n.createElement("button",{className:`${this.player.options.classPrefix}-button ${this.player.options.classPrefix}-pip`,attributes:{type:"button","aria-label":p.t("player.pip")}});return e.appendChild(h("pip")),e.addEventListener("click",()=>{this.player.togglePiP()}),e}createFullscreenButton(){let e=n.createElement("button",{className:`${this.player.options.classPrefix}-button ${this.player.options.classPrefix}-fullscreen`,attributes:{type:"button","aria-label":p.t("player.fullscreen")}});return e.appendChild(h("fullscreen")),e.addEventListener("click",()=>{this.player.toggleFullscreen()}),this.controls.fullscreen=e,e}attachEvents(){this.player.on("play",()=>this.updatePlayPauseButton()),this.player.on("pause",()=>this.updatePlayPauseButton()),this.player.on("timeupdate",()=>this.updateProgress()),this.player.on("loadedmetadata",()=>{this.updateDuration(),this.ensureQualityButton(),this.updateQualityIndicator()}),this.player.on("volumechange",()=>this.updateVolumeDisplay()),this.player.on("progress",()=>this.updateBuffered()),this.player.on("playbackspeedchange",()=>this.updateSpeedDisplay()),this.player.on("fullscreenchange",()=>this.updateFullscreenButton()),this.player.on("captionsenabled",()=>this.updateCaptionsButton()),this.player.on("captionsdisabled",()=>this.updateCaptionsButton()),this.player.on("audiodescriptionenabled",()=>this.updateAudioDescriptionButton()),this.player.on("audiodescriptiondisabled",()=>this.updateAudioDescriptionButton()),this.player.on("signlanguageenabled",()=>this.updateSignLanguageButton()),this.player.on("signlanguagedisabled",()=>this.updateSignLanguageButton()),this.player.on("qualitychange",()=>this.updateQualityIndicator()),this.player.on("hlslevelswitched",()=>this.updateQualityIndicator()),this.player.on("hlsmanifestparsed",()=>{this.ensureQualityButton(),this.updateQualityIndicator()})}updatePlayPauseButton(){if(!this.controls.playPause)return;let e=this.controls.playPause.querySelector(".vidply-icon"),t=this.player.state.playing;e.innerHTML=t?h("pause").innerHTML:h("play").innerHTML,this.controls.playPause.setAttribute("aria-label",t?p.t("player.pause"):p.t("player.play"))}updateProgress(){if(!this.controls.played)return;let e=this.player.state.currentTime/this.player.state.duration*100;this.controls.played.style.width=`${e}%`,this.controls.progress.setAttribute("aria-valuenow",String(Math.round(e))),this.controls.currentTimeDisplay&&(this.controls.currentTimeDisplay.textContent=m.formatTime(this.player.state.currentTime))}updateDuration(){this.controls.durationDisplay&&(this.controls.durationDisplay.textContent=m.formatTime(this.player.state.duration))}updateVolumeDisplay(){if(!this.controls.volumeFill)return;let e=this.player.state.volume*100;if(this.controls.volumeFill.style.height=`${e}%`,this.controls.mute){let t=this.controls.mute.querySelector(".vidply-icon"),i;this.player.state.muted||this.player.state.volume===0?i="volumeMuted":this.player.state.volume<.3?i="volumeLow":this.player.state.volume<.7?i="volumeMedium":i="volumeHigh",t.innerHTML=h(i).innerHTML,this.controls.mute.setAttribute("aria-label",this.player.state.muted?p.t("player.unmute"):p.t("player.mute"))}this.controls.volumeSlider&&this.controls.volumeSlider.setAttribute("aria-valuenow",String(Math.round(e)))}updateBuffered(){if(!this.controls.buffered||!this.player.element.buffered||this.player.element.buffered.length===0)return;let t=this.player.element.buffered.end(this.player.element.buffered.length-1)/this.player.state.duration*100;this.controls.buffered.style.width=`${t}%`}updateSpeedDisplay(){this.controls.speedText&&(this.controls.speedText.textContent=`${this.player.state.playbackSpeed}x`)}updateFullscreenButton(){if(!this.controls.fullscreen)return;let e=this.controls.fullscreen.querySelector(".vidply-icon"),t=this.player.state.fullscreen;e.innerHTML=t?h("fullscreenExit").innerHTML:h("fullscreen").innerHTML,this.controls.fullscreen.setAttribute("aria-label",t?p.t("player.exitFullscreen"):p.t("player.fullscreen"))}ensureQualityButton(){if(!this.player.options.qualityButton||this.controls.quality||!this.hasQualityLevels())return;let e=this.createQualityButton(),t=this.rightButtons.querySelector(`.${this.player.options.classPrefix}-speed`),s=this.rightButtons.querySelector(`.${this.player.options.classPrefix}-caption-style`)||t;s?this.rightButtons.insertBefore(e,s):this.rightButtons.insertBefore(e,this.rightButtons.firstChild),this.player.log("Quality button added dynamically","info")}updateQualityIndicator(){if(!this.controls.qualityText||!this.player.renderer||!this.player.renderer.getQualities)return;let e=this.player.renderer.getQualities();if(e.length===0){this.controls.qualityText.textContent="";return}let t="";if(this.player.renderer.hls&&this.player.renderer.hls.currentLevel===-1)t="Auto";else if(this.player.renderer.getCurrentQuality){let i=this.player.renderer.getCurrentQuality(),s=e.find(a=>a.index===i);s&&(t=s.height?`${s.height}p`:"")}this.controls.qualityText.textContent=t}setupAutoHide(){if(this.player.element.tagName!=="VIDEO")return;let e=()=>{this.element.classList.add(`${this.player.options.classPrefix}-controls-visible`),this.player.state.controlsVisible=!0,clearTimeout(this.hideTimeout),this.player.state.playing&&(this.hideTimeout=setTimeout(()=>{this.element.classList.remove(`${this.player.options.classPrefix}-controls-visible`),this.player.state.controlsVisible=!1},this.player.options.hideControlsDelay))};this.player.container.addEventListener("mousemove",e),this.player.container.addEventListener("touchstart",e),this.player.container.addEventListener("click",e),this.element.addEventListener("focusin",e),this.player.on("pause",()=>{e(),clearTimeout(this.hideTimeout)}),this.player.on("play",()=>{e()}),e()}show(){this.element.style.display=""}hide(){this.element.style.display="none"}destroy(){this.hideTimeout&&clearTimeout(this.hideTimeout),this.element&&this.element.parentNode&&this.element.parentNode.removeChild(this.element)}};var f=class{constructor(e){this.player=e,this.element=null,this.tracks=[],this.currentTrack=null,this.currentCue=null,this.init()}init(){this.createElement(),this.loadTracks(),this.attachEvents(),this.player.options.captionsDefault&&this.tracks.length>0&&this.enable()}createElement(){this.element=n.createElement("div",{className:`${this.player.options.classPrefix}-captions`,attributes:{"aria-live":"polite","aria-atomic":"true",role:"region","aria-label":p.t("player.captions")}}),this.updateStyles(),(this.player.videoWrapper||this.player.container).appendChild(this.element)}loadTracks(){let e=this.player.element.textTracks;for(let t=0;t<e.length;t++){let i=e[t];(i.kind==="subtitles"||i.kind==="captions")&&(this.tracks.push({track:i,language:i.language,label:i.label,kind:i.kind,index:t}),i.mode="hidden")}}attachEvents(){this.player.on("timeupdate",()=>{this.updateCaptions()}),this.player.on("captionschange",()=>{this.updateStyles()})}enable(e=0){if(this.tracks.length===0)return;this.currentTrack&&(this.currentTrack.track.mode="hidden");let t=this.tracks[e];t&&(t.track.mode="hidden",this.currentTrack=t,this.player.state.captionsEnabled=!0,this.cueChangeHandler&&t.track.removeEventListener("cuechange",this.cueChangeHandler),this.cueChangeHandler=()=>{this.updateCaptions()},t.track.addEventListener("cuechange",this.cueChangeHandler),this.element.style.display="block",this.player.emit("captionsenabled",t))}disable(){this.currentTrack&&(this.currentTrack.track.mode="hidden",this.currentTrack=null),this.element.style.display="none",this.element.innerHTML="",this.currentCue=null,this.player.state.captionsEnabled=!1,this.player.emit("captionsdisabled")}updateCaptions(){if(!this.currentTrack||!this.currentTrack.track.activeCues)return;let e=this.currentTrack.track.activeCues;if(e.length>0){let t=e[0];if(this.currentCue!==t){this.currentCue=t;let i=t.text;i=this.parseVTTFormatting(i),this.element.innerHTML=n.sanitizeHTML(i),this.element.style.display="block",this.player.emit("captionchange",t)}}else this.currentCue&&(this.element.innerHTML="",this.element.style.display="none",this.currentCue=null)}parseVTTFormatting(e){return e=e.replace(/<c[^>]*>(.*?)<\/c>/g,'<span class="caption-class">$1</span>'),e=e.replace(/<b>(.*?)<\/b>/g,"<strong>$1</strong>"),e=e.replace(/<i>(.*?)<\/i>/g,"<em>$1</em>"),e=e.replace(/<u>(.*?)<\/u>/g,"<u>$1</u>"),e=e.replace(/<v\s+([^>]+)>(.*?)<\/v>/g,'<span class="caption-voice" data-voice="$1">$2</span>'),e}updateStyles(){if(!this.element)return;let e=this.player.options;this.element.style.fontSize=e.captionsFontSize,this.element.style.fontFamily=e.captionsFontFamily,this.element.style.color=e.captionsColor,this.element.style.backgroundColor=this.hexToRgba(e.captionsBackgroundColor,e.captionsOpacity)}hexToRgba(e,t){let i=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return i?`rgba(${parseInt(i[1],16)}, ${parseInt(i[2],16)}, ${parseInt(i[3],16)}, ${t})`:e}setCaptionStyle(e,t){switch(e){case"fontSize":this.player.options.captionsFontSize=t;break;case"fontFamily":this.player.options.captionsFontFamily=t;break;case"color":this.player.options.captionsColor=t;break;case"backgroundColor":this.player.options.captionsBackgroundColor=t;break;case"opacity":this.player.options.captionsOpacity=t;break}this.updateStyles(),this.player.emit("captionschange")}getAvailableTracks(){return this.tracks.map((e,t)=>({index:t,language:e.language,label:e.label||e.language,kind:e.kind}))}switchTrack(e){e>=0&&e<this.tracks.length&&(this.disable(),this.enable(e))}destroy(){this.disable(),this.element&&this.element.parentNode&&this.element.parentNode.removeChild(this.element)}};var C=class{constructor(e){this.player=e,this.shortcuts=e.options.keyboardShortcuts,this.init()}init(){this.attachEvents()}attachEvents(){this.player.container.addEventListener("keydown",e=>{this.handleKeydown(e)}),this.player.container.hasAttribute("tabindex")||this.player.container.setAttribute("tabindex","0")}handleKeydown(e){if(e.target.tagName==="INPUT"||e.target.tagName==="TEXTAREA"||e.target.tagName==="SELECT")return;let t=e.key,i=!1;for(let[s,a]of Object.entries(this.shortcuts))if(a.includes(t)&&(i=this.executeAction(s,e),i)){e.preventDefault(),e.stopPropagation(),this.announceAction(s);break}}executeAction(e,t){switch(e){case"play-pause":return this.player.toggle(),!0;case"volume-up":return this.player.setVolume(Math.min(1,this.player.state.volume+.1)),!0;case"volume-down":return this.player.setVolume(Math.max(0,this.player.state.volume-.1)),!0;case"seek-forward":return this.player.seekForward(),!0;case"seek-backward":return this.player.seekBackward(),!0;case"seek-forward-large":return this.player.seekForward(this.player.options.seekIntervalLarge),!0;case"seek-backward-large":return this.player.seekBackward(this.player.options.seekIntervalLarge),!0;case"mute":return this.player.toggleMute(),!0;case"fullscreen":return this.player.toggleFullscreen(),!0;case"captions":if(this.player.captionManager&&this.player.captionManager.tracks.length>1){let i=document.querySelector(".vidply-captions");i&&this.player.controlBar&&this.player.controlBar.showCaptionsMenu(i)}else this.player.toggleCaptions();return!0;case"speed-up":return this.player.setPlaybackSpeed(Math.min(2,this.player.state.playbackSpeed+.25)),!0;case"speed-down":return this.player.setPlaybackSpeed(Math.max(.25,this.player.state.playbackSpeed-.25)),!0;case"settings":return this.player.showSettings(),!0;default:return!1}}announceAction(e){if(!this.player.options.screenReaderAnnouncements)return;let t="";switch(e){case"play-pause":t=this.player.state.playing?"Playing":"Paused";break;case"volume-up":t=`Volume ${Math.round(this.player.state.volume*100)}%`;break;case"volume-down":t=`Volume ${Math.round(this.player.state.volume*100)}%`;break;case"mute":t=this.player.state.muted?"Muted":"Unmuted";break;case"fullscreen":t=this.player.state.fullscreen?"Fullscreen":"Exit fullscreen";break;case"captions":t=this.player.state.captionsEnabled?"Captions on":"Captions off";break;case"speed-up":case"speed-down":t=`Speed ${this.player.state.playbackSpeed}x`;break}t&&this.announce(t)}announce(e,t="polite"){let i=document.getElementById("vidply-announcer");i||(i=document.createElement("div"),i.id="vidply-announcer",i.className="vidply-sr-only",i.setAttribute("aria-live",t),i.setAttribute("aria-atomic","true"),i.style.cssText=`
        position: absolute;
        left: -10000px;
        width: 1px;
        height: 1px;
        overflow: hidden;
      `,document.body.appendChild(i)),i.textContent="",setTimeout(()=>{i.textContent=e},100)}updateShortcut(e,t){Array.isArray(t)&&(this.shortcuts[e]=t)}destroy(){}};var x=class{constructor(e){this.player=e,this.element=null,this.isOpen=!1,this.init()}init(){this.createElement()}createElement(){this.overlay=n.createElement("div",{className:`${this.player.options.classPrefix}-settings-overlay`,attributes:{role:"dialog","aria-modal":"true","aria-label":p.t("settings.title")}}),this.overlay.style.display="none",this.element=n.createElement("div",{className:`${this.player.options.classPrefix}-settings-dialog`});let e=n.createElement("div",{className:`${this.player.options.classPrefix}-settings-header`}),t=n.createElement("h2",{textContent:p.t("settings.title"),attributes:{id:`${this.player.options.classPrefix}-settings-title`}}),i=n.createElement("button",{className:`${this.player.options.classPrefix}-button ${this.player.options.classPrefix}-settings-close`,attributes:{type:"button","aria-label":p.t("settings.close")}});i.appendChild(h("close")),i.addEventListener("click",()=>this.hide()),e.appendChild(t),e.appendChild(i);let s=n.createElement("div",{className:`${this.player.options.classPrefix}-settings-content`});s.appendChild(this.createSpeedSettings()),this.player.captionManager&&this.player.captionManager.tracks.length>0&&s.appendChild(this.createCaptionSettings());let a=n.createElement("div",{className:`${this.player.options.classPrefix}-settings-footer`}),r=n.createElement("button",{className:`${this.player.options.classPrefix}-button`,textContent:p.t("settings.reset"),attributes:{type:"button"}});r.addEventListener("click",()=>this.resetSettings()),a.appendChild(r),this.element.appendChild(e),this.element.appendChild(s),this.element.appendChild(a),this.overlay.appendChild(this.element),this.player.container.appendChild(this.overlay),this.overlay.addEventListener("click",l=>{l.target===this.overlay&&this.hide()}),document.addEventListener("keydown",l=>{l.key==="Escape"&&this.isOpen&&this.hide()})}createSpeedSettings(){let e=n.createElement("div",{className:`${this.player.options.classPrefix}-settings-section`}),t=n.createElement("label",{textContent:p.t("settings.speed"),attributes:{for:`${this.player.options.classPrefix}-speed-select`}}),i=n.createElement("select",{className:`${this.player.options.classPrefix}-settings-select`,attributes:{id:`${this.player.options.classPrefix}-speed-select`}});return[.25,.5,.75,1,1.25,1.5,1.75,2].forEach(a=>{let r=n.createElement("option",{textContent:p.t(`speeds.${a}`)||`${a}x`,attributes:{value:String(a)}});a===this.player.state.playbackSpeed&&(r.selected=!0),i.appendChild(r)}),i.addEventListener("change",a=>{this.player.setPlaybackSpeed(parseFloat(a.target.value))}),e.appendChild(t),e.appendChild(i),e}createCaptionSettings(){let e=n.createElement("div",{className:`${this.player.options.classPrefix}-settings-section`}),t=n.createElement("h3",{textContent:p.t("settings.captions")});e.appendChild(t);let i=n.createElement("label",{textContent:p.t("captions.select"),attributes:{for:`${this.player.options.classPrefix}-caption-track-select`}}),s=n.createElement("select",{className:`${this.player.options.classPrefix}-settings-select`,attributes:{id:`${this.player.options.classPrefix}-caption-track-select`}}),a=n.createElement("option",{textContent:p.t("captions.off"),attributes:{value:"-1"}});return s.appendChild(a),this.player.captionManager.getAvailableTracks().forEach(l=>{let c=n.createElement("option",{textContent:l.label,attributes:{value:String(l.index)}});s.appendChild(c)}),s.addEventListener("change",l=>{let c=parseInt(l.target.value);c===-1?this.player.disableCaptions():this.player.captionManager.switchTrack(c)}),e.appendChild(i),e.appendChild(s),e.appendChild(this.createCaptionStyleControl("fontSize",p.t("captions.fontSize"),[{label:"Small",value:"80%"},{label:"Medium",value:"100%"},{label:"Large",value:"120%"},{label:"X-Large",value:"150%"}])),e.appendChild(this.createCaptionStyleControl("fontFamily",p.t("captions.fontFamily"),[{label:"Sans-serif",value:"sans-serif"},{label:"Serif",value:"serif"},{label:"Monospace",value:"monospace"}])),e.appendChild(this.createColorControl("color",p.t("captions.color"))),e.appendChild(this.createColorControl("backgroundColor",p.t("captions.backgroundColor"))),e.appendChild(this.createRangeControl("opacity",p.t("captions.opacity"),0,1,.1)),e}createCaptionStyleControl(e,t,i){let s=n.createElement("div",{className:`${this.player.options.classPrefix}-settings-control`}),a=n.createElement("label",{textContent:t,attributes:{for:`${this.player.options.classPrefix}-caption-${e}`}}),r=n.createElement("select",{className:`${this.player.options.classPrefix}-settings-select`,attributes:{id:`${this.player.options.classPrefix}-caption-${e}`}});return i.forEach(l=>{let c=n.createElement("option",{textContent:l.label,attributes:{value:l.value}});l.value===this.player.options[`captions${e.charAt(0).toUpperCase()+e.slice(1)}`]&&(c.selected=!0),r.appendChild(c)}),r.addEventListener("change",l=>{this.player.captionManager.setCaptionStyle(e,l.target.value)}),s.appendChild(a),s.appendChild(r),s}createColorControl(e,t){let i=n.createElement("div",{className:`${this.player.options.classPrefix}-settings-control`}),s=n.createElement("label",{textContent:t,attributes:{for:`${this.player.options.classPrefix}-caption-${e}`}}),a=n.createElement("input",{className:`${this.player.options.classPrefix}-settings-color`,attributes:{type:"color",id:`${this.player.options.classPrefix}-caption-${e}`,value:this.player.options[`captions${e.charAt(0).toUpperCase()+e.slice(1)}`]}});return a.addEventListener("change",r=>{this.player.captionManager.setCaptionStyle(e,r.target.value)}),i.appendChild(s),i.appendChild(a),i}createRangeControl(e,t,i,s,a){let r=n.createElement("div",{className:`${this.player.options.classPrefix}-settings-control`}),l=n.createElement("label",{textContent:t,attributes:{for:`${this.player.options.classPrefix}-caption-${e}`}}),c=n.createElement("input",{className:`${this.player.options.classPrefix}-settings-range`,attributes:{type:"range",id:`${this.player.options.classPrefix}-caption-${e}`,min:String(i),max:String(s),step:String(a),value:String(this.player.options[`captions${e.charAt(0).toUpperCase()+e.slice(1)}`])}}),d=n.createElement("span",{className:`${this.player.options.classPrefix}-settings-value`,textContent:String(this.player.options[`captions${e.charAt(0).toUpperCase()+e.slice(1)}`])});return c.addEventListener("input",u=>{let y=parseFloat(u.target.value);d.textContent=y.toFixed(1),this.player.captionManager.setCaptionStyle(e,y)}),r.appendChild(l),r.appendChild(c),r.appendChild(d),r}resetSettings(){this.player.setPlaybackSpeed(1),this.player.captionManager&&(this.player.captionManager.setCaptionStyle("fontSize","100%"),this.player.captionManager.setCaptionStyle("fontFamily","sans-serif"),this.player.captionManager.setCaptionStyle("color","#FFFFFF"),this.player.captionManager.setCaptionStyle("backgroundColor","#000000"),this.player.captionManager.setCaptionStyle("opacity",.8)),this.hide(),setTimeout(()=>this.show(),100)}show(){this.overlay.style.display="flex",this.isOpen=!0;let e=this.element.querySelector(`.${this.player.options.classPrefix}-settings-close`);e&&e.focus(),this.player.emit("settingsopen")}hide(){this.overlay.style.display="none",this.isOpen=!1,this.player.container.focus(),this.player.emit("settingsclose")}destroy(){this.overlay&&this.overlay.parentNode&&this.overlay.parentNode.removeChild(this.overlay)}};var k=class{constructor(e){this.player=e,this.transcriptWindow=null,this.transcriptEntries=[],this.currentActiveEntry=null,this.isVisible=!1,this.isDragging=!1,this.dragOffsetX=0,this.dragOffsetY=0,this.handlers={timeupdate:()=>this.updateActiveEntry(),resize:null,mousemove:null,mouseup:null,touchmove:null,touchend:null,mousedown:null,touchstart:null,keydown:null},this.init()}init(){this.player.on("timeupdate",this.handlers.timeupdate),this.player.on("fullscreenchange",()=>{this.isVisible&&setTimeout(()=>this.positionTranscript(),100)})}toggleTranscript(){this.isVisible?this.hideTranscript():this.showTranscript()}showTranscript(){if(this.transcriptWindow){this.transcriptWindow.style.display="flex",this.isVisible=!0;return}this.createTranscriptWindow(),this.loadTranscriptData(),this.transcriptWindow&&(this.transcriptWindow.style.display="flex",setTimeout(()=>this.positionTranscript(),0)),this.isVisible=!0}hideTranscript(){this.transcriptWindow&&(this.transcriptWindow.style.display="none",this.isVisible=!1)}createTranscriptWindow(){this.transcriptWindow=n.createElement("div",{className:`${this.player.options.classPrefix}-transcript-window`,attributes:{role:"dialog","aria-label":"Video Transcript",tabindex:"-1"}}),this.transcriptHeader=n.createElement("div",{className:`${this.player.options.classPrefix}-transcript-header`,attributes:{"aria-label":"Drag to reposition transcript. Use arrow keys to move, Home to reset position, Escape to close.",tabindex:"0"}});let e=n.createElement("h3",{textContent:"Transcript"}),t=n.createElement("button",{className:`${this.player.options.classPrefix}-transcript-close`,attributes:{type:"button","aria-label":"Close transcript"}});t.appendChild(h("close")),t.addEventListener("click",()=>this.hideTranscript()),this.transcriptHeader.appendChild(e),this.transcriptHeader.appendChild(t),this.transcriptContent=n.createElement("div",{className:`${this.player.options.classPrefix}-transcript-content`}),this.transcriptWindow.appendChild(this.transcriptHeader),this.transcriptWindow.appendChild(this.transcriptContent),this.player.container.appendChild(this.transcriptWindow),this.positionTranscript(),this.setupDragAndDrop();let i;this.handlers.resize=()=>{clearTimeout(i),i=setTimeout(()=>this.positionTranscript(),100)},window.addEventListener("resize",this.handlers.resize)}positionTranscript(){if(!this.transcriptWindow||!this.player.videoWrapper||!this.isVisible)return;let e=window.innerWidth<640,t=this.player.videoWrapper.getBoundingClientRect(),i=this.player.state.fullscreen;e&&!i?(this.transcriptWindow.style.position="relative",this.transcriptWindow.style.left="0",this.transcriptWindow.style.right="0",this.transcriptWindow.style.bottom="auto",this.transcriptWindow.style.top="auto",this.transcriptWindow.style.width="100%",this.transcriptWindow.style.maxWidth="100%",this.transcriptWindow.style.maxHeight="400px",this.transcriptWindow.style.height="auto",this.transcriptWindow.style.borderRadius="0",this.transcriptWindow.style.transform="none",this.transcriptWindow.style.border="none",this.transcriptWindow.style.borderTop="1px solid var(--vidply-border-light)",this.transcriptWindow.style.boxShadow="none",this.transcriptHeader&&(this.transcriptHeader.style.cursor="default"),this.transcriptWindow.parentNode!==this.player.container&&this.player.container.appendChild(this.transcriptWindow)):i?(this.transcriptWindow.style.position="fixed",this.transcriptWindow.style.left="auto",this.transcriptWindow.style.right="20px",this.transcriptWindow.style.bottom="80px",this.transcriptWindow.style.top="auto",this.transcriptWindow.style.maxHeight="calc(100vh - 180px)",this.transcriptWindow.style.height="auto",this.transcriptWindow.style.width="400px",this.transcriptWindow.style.maxWidth="400px",this.transcriptWindow.style.borderRadius="8px",this.transcriptWindow.style.border="1px solid var(--vidply-border)",this.transcriptWindow.style.borderTop="",this.transcriptWindow.parentNode!==this.player.container&&this.player.container.appendChild(this.transcriptWindow)):(this.transcriptWindow.style.position="absolute",this.transcriptWindow.style.left=`${t.width+8}px`,this.transcriptWindow.style.right="auto",this.transcriptWindow.style.bottom="auto",this.transcriptWindow.style.top="0",this.transcriptWindow.style.height=`${t.height}px`,this.transcriptWindow.style.maxHeight="none",this.transcriptWindow.style.width="400px",this.transcriptWindow.style.maxWidth="400px",this.transcriptWindow.style.borderRadius="8px",this.transcriptWindow.style.border="1px solid var(--vidply-border)",this.transcriptWindow.style.borderTop="",this.transcriptHeader&&(this.transcriptHeader.style.cursor="move"),this.transcriptWindow.parentNode!==this.player.container&&this.player.container.appendChild(this.transcriptWindow))}loadTranscriptData(){this.transcriptEntries=[],this.transcriptContent.innerHTML="";let t=Array.from(this.player.element.textTracks).find(s=>s.kind==="captions"||s.kind==="subtitles");if(!t){this.showNoTranscriptMessage();return}if(t.mode==="disabled"&&(t.mode="hidden"),!t.cues||t.cues.length===0){let s=n.createElement("div",{className:`${this.player.options.classPrefix}-transcript-loading`,textContent:"Loading transcript..."});this.transcriptContent.appendChild(s);let a=()=>{this.loadTranscriptData()};t.addEventListener("load",a,{once:!0}),setTimeout(()=>{t.cues&&t.cues.length>0&&this.loadTranscriptData()},500);return}Array.from(t.cues).forEach((s,a)=>{let r=this.createTranscriptEntry(s,a);this.transcriptEntries.push({element:r,cue:s,startTime:s.startTime,endTime:s.endTime}),this.transcriptContent.appendChild(r)})}createTranscriptEntry(e,t){let i=n.createElement("div",{className:`${this.player.options.classPrefix}-transcript-entry`,attributes:{"data-start":String(e.startTime),"data-end":String(e.endTime),role:"button",tabindex:"0"}}),s=n.createElement("span",{className:`${this.player.options.classPrefix}-transcript-time`,textContent:m.formatTime(e.startTime)}),a=n.createElement("span",{className:`${this.player.options.classPrefix}-transcript-text`,textContent:this.stripVTTFormatting(e.text)});i.appendChild(s),i.appendChild(a);let r=()=>{this.player.seek(e.startTime),this.player.state.paused&&this.player.play()};return i.addEventListener("click",r),i.addEventListener("keydown",l=>{(l.key==="Enter"||l.key===" ")&&(l.preventDefault(),r())}),i}stripVTTFormatting(e){return e.replace(/<[^>]+>/g,"").replace(/\n/g," ").trim()}showNoTranscriptMessage(){let e=n.createElement("div",{className:`${this.player.options.classPrefix}-transcript-empty`,textContent:"No transcript available for this video."});this.transcriptContent.appendChild(e)}updateActiveEntry(){if(!this.isVisible||this.transcriptEntries.length===0)return;let e=this.player.state.currentTime,t=this.transcriptEntries.find(i=>e>=i.startTime&&e<i.endTime);t&&t!==this.currentActiveEntry?(this.currentActiveEntry&&this.currentActiveEntry.element.classList.remove(`${this.player.options.classPrefix}-transcript-entry-active`),t.element.classList.add(`${this.player.options.classPrefix}-transcript-entry-active`),this.scrollToEntry(t.element),this.currentActiveEntry=t):!t&&this.currentActiveEntry&&(this.currentActiveEntry.element.classList.remove(`${this.player.options.classPrefix}-transcript-entry-active`),this.currentActiveEntry=null)}scrollToEntry(e){if(!this.transcriptContent)return;let t=this.transcriptContent.getBoundingClientRect(),i=e.getBoundingClientRect();if(i.top<t.top||i.bottom>t.bottom){let s=e.offsetTop-this.transcriptContent.clientHeight/2+e.clientHeight/2;this.transcriptContent.scrollTo({top:s,behavior:"smooth"})}}setupDragAndDrop(){!this.transcriptHeader||!this.transcriptWindow||(this.handlers.mousedown=e=>{e.target.closest(`.${this.player.options.classPrefix}-transcript-close`)||(this.startDragging(e.clientX,e.clientY),e.preventDefault())},this.handlers.mousemove=e=>{this.isDragging&&this.drag(e.clientX,e.clientY)},this.handlers.mouseup=()=>{this.isDragging&&this.stopDragging()},this.handlers.touchstart=e=>{if(e.target.closest(`.${this.player.options.classPrefix}-transcript-close`))return;let t=window.innerWidth<640,i=this.player.state.fullscreen,s=e.touches[0];t&&!i||this.startDragging(s.clientX,s.clientY)},this.handlers.touchmove=e=>{let t=window.innerWidth<640,i=this.player.state.fullscreen;if(!(t&&!i)&&this.isDragging){let s=e.touches[0];this.drag(s.clientX,s.clientY),e.preventDefault()}},this.handlers.touchend=()=>{this.isDragging&&this.stopDragging()},this.handlers.keydown=e=>{if(!["ArrowLeft","ArrowRight","ArrowUp","ArrowDown","Home","Escape"].includes(e.key))return;if(e.preventDefault(),e.stopPropagation(),e.key==="Home"){this.resetPosition();return}if(e.key==="Escape"){this.hideTranscript();return}let t=e.shiftKey?50:10,i=parseFloat(this.transcriptWindow.style.left)||0,s=parseFloat(this.transcriptWindow.style.top)||0;if(window.getComputedStyle(this.transcriptWindow).transform!=="none"){let c=this.transcriptWindow.getBoundingClientRect();i=c.left,s=c.top,this.transcriptWindow.style.transform="none",this.transcriptWindow.style.left=`${i}px`,this.transcriptWindow.style.top=`${s}px`}let r=i,l=s;switch(e.key){case"ArrowLeft":r-=t;break;case"ArrowRight":r+=t;break;case"ArrowUp":l-=t;break;case"ArrowDown":l+=t;break}this.transcriptWindow.style.left=`${r}px`,this.transcriptWindow.style.top=`${l}px`},this.transcriptHeader.addEventListener("mousedown",this.handlers.mousedown),document.addEventListener("mousemove",this.handlers.mousemove),document.addEventListener("mouseup",this.handlers.mouseup),this.transcriptHeader.addEventListener("touchstart",this.handlers.touchstart),document.addEventListener("touchmove",this.handlers.touchmove),document.addEventListener("touchend",this.handlers.touchend),this.transcriptHeader.addEventListener("keydown",this.handlers.keydown))}startDragging(e,t){let i=this.transcriptWindow.getBoundingClientRect(),s=this.player.container.getBoundingClientRect(),a=i.left-s.left,r=i.top-s.top;window.getComputedStyle(this.transcriptWindow).transform!=="none"&&(this.transcriptWindow.style.transform="none",this.transcriptWindow.style.left=`${a}px`,this.transcriptWindow.style.top=`${r}px`),this.dragOffsetX=e-i.left,this.dragOffsetY=t-i.top,this.isDragging=!0,this.transcriptWindow.classList.add(`${this.player.options.classPrefix}-transcript-dragging`),document.body.style.cursor="grabbing",document.body.style.userSelect="none"}drag(e,t){if(!this.isDragging)return;let i=e-this.dragOffsetX,s=t-this.dragOffsetY,a=this.player.container.getBoundingClientRect(),r=i-a.left,l=s-a.top;this.transcriptWindow.style.left=`${r}px`,this.transcriptWindow.style.top=`${l}px`}stopDragging(){this.isDragging=!1,this.transcriptWindow.classList.remove(`${this.player.options.classPrefix}-transcript-dragging`),document.body.style.cursor="",document.body.style.userSelect=""}setPosition(e,t){let i=this.transcriptWindow.getBoundingClientRect(),s=document.documentElement.clientWidth,a=document.documentElement.clientHeight,r=100,l=-(i.width-r),c=-(i.height-r),d=s-r,u=a-r;e=Math.max(l,Math.min(e,d)),t=Math.max(c,Math.min(t,u)),this.transcriptWindow.style.left=`${e}px`,this.transcriptWindow.style.top=`${t}px`,this.transcriptWindow.style.transform="none"}resetPosition(){this.transcriptWindow.style.left="50%",this.transcriptWindow.style.top="50%",this.transcriptWindow.style.transform="translate(-50%, -50%)"}destroy(){this.handlers.timeupdate&&this.player.off("timeupdate",this.handlers.timeupdate),this.transcriptHeader&&(this.handlers.mousedown&&this.transcriptHeader.removeEventListener("mousedown",this.handlers.mousedown),this.handlers.touchstart&&this.transcriptHeader.removeEventListener("touchstart",this.handlers.touchstart),this.handlers.keydown&&this.transcriptHeader.removeEventListener("keydown",this.handlers.keydown)),this.handlers.mousemove&&document.removeEventListener("mousemove",this.handlers.mousemove),this.handlers.mouseup&&document.removeEventListener("mouseup",this.handlers.mouseup),this.handlers.touchmove&&document.removeEventListener("touchmove",this.handlers.touchmove),this.handlers.touchend&&document.removeEventListener("touchend",this.handlers.touchend),this.handlers.resize&&window.removeEventListener("resize",this.handlers.resize),this.handlers=null,this.transcriptWindow&&this.transcriptWindow.parentNode&&this.transcriptWindow.parentNode.removeChild(this.transcriptWindow),this.transcriptWindow=null,this.transcriptHeader=null,this.transcriptContent=null,this.transcriptEntries=[]}};V();var L=class{constructor(e){this.player=e,this.youtube=null,this.videoId=null,this.isReady=!1,this.iframe=null}async init(){if(this.videoId=this.extractVideoId(this.player.element.src),!this.videoId)throw new Error("Invalid YouTube URL");await this.loadYouTubeAPI(),this.createIframe(),await this.initializePlayer()}extractVideoId(e){let t=[/(?:youtube\.com\/watch\?v=|youtu\.be\/)([^&\s]+)/,/youtube\.com\/embed\/([^&\s]+)/];for(let i of t){let s=e.match(i);if(s&&s[1])return s[1]}return null}async loadYouTubeAPI(){return window.YT&&window.YT.Player?Promise.resolve():new Promise((e,t)=>{if(window.onYouTubeIframeAPIReady){let a=window.onYouTubeIframeAPIReady;window.onYouTubeIframeAPIReady=()=>{a(),e()};return}let i=document.createElement("script");i.src="https://www.youtube.com/iframe_api",window.onYouTubeIframeAPIReady=()=>{e()},i.onerror=()=>t(new Error("Failed to load YouTube API"));let s=document.getElementsByTagName("script")[0];s.parentNode.insertBefore(i,s)})}createIframe(){this.player.element.style.display="none",this.iframe=document.createElement("div"),this.iframe.id=`youtube-player-${Math.random().toString(36).substr(2,9)}`,this.iframe.style.width="100%",this.iframe.style.height="100%",this.player.element.parentNode.insertBefore(this.iframe,this.player.element)}async initializePlayer(){return new Promise(e=>{this.youtube=new window.YT.Player(this.iframe.id,{videoId:this.videoId,width:"100%",height:"100%",playerVars:{controls:0,disablekb:1,fs:0,modestbranding:1,rel:0,showinfo:0,iv_load_policy:3,autoplay:this.player.options.autoplay?1:0,mute:this.player.options.muted?1:0,start:this.player.options.startTime||0},events:{onReady:t=>{this.isReady=!0,this.attachEvents(),e()},onStateChange:t=>this.handleStateChange(t),onError:t=>this.handleError(t)}})})}attachEvents(){this.timeUpdateInterval=setInterval(()=>{if(this.isReady&&this.youtube){let e=this.youtube.getCurrentTime(),t=this.youtube.getDuration();this.player.state.currentTime=e,this.player.state.duration=t,this.player.emit("timeupdate",e)}},250),this.youtube.getDuration&&(this.player.state.duration=this.youtube.getDuration(),this.player.emit("loadedmetadata"))}handleStateChange(e){let t=window.YT.PlayerState;switch(e.data){case t.PLAYING:this.player.state.playing=!0,this.player.state.paused=!1,this.player.state.ended=!1,this.player.state.buffering=!1,this.player.emit("play"),this.player.emit("playing"),this.player.options.onPlay&&this.player.options.onPlay.call(this.player);break;case t.PAUSED:this.player.state.playing=!1,this.player.state.paused=!0,this.player.emit("pause"),this.player.options.onPause&&this.player.options.onPause.call(this.player);break;case t.ENDED:this.player.state.playing=!1,this.player.state.paused=!0,this.player.state.ended=!0,this.player.emit("ended"),this.player.options.onEnded&&this.player.options.onEnded.call(this.player),this.player.options.loop&&(this.youtube.seekTo(0),this.youtube.playVideo());break;case t.BUFFERING:this.player.state.buffering=!0,this.player.emit("waiting");break;case t.CUED:this.player.emit("loadedmetadata");break}}handleError(e){let t={2:"Invalid video ID",5:"HTML5 player error",100:"Video not found",101:"Video not allowed to be played in embedded players",150:"Video not allowed to be played in embedded players"},i=new Error(t[e.data]||"YouTube player error");this.player.handleError(i)}play(){this.isReady&&this.youtube&&this.youtube.playVideo()}pause(){this.isReady&&this.youtube&&this.youtube.pauseVideo()}seek(e){this.isReady&&this.youtube&&this.youtube.seekTo(e,!0)}setVolume(e){this.isReady&&this.youtube&&(this.youtube.setVolume(e*100),this.player.state.volume=e)}setMuted(e){this.isReady&&this.youtube&&(e?this.youtube.mute():this.youtube.unMute(),this.player.state.muted=e)}setPlaybackSpeed(e){this.isReady&&this.youtube&&(this.youtube.setPlaybackRate(e),this.player.state.playbackSpeed=e)}destroy(){this.timeUpdateInterval&&clearInterval(this.timeUpdateInterval),this.youtube&&this.youtube.destroy&&this.youtube.destroy(),this.iframe&&this.iframe.parentNode&&this.iframe.parentNode.removeChild(this.iframe),this.player.element&&(this.player.element.style.display="")}};var P=class{constructor(e){this.player=e,this.vimeo=null,this.videoId=null,this.isReady=!1,this.iframe=null}async init(){if(this.videoId=this.extractVideoId(this.player.element.src),!this.videoId)throw new Error("Invalid Vimeo URL");await this.loadVimeoAPI(),this.createIframe(),await this.initializePlayer()}extractVideoId(e){let t=[/vimeo\.com\/(\d+)/,/vimeo\.com\/video\/(\d+)/,/player\.vimeo\.com\/video\/(\d+)/];for(let i of t){let s=e.match(i);if(s&&s[1])return s[1]}return null}async loadVimeoAPI(){return window.Vimeo&&window.Vimeo.Player?Promise.resolve():new Promise((e,t)=>{let i=document.createElement("script");i.src="https://player.vimeo.com/api/player.js",i.onload=()=>e(),i.onerror=()=>t(new Error("Failed to load Vimeo API")),document.head.appendChild(i)})}createIframe(){this.player.element.style.display="none",this.iframe=document.createElement("div"),this.iframe.id=`vimeo-player-${Math.random().toString(36).substr(2,9)}`,this.iframe.style.width="100%",this.iframe.style.height="100%",this.player.element.parentNode.insertBefore(this.iframe,this.player.element)}async initializePlayer(){let e={id:this.videoId,width:"100%",height:"100%",controls:!1,autoplay:this.player.options.autoplay,muted:this.player.options.muted,loop:this.player.options.loop,keyboard:!1};this.player.options.startTime>0&&(e.startTime=this.player.options.startTime),this.vimeo=new window.Vimeo.Player(this.iframe.id,e),await this.vimeo.ready(),this.isReady=!0,this.attachEvents();try{let t=await this.vimeo.getDuration();this.player.state.duration=t,this.player.emit("loadedmetadata")}catch(t){this.player.log("Error getting duration:",t,"warn")}}attachEvents(){this.vimeo.on("play",()=>{this.player.state.playing=!0,this.player.state.paused=!1,this.player.state.ended=!1,this.player.emit("play"),this.player.options.onPlay&&this.player.options.onPlay.call(this.player)}),this.vimeo.on("pause",()=>{this.player.state.playing=!1,this.player.state.paused=!0,this.player.emit("pause"),this.player.options.onPause&&this.player.options.onPause.call(this.player)}),this.vimeo.on("ended",()=>{this.player.state.playing=!1,this.player.state.paused=!0,this.player.state.ended=!0,this.player.emit("ended"),this.player.options.onEnded&&this.player.options.onEnded.call(this.player)}),this.vimeo.on("timeupdate",e=>{this.player.state.currentTime=e.seconds,this.player.state.duration=e.duration,this.player.emit("timeupdate",e.seconds),this.player.options.onTimeUpdate&&this.player.options.onTimeUpdate.call(this.player,e.seconds)}),this.vimeo.on("volumechange",e=>{this.player.state.volume=e.volume,this.player.emit("volumechange",e.volume)}),this.vimeo.on("bufferstart",()=>{this.player.state.buffering=!0,this.player.emit("waiting")}),this.vimeo.on("bufferend",()=>{this.player.state.buffering=!1,this.player.emit("canplay")}),this.vimeo.on("seeking",()=>{this.player.state.seeking=!0,this.player.emit("seeking")}),this.vimeo.on("seeked",()=>{this.player.state.seeking=!1,this.player.emit("seeked")}),this.vimeo.on("playbackratechange",e=>{this.player.state.playbackSpeed=e.playbackRate,this.player.emit("ratechange",e.playbackRate)}),this.vimeo.on("error",e=>{this.player.handleError(new Error(`Vimeo error: ${e.message}`))})}play(){this.isReady&&this.vimeo&&this.vimeo.play().catch(e=>{this.player.log("Play error:",e,"warn")})}pause(){this.isReady&&this.vimeo&&this.vimeo.pause().catch(e=>{this.player.log("Pause error:",e,"warn")})}seek(e){this.isReady&&this.vimeo&&this.vimeo.setCurrentTime(e).catch(t=>{this.player.log("Seek error:",t,"warn")})}setVolume(e){this.isReady&&this.vimeo&&(this.vimeo.setVolume(e).catch(t=>{this.player.log("Volume error:",t,"warn")}),this.player.state.volume=e)}setMuted(e){this.isReady&&this.vimeo&&(e?this.vimeo.setVolume(0):this.vimeo.setVolume(this.player.state.volume),this.player.state.muted=e)}setPlaybackSpeed(e){this.isReady&&this.vimeo&&(this.vimeo.setPlaybackRate(e).catch(t=>{this.player.log("Playback rate error:",t,"warn")}),this.player.state.playbackSpeed=e)}destroy(){this.vimeo&&this.vimeo.destroy&&this.vimeo.destroy(),this.iframe&&this.iframe.parentNode&&this.iframe.parentNode.removeChild(this.iframe),this.player.element&&(this.player.element.style.display="")}};var T=class{constructor(e){this.player=e,this.media=e.element,this.hls=null}async init(){this.canPlayNatively()?(this.player.log("Using native HLS support"),await this.initNative()):(this.player.log("Using hls.js for HLS support"),await this.initHlsJs())}canPlayNatively(){return document.createElement("video").canPlayType("application/vnd.apple.mpegurl")!==""}async initNative(){let e=(await Promise.resolve().then(()=>(V(),D))).HTML5Renderer,t=new e(this.player);await t.init(),Object.getOwnPropertyNames(Object.getPrototypeOf(t)).forEach(i=>{i!=="constructor"&&typeof t[i]=="function"&&(this[i]=t[i].bind(t))})}async initHlsJs(){if(this.media.controls=!1,this.media.removeAttribute("controls"),window.Hls||await this.loadHlsJs(),!window.Hls.isSupported())throw new Error("HLS is not supported in this browser");this.hls=new window.Hls({debug:this.player.options.debug,enableWorker:!0,lowLatencyMode:!1,backBufferLength:90,maxBufferLength:30,maxMaxBufferLength:600,maxBufferSize:60*1e3*1e3,maxBufferHole:.5,manifestLoadingTimeOut:1e4,manifestLoadingMaxRetry:4,manifestLoadingRetryDelay:1e3,manifestLoadingMaxRetryTimeout:64e3,levelLoadingTimeOut:1e4,levelLoadingMaxRetry:4,levelLoadingRetryDelay:1e3,levelLoadingMaxRetryTimeout:64e3,fragLoadingTimeOut:2e4,fragLoadingMaxRetry:6,fragLoadingRetryDelay:1e3,fragLoadingMaxRetryTimeout:64e3}),this.hls.attachMedia(this.media);let e,t=this.player.element.querySelector("source");if(t?e=t.getAttribute("src"):e=this.player.element.getAttribute("src")||this.player.element.src,this.player.log(`Loading HLS source: ${e}`,"log"),!e)throw new Error("No HLS source found");this.hls.loadSource(e),this.attachHlsEvents(),this.attachMediaEvents()}async loadHlsJs(){return new Promise((e,t)=>{let i=document.createElement("script");i.src="https://cdn.jsdelivr.net/npm/hls.js@latest",i.onload=()=>e(),i.onerror=()=>t(new Error("Failed to load hls.js")),document.head.appendChild(i)})}attachHlsEvents(){this.hls.on(window.Hls.Events.MANIFEST_PARSED,(e,t)=>{this.player.log("HLS manifest loaded, found "+t.levels.length+" quality levels"),this.player.emit("hlsmanifestparsed",t)}),this.hls.on(window.Hls.Events.LEVEL_SWITCHED,(e,t)=>{this.player.log("HLS level switched to "+t.level),this.player.emit("hlslevelswitched",t)}),this.hls.on(window.Hls.Events.ERROR,(e,t)=>{this.handleHlsError(t)}),this.hls.on(window.Hls.Events.FRAG_BUFFERED,()=>{this.player.state.buffering=!1})}attachMediaEvents(){this.media.addEventListener("loadedmetadata",()=>{this.player.state.duration=this.media.duration,this.player.emit("loadedmetadata")}),this.media.addEventListener("play",()=>{this.player.state.playing=!0,this.player.state.paused=!1,this.player.state.ended=!1,this.player.emit("play"),this.player.options.onPlay&&this.player.options.onPlay.call(this.player)}),this.media.addEventListener("pause",()=>{this.player.state.playing=!1,this.player.state.paused=!0,this.player.emit("pause"),this.player.options.onPause&&this.player.options.onPause.call(this.player)}),this.media.addEventListener("ended",()=>{this.player.state.playing=!1,this.player.state.paused=!0,this.player.state.ended=!0,this.player.emit("ended"),this.player.options.onEnded&&this.player.options.onEnded.call(this.player),this.player.options.loop&&(this.player.seek(0),this.player.play())}),this.media.addEventListener("timeupdate",()=>{this.player.state.currentTime=this.media.currentTime,this.player.emit("timeupdate",this.media.currentTime),this.player.options.onTimeUpdate&&this.player.options.onTimeUpdate.call(this.player,this.media.currentTime)}),this.media.addEventListener("volumechange",()=>{this.player.state.volume=this.media.volume,this.player.state.muted=this.media.muted,this.player.emit("volumechange",this.media.volume)}),this.media.addEventListener("waiting",()=>{this.player.state.buffering=!0,this.player.emit("waiting")}),this.media.addEventListener("canplay",()=>{this.player.state.buffering=!1,this.player.emit("canplay")}),this.media.addEventListener("error",()=>{this.player.handleError(this.media.error)})}handleHlsError(e){if(this.player.log(`HLS Error - Type: ${e.type}, Details: ${e.details}, Fatal: ${e.fatal}`,"warn"),e.response&&this.player.log(`Response code: ${e.response.code}, URL: ${e.response.url}`,"warn"),e.fatal)switch(e.type){case window.Hls.ErrorTypes.NETWORK_ERROR:this.player.log("Fatal network error, trying to recover...","error"),this.player.log(`Network error details: ${e.details}`,"error"),setTimeout(()=>{this.hls.startLoad()},1e3);break;case window.Hls.ErrorTypes.MEDIA_ERROR:this.player.log("Fatal media error, trying to recover...","error"),this.hls.recoverMediaError();break;default:this.player.log("Fatal error, cannot recover","error"),this.player.handleError(new Error(`HLS Error: ${e.type} - ${e.details}`)),this.hls.destroy();break}else this.player.log("Non-fatal HLS error: "+e.details,"warn")}play(){let e=this.media.play();e!==void 0&&e.catch(t=>{this.player.log("Play failed:",t,"warn")})}pause(){this.media.pause()}seek(e){this.media.currentTime=e}setVolume(e){this.media.volume=e}setMuted(e){this.media.muted=e}setPlaybackSpeed(e){this.media.playbackRate=e}switchQuality(e){this.hls&&(this.hls.currentLevel=e)}getQualities(){return this.hls&&this.hls.levels?this.hls.levels.map((e,t)=>({index:t,height:e.height,width:e.width,bitrate:e.bitrate,name:`${e.height}p`})):[]}destroy(){this.hls&&(this.hls.destroy(),this.hls=null)}};var g=class extends w{constructor(e,t={}){if(super(),this.element=typeof e=="string"?document.querySelector(e):e,!this.element)throw new Error("VidPly: Element not found");if(this.element.tagName!=="VIDEO"&&this.element.tagName!=="AUDIO"){let i=t.mediaType||"video",s=document.createElement(i);Array.from(this.element.attributes).forEach(r=>{r.name!=="id"&&r.name!=="class"&&!r.name.startsWith("data-")&&s.setAttribute(r.name,r.value)}),this.element.querySelectorAll("track").forEach(r=>{s.appendChild(r.cloneNode(!0))}),this.element.innerHTML="",this.element.appendChild(s),this.element=s}this.options={width:null,height:null,poster:null,responsive:!0,fillContainer:!1,autoplay:!1,loop:!1,muted:!1,volume:.8,playbackSpeed:1,preload:"metadata",startTime:0,controls:!0,hideControlsDelay:3e3,playPauseButton:!0,progressBar:!0,currentTime:!0,duration:!0,volumeControl:!0,muteButton:!0,chaptersButton:!0,qualityButton:!0,captionStyleButton:!0,speedButton:!0,captionsButton:!0,transcriptButton:!0,fullscreenButton:!0,pipButton:!0,seekInterval:10,seekIntervalLarge:30,captions:!0,captionsDefault:!1,captionsFontSize:"100%",captionsFontFamily:"sans-serif",captionsColor:"#FFFFFF",captionsBackgroundColor:"#000000",captionsOpacity:.8,audioDescription:!0,audioDescriptionSrc:null,audioDescriptionButton:!0,signLanguage:!0,signLanguageSrc:null,signLanguageButton:!0,signLanguagePosition:"bottom-right",transcript:!1,transcriptPosition:"external",transcriptContainer:null,keyboard:!0,keyboardShortcuts:{"play-pause":[" ","p","k"],"volume-up":["ArrowUp"],"volume-down":["ArrowDown"],"seek-forward":["ArrowRight","f"],"seek-backward":["ArrowLeft","r"],"seek-forward-large":["l"],"seek-backward-large":["j"],mute:["m"],fullscreen:["f"],captions:["c"],"speed-up":[">"],"speed-down":["<"],settings:["s"]},ariaLabels:{},screenReaderAnnouncements:!0,highContrast:!1,focusHighlight:!0,language:"en",languages:["en"],debug:!1,classPrefix:"vidply",iconType:"svg",pauseOthersOnPlay:!0,onReady:null,onPlay:null,onPause:null,onEnded:null,onTimeUpdate:null,onVolumeChange:null,onError:null,...t},this.state={ready:!1,playing:!1,paused:!0,ended:!1,buffering:!1,seeking:!1,muted:this.options.muted,volume:this.options.volume,currentTime:0,duration:0,playbackSpeed:this.options.playbackSpeed,fullscreen:!1,pip:!1,captionsEnabled:this.options.captionsDefault,currentCaption:null,controlsVisible:!0,audioDescriptionEnabled:!1,signLanguageEnabled:!1},this.originalSrc=null,this.audioDescriptionSrc=this.options.audioDescriptionSrc,this.signLanguageSrc=this.options.signLanguageSrc,this.signLanguageVideo=null,this.container=null,this.renderer=null,this.controlBar=null,this.captionManager=null,this.keyboardManager=null,this.settingsDialog=null,this.init()}async init(){var e;try{if(this.log("Initializing VidPly player"),!this.options.language||this.options.language==="en"){let i=this.detectHtmlLanguage();i&&(this.options.language=i,this.log(`Auto-detected language from HTML: ${i}`))}p.setLanguage(this.options.language),this.createContainer(),this.element.src||((e=this.element.querySelector("source"))==null?void 0:e.src)?await this.initializeRenderer():this.log("No initial source - waiting for playlist or manual load"),this.options.controls&&(this.controlBar=new E(this),this.videoWrapper.appendChild(this.controlBar.element)),this.options.captions&&(this.captionManager=new f(this)),(this.options.transcript||this.options.transcriptButton)&&(this.transcriptManager=new k(this)),this.options.keyboard&&(this.keyboardManager=new C(this)),this.options.settingsButton&&(this.settingsDialog=new x(this)),this.setupResponsiveHandlers(),this.options.startTime>0&&this.seek(this.options.startTime),this.options.muted&&this.mute(),this.options.volume!==.8&&this.setVolume(this.options.volume),this.state.ready=!0,this.emit("ready"),this.options.onReady&&this.options.onReady.call(this),this.options.autoplay&&this.play(),this.log("Player initialized successfully")}catch(t){this.handleError(t)}}detectHtmlLanguage(){let e=document.documentElement.lang||document.documentElement.getAttribute("lang");if(!e)return null;let t=e.toLowerCase().split("-")[0];return["en","de","es","fr","ja"].includes(t)?t:(this.log(`Language "${e}" not available, using English as fallback`),"en")}createContainer(){this.container=n.createElement("div",{className:`${this.options.classPrefix}-player`,attributes:{role:"region","aria-label":p.t("player.label"),tabindex:"0"}});let e=this.element.tagName.toLowerCase();this.container.classList.add(`${this.options.classPrefix}-${e}`),this.options.responsive&&this.container.classList.add(`${this.options.classPrefix}-responsive`),this.videoWrapper=n.createElement("div",{className:`${this.options.classPrefix}-video-wrapper`}),this.element.parentNode.insertBefore(this.container,this.element),this.container.appendChild(this.videoWrapper),this.videoWrapper.appendChild(this.element),this.element.controls=!1,this.element.removeAttribute("controls"),this.element.setAttribute("tabindex","-1"),this.element.style.width="100%",this.element.style.height="100%",this.options.width&&(this.container.style.width=typeof this.options.width=="number"?`${this.options.width}px`:this.options.width),this.options.height&&(this.container.style.height=typeof this.options.height=="number"?`${this.options.height}px`:this.options.height),this.options.poster&&this.element.tagName==="VIDEO"&&(this.element.poster=this.options.poster),this.element.tagName==="VIDEO"&&this.createPlayButtonOverlay(),this.element.style.cursor="pointer",this.element.addEventListener("click",t=>{t.target===this.element&&this.toggle()})}createPlayButtonOverlay(){this.playButtonOverlay=A(),this.playButtonOverlay.addEventListener("click",()=>{this.toggle()}),this.videoWrapper.appendChild(this.playButtonOverlay),this.on("play",()=>{this.playButtonOverlay.style.opacity="0",this.playButtonOverlay.style.pointerEvents="none"}),this.on("pause",()=>{this.playButtonOverlay.style.opacity="1",this.playButtonOverlay.style.pointerEvents="auto"}),this.on("ended",()=>{this.playButtonOverlay.style.opacity="1",this.playButtonOverlay.style.pointerEvents="auto"})}async initializeRenderer(){var i;let e=this.element.src||((i=this.element.querySelector("source"))==null?void 0:i.src);if(!e)throw new Error("No media source found");this.originalSrc||(this.originalSrc=e);let t;e.includes("youtube.com")||e.includes("youtu.be")?t=L:e.includes("vimeo.com")?t=P:e.includes(".m3u8")?t=T:t=v,this.log(`Using ${t.name} renderer`),this.renderer=new t(this),await this.renderer.init()}async load(e){try{this.log("Loading new media:",e.src),this.renderer&&this.pause(),this.element.querySelectorAll("track").forEach(s=>s.remove()),this.element.src=e.src,e.type&&(this.element.type=e.type),e.poster&&this.element.tagName==="VIDEO"&&(this.element.poster=e.poster),e.tracks&&e.tracks.length>0&&e.tracks.forEach(s=>{let a=document.createElement("track");a.src=s.src,a.kind=s.kind||"captions",a.srclang=s.srclang||"en",a.label=s.label||s.srclang,s.default&&(a.default=!0),this.element.appendChild(a)});let i=this.shouldChangeRenderer(e.src);i&&this.renderer&&(this.renderer.destroy(),this.renderer=null),!this.renderer||i?await this.initializeRenderer():(this.renderer.media=this.element,this.element.load()),this.captionManager&&(this.captionManager.destroy(),this.captionManager=new f(this)),this.emit("sourcechange",e),this.log("Media loaded successfully")}catch(t){this.handleError(t)}}shouldChangeRenderer(e){if(!this.renderer)return!0;let t=e.includes("youtube.com")||e.includes("youtu.be"),i=e.includes("vimeo.com"),s=e.includes(".m3u8"),a=this.renderer.constructor.name;return!!(t&&a!=="YouTubeRenderer"||i&&a!=="VimeoRenderer"||s&&a!=="HLSRenderer"||!t&&!i&&!s&&a!=="HTML5Renderer")}play(){this.renderer&&this.renderer.play()}pause(){this.renderer&&this.renderer.pause()}stop(){this.pause(),this.seek(0)}toggle(){this.state.playing?this.pause():this.play()}seek(e){this.renderer&&this.renderer.seek(e)}seekForward(e=this.options.seekInterval){this.seek(Math.min(this.state.currentTime+e,this.state.duration))}seekBackward(e=this.options.seekInterval){this.seek(Math.max(this.state.currentTime-e,0))}setVolume(e){let t=Math.max(0,Math.min(1,e));this.renderer&&this.renderer.setVolume(t),this.state.volume=t,t>0&&this.state.muted&&(this.state.muted=!1)}getVolume(){return this.state.volume}mute(){this.renderer&&this.renderer.setMuted(!0),this.state.muted=!0}unmute(){this.renderer&&this.renderer.setMuted(!1),this.state.muted=!1}toggleMute(){this.state.muted?this.unmute():this.mute()}setPlaybackSpeed(e){let t=Math.max(.25,Math.min(2,e));this.renderer&&this.renderer.setPlaybackSpeed(t),this.state.playbackSpeed=t,this.emit("playbackspeedchange",t)}getPlaybackSpeed(){return this.state.playbackSpeed}enterFullscreen(){let e=this.container;e.requestFullscreen?e.requestFullscreen():e.webkitRequestFullscreen?e.webkitRequestFullscreen():e.mozRequestFullScreen?e.mozRequestFullScreen():e.msRequestFullscreen&&e.msRequestFullscreen(),this.state.fullscreen=!0,this.container.classList.add(`${this.options.classPrefix}-fullscreen`),this.emit("fullscreenchange",!0)}exitFullscreen(){document.exitFullscreen?document.exitFullscreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.msExitFullscreen&&document.msExitFullscreen(),this.state.fullscreen=!1,this.container.classList.remove(`${this.options.classPrefix}-fullscreen`),this.emit("fullscreenchange",!1)}toggleFullscreen(){this.state.fullscreen?this.exitFullscreen():this.enterFullscreen()}enterPiP(){this.element.requestPictureInPicture&&(this.element.requestPictureInPicture(),this.state.pip=!0,this.emit("pipchange",!0))}exitPiP(){document.pictureInPictureElement&&(document.exitPictureInPicture(),this.state.pip=!1,this.emit("pipchange",!1))}togglePiP(){this.state.pip?this.exitPiP():this.enterPiP()}enableCaptions(){this.captionManager&&(this.captionManager.enable(),this.state.captionsEnabled=!0)}disableCaptions(){this.captionManager&&(this.captionManager.disable(),this.state.captionsEnabled=!1)}toggleCaptions(){this.state.captionsEnabled?this.disableCaptions():this.enableCaptions()}async enableAudioDescription(){if(!this.audioDescriptionSrc){console.warn("VidPly: No audio description source provided");return}let e=this.state.currentTime,t=this.state.playing;this.element.src=this.audioDescriptionSrc,await new Promise(i=>{let s=()=>{this.element.removeEventListener("loadedmetadata",s),i()};this.element.addEventListener("loadedmetadata",s)}),this.seek(e),t&&this.play(),this.state.audioDescriptionEnabled=!0,this.emit("audiodescriptionenabled")}async disableAudioDescription(){if(!this.originalSrc)return;let e=this.state.currentTime,t=this.state.playing;this.element.src=this.originalSrc,await new Promise(i=>{let s=()=>{this.element.removeEventListener("loadedmetadata",s),i()};this.element.addEventListener("loadedmetadata",s)}),this.seek(e),t&&this.play(),this.state.audioDescriptionEnabled=!1,this.emit("audiodescriptiondisabled")}async toggleAudioDescription(){this.state.audioDescriptionEnabled?await this.disableAudioDescription():await this.enableAudioDescription()}enableSignLanguage(){if(!this.signLanguageSrc){console.warn("No sign language video source provided");return}if(this.signLanguageVideo){this.signLanguageVideo.style.display="block",this.state.signLanguageEnabled=!0,this.emit("signlanguageenabled");return}this.signLanguageVideo=document.createElement("video"),this.signLanguageVideo.className="vidply-sign-language-video",this.signLanguageVideo.src=this.signLanguageSrc,this.signLanguageVideo.setAttribute("aria-label",this.i18n.t("signLanguageVideo"));let e=this.options.signLanguagePosition||"bottom-right";this.signLanguageVideo.classList.add(`vidply-sign-position-${e}`),this.signLanguageVideo.muted=!0,this.signLanguageVideo.currentTime=this.state.currentTime,this.state.paused||this.signLanguageVideo.play(),this.container.appendChild(this.signLanguageVideo),this.signLanguageHandlers={play:()=>{this.signLanguageVideo&&this.signLanguageVideo.play()},pause:()=>{this.signLanguageVideo&&this.signLanguageVideo.pause()},timeupdate:()=>{this.signLanguageVideo&&Math.abs(this.signLanguageVideo.currentTime-this.state.currentTime)>.5&&(this.signLanguageVideo.currentTime=this.state.currentTime)},ratechange:()=>{this.signLanguageVideo&&(this.signLanguageVideo.playbackRate=this.state.playbackSpeed)}},this.on("play",this.signLanguageHandlers.play),this.on("pause",this.signLanguageHandlers.pause),this.on("timeupdate",this.signLanguageHandlers.timeupdate),this.on("ratechange",this.signLanguageHandlers.ratechange),this.state.signLanguageEnabled=!0,this.emit("signlanguageenabled")}disableSignLanguage(){this.signLanguageVideo&&(this.signLanguageVideo.style.display="none"),this.state.signLanguageEnabled=!1,this.emit("signlanguagedisabled")}toggleSignLanguage(){this.state.signLanguageEnabled?this.disableSignLanguage():this.enableSignLanguage()}cleanupSignLanguage(){this.signLanguageHandlers&&(this.off("play",this.signLanguageHandlers.play),this.off("pause",this.signLanguageHandlers.pause),this.off("timeupdate",this.signLanguageHandlers.timeupdate),this.off("ratechange",this.signLanguageHandlers.ratechange),this.signLanguageHandlers=null),this.signLanguageVideo&&this.signLanguageVideo.parentNode&&(this.signLanguageVideo.pause(),this.signLanguageVideo.src="",this.signLanguageVideo.parentNode.removeChild(this.signLanguageVideo),this.signLanguageVideo=null)}showSettings(){this.settingsDialog&&this.settingsDialog.show()}hideSettings(){this.settingsDialog&&this.settingsDialog.hide()}getCurrentTime(){return this.state.currentTime}getDuration(){return this.state.duration}isPlaying(){return this.state.playing}isPaused(){return this.state.paused}isEnded(){return this.state.ended}isMuted(){return this.state.muted}isFullscreen(){return this.state.fullscreen}handleError(e){this.log("Error:",e,"error"),this.emit("error",e),this.options.onError&&this.options.onError.call(this,e)}log(e,t="log"){this.options.debug&&console[t]("[VidPly]",e)}setupResponsiveHandlers(){if(typeof ResizeObserver<"u"?(this.resizeObserver=new ResizeObserver(e=>{for(let t of e){let i=t.contentRect.width;this.controlBar&&typeof this.controlBar.updateControlsForViewport=="function"&&this.controlBar.updateControlsForViewport(i),this.transcriptManager&&this.transcriptManager.isVisible&&this.transcriptManager.positionTranscript()}}),this.resizeObserver.observe(this.container)):(this.resizeHandler=()=>{let e=this.container.clientWidth;this.controlBar&&typeof this.controlBar.updateControlsForViewport=="function"&&this.controlBar.updateControlsForViewport(e),this.transcriptManager&&this.transcriptManager.isVisible&&this.transcriptManager.positionTranscript()},window.addEventListener("resize",this.resizeHandler)),window.matchMedia){this.orientationHandler=t=>{setTimeout(()=>{this.transcriptManager&&this.transcriptManager.isVisible&&this.transcriptManager.positionTranscript()},100)};let e=window.matchMedia("(orientation: portrait)");e.addEventListener?e.addEventListener("change",this.orientationHandler):e.addListener&&e.addListener(this.orientationHandler),this.orientationQuery=e}}destroy(){this.log("Destroying player"),this.renderer&&this.renderer.destroy(),this.controlBar&&this.controlBar.destroy(),this.captionManager&&this.captionManager.destroy(),this.keyboardManager&&this.keyboardManager.destroy(),this.settingsDialog&&this.settingsDialog.destroy(),this.transcriptManager&&this.transcriptManager.destroy(),this.cleanupSignLanguage(),this.playButtonOverlay&&this.playButtonOverlay.parentNode&&(this.playButtonOverlay.remove(),this.playButtonOverlay=null),this.resizeObserver&&(this.resizeObserver.disconnect(),this.resizeObserver=null),this.resizeHandler&&(window.removeEventListener("resize",this.resizeHandler),this.resizeHandler=null),this.orientationQuery&&this.orientationHandler&&(this.orientationQuery.removeEventListener?this.orientationQuery.removeEventListener("change",this.orientationHandler):this.orientationQuery.removeListener&&this.orientationQuery.removeListener(this.orientationHandler),this.orientationQuery=null,this.orientationHandler=null),this.container&&this.container.parentNode&&(this.container.parentNode.insertBefore(this.element,this.container),this.container.parentNode.removeChild(this.container)),this.removeAllListeners()}};g.instances=[];var S=class{constructor(e,t={}){this.player=e,this.tracks=[],this.currentIndex=-1,this.options={autoAdvance:t.autoAdvance!==!1,loop:t.loop||!1,showPanel:t.showPanel!==!1,...t},this.container=null,this.playlistPanel=null,this.trackInfoElement=null,this.handleTrackEnd=this.handleTrackEnd.bind(this),this.handleTrackError=this.handleTrackError.bind(this),this.init()}init(){this.player.on("ended",this.handleTrackEnd),this.player.on("error",this.handleTrackError),this.options.showPanel&&this.createUI()}loadPlaylist(e){this.tracks=e,this.currentIndex=-1,this.container&&this.container.classList.add("vidply-has-playlist"),this.playlistPanel&&this.renderPlaylist(),e.length>0&&this.play(0)}play(e){if(e<0||e>=this.tracks.length){console.warn("VidPly Playlist: Invalid track index",e);return}let t=this.tracks[e];this.currentIndex=e,this.player.load({src:t.src,type:t.type,poster:t.poster,tracks:t.tracks||[]}),this.updateTrackInfo(t),this.updatePlaylistUI(),this.player.emit("playlisttrackchange",{index:e,item:t,total:this.tracks.length}),setTimeout(()=>{this.player.play()},100)}next(){let e=this.currentIndex+1;if(e>=this.tracks.length)if(this.options.loop)e=0;else return;this.play(e)}previous(){let e=this.currentIndex-1;if(e<0)if(this.options.loop)e=this.tracks.length-1;else return;this.play(e)}handleTrackEnd(){this.options.autoAdvance&&this.next()}handleTrackError(e){console.error("VidPly Playlist: Track error",e),this.options.autoAdvance&&setTimeout(()=>{this.next()},1e3)}createUI(){if(this.container=this.player.container,!this.container){console.warn("VidPly Playlist: No container found");return}this.trackInfoElement=n.createElement("div",{className:"vidply-track-info"}),this.trackInfoElement.style.display="none",this.container.appendChild(this.trackInfoElement),this.playlistPanel=n.createElement("div",{className:"vidply-playlist-panel"}),this.playlistPanel.style.display="none",this.container.appendChild(this.playlistPanel)}updateTrackInfo(e){if(!this.trackInfoElement)return;let t=this.currentIndex+1,i=this.tracks.length;this.trackInfoElement.innerHTML=`
      <div class="vidply-track-number">Track ${t} of ${i}</div>
      <div class="vidply-track-title">${n.escapeHTML(e.title||"Untitled")}</div>
      ${e.artist?`<div class="vidply-track-artist">${n.escapeHTML(e.artist)}</div>`:""}
    `,this.trackInfoElement.style.display="block"}renderPlaylist(){if(!this.playlistPanel)return;this.playlistPanel.innerHTML="";let e=n.createElement("div",{className:"vidply-playlist-header"});e.textContent=`Playlist (${this.tracks.length})`,this.playlistPanel.appendChild(e);let t=n.createElement("div",{className:"vidply-playlist-list"});this.tracks.forEach((i,s)=>{let a=this.createPlaylistItem(i,s);t.appendChild(a)}),this.playlistPanel.appendChild(t),this.playlistPanel.style.display="block"}createPlaylistItem(e,t){let i=n.createElement("div",{className:"vidply-playlist-item",role:"button",tabIndex:0,"aria-label":`Play ${e.title||"Track "+(t+1)}`});t===this.currentIndex&&i.classList.add("vidply-playlist-item-active");let s=n.createElement("div",{className:"vidply-playlist-thumbnail"});if(e.poster)s.style.backgroundImage=`url(${e.poster})`;else{let c=h("music");c.classList.add("vidply-playlist-thumbnail-icon"),s.appendChild(c)}i.appendChild(s);let a=n.createElement("div",{className:"vidply-playlist-item-info"}),r=n.createElement("div",{className:"vidply-playlist-item-title"});if(r.textContent=e.title||`Track ${t+1}`,a.appendChild(r),e.artist){let c=n.createElement("div",{className:"vidply-playlist-item-artist"});c.textContent=e.artist,a.appendChild(c)}i.appendChild(a);let l=h("play");return l.classList.add("vidply-playlist-item-icon"),i.appendChild(l),i.addEventListener("click",()=>{this.play(t)}),i.addEventListener("keydown",c=>{(c.key==="Enter"||c.key===" ")&&(c.preventDefault(),this.play(t))}),i}updatePlaylistUI(){if(!this.playlistPanel)return;this.playlistPanel.querySelectorAll(".vidply-playlist-item").forEach((t,i)=>{i===this.currentIndex?(t.classList.add("vidply-playlist-item-active"),t.scrollIntoView({behavior:"smooth",block:"nearest"})):t.classList.remove("vidply-playlist-item-active")})}getCurrentTrack(){return this.tracks[this.currentIndex]||null}getPlaylistInfo(){return{currentIndex:this.currentIndex,totalTracks:this.tracks.length,currentTrack:this.getCurrentTrack(),hasNext:this.currentIndex<this.tracks.length-1,hasPrevious:this.currentIndex>0}}addTrack(e){this.tracks.push(e),this.playlistPanel&&this.renderPlaylist()}removeTrack(e){e<0||e>=this.tracks.length||(this.tracks.splice(e,1),e<this.currentIndex?this.currentIndex--:e===this.currentIndex&&(this.currentIndex>=this.tracks.length&&(this.currentIndex=this.tracks.length-1),this.currentIndex>=0&&this.play(this.currentIndex)),this.playlistPanel&&this.renderPlaylist())}clear(){this.tracks=[],this.currentIndex=-1,this.playlistPanel&&(this.playlistPanel.innerHTML="",this.playlistPanel.style.display="none"),this.trackInfoElement&&(this.trackInfoElement.innerHTML="",this.trackInfoElement.style.display="none")}destroy(){this.player.off("ended",this.handleTrackEnd),this.player.off("error",this.handleTrackError),this.trackInfoElement&&this.trackInfoElement.remove(),this.playlistPanel&&this.playlistPanel.remove(),this.clear()}};function z(){document.querySelectorAll("[data-vidply]").forEach(e=>{let t=e.dataset.vidplyOptions?JSON.parse(e.dataset.vidplyOptions):{};new g(e,t)})}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",z):z();var j=g;return q(X);})();
