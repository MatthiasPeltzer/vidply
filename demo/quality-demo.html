<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>VidPly - Quality Button Demo</title>
  <link rel="stylesheet" href="../dist/vidply.css">
  <style>
    body {
      font-family: Arial, sans-serif;
      max-width: 1200px;
      margin: 50px auto;
      padding: 20px;
      background: #1a1a1a;
      color: white;
    }
    h1 { color: #4caf50; margin-bottom: 10px; }
    .subtitle { color: #999; margin-bottom: 40px; }
    .section {
      background: #2a2a2a;
      padding: 30px;
      margin: 30px 0;
      border-radius: 12px;
      border-left: 4px solid #4caf50;
    }
    .section h2 { margin-top: 0; color: #4caf50; }
    .info {
      background: #333;
      padding: 15px;
      margin: 15px 0;
      border-radius: 8px;
      font-size: 14px;
    }
    .player-wrapper {
      margin: 20px 0;
    }
    .status {
      display: inline-block;
      padding: 6px 12px;
      border-radius: 12px;
      font-size: 13px;
      font-weight: 600;
      margin: 5px;
    }
    .status.success { background: rgba(76, 175, 80, 0.2); color: #4caf50; }
    .status.info { background: rgba(33, 150, 243, 0.2); color: #2196f3; }
    code {
      background: #000;
      padding: 2px 6px;
      border-radius: 3px;
      color: #0f0;
      font-family: monospace;
    }
    .code-block {
      background: #000;
      padding: 15px;
      margin: 15px 0;
      border-radius: 8px;
      font-family: monospace;
      font-size: 13px;
      color: #0f0;
      overflow-x: auto;
    }
  </style>
</head>
<body>
  <h1>üé¨ VidPly Quality Button Demo</h1>
  <p class="subtitle">Examples showing how the quality button appears and works</p>

  <!-- HLS Example -->
  <div class="section">
    <h2>‚úÖ Example 1: HLS Stream (Automatic)</h2>
    <div class="info">
      <strong>How it works:</strong>
      <ul>
        <li>HLS streams (.m3u8) automatically include multiple quality levels</li>
        <li>The quality button (HD icon) appears automatically</li>
        <li>Click the HD button to select quality or use "Auto" mode</li>
        <li>The button shows current quality (e.g., "720p" or "Auto")</li>
      </ul>
      <span class="status success">‚úì Works automatically</span>
      <span class="status success">‚úì No special markup needed</span>
    </div>
    
    <div class="player-wrapper">
      <video 
        id="hls-player"
        width="900"
        height="506"
        preload="metadata"
      >
        <source src="https://devstreaming-cdn.apple.com/videos/streaming/examples/img_bipbop_adv_example_fmp4/master.m3u8" type="application/x-mpegURL">
      </video>
    </div>
    
    <div class="code-block">&lt;video id="my-video"&gt;
  &lt;source src="stream.m3u8" type="application/x-mpegURL"&gt;
&lt;/video&gt;

&lt;script type="module"&gt;
  import Player from './vidply.esm.js';
  const player = new Player('#my-video');
  // Quality button appears automatically!
&lt;/script&gt;</div>
  </div>

  <!-- Multiple Sources Example -->
  <div class="section">
    <h2>‚úÖ Example 2: Multiple HTML5 Sources</h2>
    <div class="info">
      <strong>How to enable quality switching for HTML5:</strong>
      <ul>
        <li>Add multiple <code>&lt;source&gt;</code> elements for the same video at different qualities</li>
        <li>Use <code>data-height</code> attribute to specify resolution (e.g., 720, 480, 360)</li>
        <li>Use <code>data-quality</code> or <code>label</code> for display name</li>
        <li>The quality button will appear automatically when 2+ sources with heights are detected</li>
      </ul>
      <span class="status success">‚úì Easy to implement</span>
      <span class="status info">‚ÑπÔ∏è Requires data-height attribute</span>
    </div>
    
    <div class="player-wrapper">
      <video 
        id="multi-quality-player"
        width="900"
        height="506"
        preload="metadata"
        poster="media/deadline_thumbnail.jpg"
      >
        <!-- Same video at different quality levels -->
        <source 
          src="media/deadline.mp4" 
          type="video/mp4"
          data-quality="High"
          data-height="720"
          data-width="1280"
          label="720p HD">
        <source 
          src="media/deadline.mp4" 
          type="video/mp4"
          data-quality="Medium"
          data-height="480"
          data-width="854"
          label="480p SD">
        <source 
          src="media/deadline.mp4" 
          type="video/mp4"
          data-quality="Low"
          data-height="360"
          data-width="640"
          label="360p">
        <track kind="captions" src="media/deadline_captions_en.vtt" srclang="en" label="English" default>
      </video>
    </div>
    
    <div class="code-block">&lt;video id="my-video"&gt;
  &lt;!-- 1080p version --&gt;
  &lt;source 
    src="my-video-1080p.mp4" 
    type="video/mp4"
    data-quality="1080p"
    data-height="1080"
    data-width="1920"
    label="1080p Full HD"&gt;
  
  &lt;!-- 720p version --&gt;
  &lt;source 
    src="my-video-720p.mp4" 
    type="video/mp4"
    data-quality="720p"
    data-height="720"
    data-width="1280"
    label="720p HD"&gt;
  
  &lt;!-- 480p version --&gt;
  &lt;source 
    src="my-video-480p.mp4" 
    type="video/mp4"
    data-quality="480p"
    data-height="480"
    data-width="854"
    label="480p SD"&gt;
&lt;/video&gt;

&lt;script type="module"&gt;
  import Player from './vidply.esm.js';
  const player = new Player('#my-video');
  // Quality button appears automatically!
&lt;/script&gt;</div>
  </div>

  <!-- Instructions -->
  <div class="section">
    <h2>üìã How to Use</h2>
    <div class="info">
      <strong>The quality button appears when:</strong>
      <ol>
        <li><strong>HLS Streams:</strong> Automatically when .m3u8 stream has multiple quality levels</li>
        <li><strong>HTML5 Video:</strong> When you have 2+ <code>&lt;source&gt;</code> elements with <code>data-height</code> attributes</li>
      </ol>
      
      <strong style="display: block; margin-top: 15px;">Required attributes for HTML5 multi-quality:</strong>
      <ul>
        <li><code>data-height="720"</code> - Resolution height (REQUIRED)</li>
        <li><code>data-width="1280"</code> - Resolution width (optional)</li>
        <li><code>data-quality="720p"</code> or <code>label="720p HD"</code> - Display name (optional)</li>
      </ul>

      <strong style="display: block; margin-top: 15px;">Features:</strong>
      <ul>
        <li>üéØ Quality button appears before the speed button</li>
        <li>üìä Shows current quality (e.g., "720p", "Auto")</li>
        <li>‚úì Checkmark indicates active quality in menu</li>
        <li>üîÑ Seamless switching preserves playback position</li>
        <li>‚ôø Fully accessible with keyboard navigation</li>
      </ul>
    </div>
  </div>

  <script type="module">
    import Player from '../src/index.js';

    // Initialize HLS player
    console.log('%cüé¨ Initializing HLS Player...', 'color: #4caf50; font-size: 16px; font-weight: bold;');
    const hlsPlayer = new Player('#hls-player', {
      debug: true,
      controls: true
    });

    hlsPlayer.on('hlsmanifestparsed', (data) => {
      console.log(`‚úÖ HLS: ${data.levels.length} quality levels detected`);
      data.levels.forEach((level, i) => {
        console.log(`  Level ${i}: ${level.width}x${level.height} @ ${Math.round(level.bitrate/1000)} kbps`);
      });
    });

    hlsPlayer.on('ready', () => {
      console.log('‚úÖ HLS Player ready');
      setTimeout(() => {
        const btn = document.querySelector('#hls-player').closest('.vidply-player').querySelector('.vidply-quality');
        if (btn) {
          console.log('%c‚úÖ Quality button found in HLS player!', 'color: #4caf50; font-weight: bold;');
        } else {
          console.log('%c‚ùå Quality button NOT found in HLS player', 'color: #f00; font-weight: bold;');
        }
      }, 2000);
    });

    // Initialize multi-quality player
    console.log('%cüé¨ Initializing Multi-Quality Player...', 'color: #4caf50; font-size: 16px; font-weight: bold;');
    const multiPlayer = new Player('#multi-quality-player', {
      debug: true,
      controls: true
    });

    multiPlayer.on('ready', () => {
      console.log('‚úÖ Multi-quality player ready');
      
      setTimeout(() => {
        if (multiPlayer.renderer && multiPlayer.renderer.getQualities) {
          const qualities = multiPlayer.renderer.getQualities();
          console.log(`‚úÖ HTML5: ${qualities.length} quality levels detected`);
          qualities.forEach(q => {
            console.log(`  ${q.name}: ${q.width}x${q.height}`);
          });
        }
        
        const btn = document.querySelector('#multi-quality-player').closest('.vidply-player').querySelector('.vidply-quality');
        if (btn) {
          console.log('%c‚úÖ Quality button found in multi-quality player!', 'color: #4caf50; font-weight: bold;');
        } else {
          console.log('%c‚ùå Quality button NOT found in multi-quality player', 'color: #f00; font-weight: bold;');
          console.log('Check console for debug info...');
        }
      }, 2000);
    });

    // Global references for debugging
    window.hlsPlayer = hlsPlayer;
    window.multiPlayer = multiPlayer;
    
    console.log('%c‚ÑπÔ∏è Players available as window.hlsPlayer and window.multiPlayer', 'color: #2196f3;');
    console.log('%c‚ÑπÔ∏è Try: window.multiPlayer.renderer.getQualities()', 'color: #2196f3;');
  </script>
</body>
</html>


